{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 28, "column": 0}, "map": {"version":3,"sources":["file:///Users/prestondinh/SICC/mvp/convex/_generated/api.js"],"sourcesContent":["/* eslint-disable */\n/**\n * Generated `api` utility.\n *\n * THIS CODE IS AUTOMATICALLY GENERATED.\n *\n * To regenerate, run `npx convex dev`.\n * @module\n */\n\nimport { anyApi, componentsGeneric } from \"convex/server\";\n\n/**\n * A utility for referencing Convex functions in your app's API.\n *\n * Usage:\n * ```js\n * const myFunctionReference = api.myModule.myFunction;\n * ```\n */\nexport const api = anyApi;\nexport const internal = anyApi;\nexport const components = componentsGeneric();\n"],"names":[],"mappings":";;;;;;;;AAAA,kBAAkB,GAClB;;;;;;;CAOC,GAED;AAAA;AAAA;;AAUO,MAAM,MAAM,gKAAM;AAClB,MAAM,WAAW,gKAAM;AACvB,MAAM,aAAa,IAAA,2MAAiB"}},
    {"offset": {"line": 84, "column": 0}, "map": {"version":3,"sources":["file:///Users/prestondinh/SICC/mvp/app/hooks/useAuthSync.ts"],"sourcesContent":["\"use client\";\n\nimport { useMutation } from \"convex/react\";\nimport { api } from \"../../convex/_generated/api\";\nimport { useEffect, useRef } from \"react\";\n\n// Check if Clerk is configured\nconst isClerkConfigured = !!process.env.NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY;\n\n// Dynamically import useUser only if Clerk is configured\nlet useClerkUser: () => { user: unknown; isSignedIn: boolean; isLoaded: boolean } = () => ({\n  user: null,\n  isSignedIn: false,\n  isLoaded: true,\n});\n\nif (isClerkConfigured) {\n  // This will be tree-shaken if not used\n  try {\n    const clerk = require(\"@clerk/nextjs\");\n    useClerkUser = clerk.useUser;\n  } catch {\n    // Clerk not available\n  }\n}\n\n/**\n * Hook to sync Clerk authentication with Convex user database.\n *\n * When a user signs in:\n * 1. Creates or updates their user record in Convex\n * 2. Links any anonymous session data to their account\n */\nexport function useAuthSync() {\n  const { user, isSignedIn, isLoaded } = useClerkUser();\n  const getOrCreateUser = useMutation(api.users.getOrCreateUser);\n  const linkSessionToUser = useMutation(api.users.linkSessionToUser);\n\n  // Track if we've already synced this session\n  const hasSynced = useRef(false);\n\n  useEffect(() => {\n    async function syncUser() {\n      if (!isLoaded || !isSignedIn || !user || hasSynced.current) {\n        return;\n      }\n\n      try {\n        // Get user's primary email\n        const typedUser = user as { id: string; primaryEmailAddress?: { emailAddress: string }; fullName?: string; firstName?: string };\n        const email = typedUser.primaryEmailAddress?.emailAddress;\n        if (!email) return;\n\n        // Create or get user in Convex\n        const userId = await getOrCreateUser({\n          clerkId: typedUser.id,\n          email,\n          name: typedUser.fullName || typedUser.firstName || email.split(\"@\")[0],\n        });\n\n        // Get session ID from localStorage\n        const sessionId = localStorage.getItem(\"estatePlanSessionId\");\n\n        // If there's a session, link it to the user\n        if (sessionId && userId) {\n          await linkSessionToUser({\n            sessionId,\n            userId,\n          });\n\n          // Store user ID for future reference\n          localStorage.setItem(\"estatePlanUserId\", userId);\n        }\n\n        hasSynced.current = true;\n      } catch (error) {\n        console.error(\"Error syncing user:\", error);\n      }\n    }\n\n    syncUser();\n  }, [isLoaded, isSignedIn, user, getOrCreateUser, linkSessionToUser]);\n\n  return {\n    isLoaded,\n    isSignedIn,\n    user,\n  };\n}\n"],"names":[],"mappings":";;;;AAEA;AAAA;AACA;AACA;AAJA;;;;AAMA,+BAA+B;AAC/B,MAAM,oBAAoB,CAAC,CAAC,QAAQ,GAAG,CAAC,iCAAiC;AAEzE,yDAAyD;AACzD,IAAI,eAAgF,IAAM,CAAC;QACzF,MAAM;QACN,YAAY;QACZ,UAAU;IACZ,CAAC;AAED,IAAI,mBAAmB;IACrB,uCAAuC;IACvC,IAAI;QACF,MAAM;QACN,eAAe,MAAM,OAAO;IAC9B,EAAE,OAAM;IACN,sBAAsB;IACxB;AACF;AASO,SAAS;IACd,MAAM,EAAE,IAAI,EAAE,UAAU,EAAE,QAAQ,EAAE,GAAG;IACvC,MAAM,kBAAkB,IAAA,uKAAW,EAAC,kIAAG,CAAC,KAAK,CAAC,eAAe;IAC7D,MAAM,oBAAoB,IAAA,uKAAW,EAAC,kIAAG,CAAC,KAAK,CAAC,iBAAiB;IAEjE,6CAA6C;IAC7C,MAAM,YAAY,IAAA,+MAAM,EAAC;IAEzB,IAAA,kNAAS,EAAC;QACR,eAAe;YACb,IAAI,CAAC,YAAY,CAAC,cAAc,CAAC,QAAQ,UAAU,OAAO,EAAE;gBAC1D;YACF;YAEA,IAAI;gBACF,2BAA2B;gBAC3B,MAAM,YAAY;gBAClB,MAAM,QAAQ,UAAU,mBAAmB,EAAE;gBAC7C,IAAI,CAAC,OAAO;gBAEZ,+BAA+B;gBAC/B,MAAM,SAAS,MAAM,gBAAgB;oBACnC,SAAS,UAAU,EAAE;oBACrB;oBACA,MAAM,UAAU,QAAQ,IAAI,UAAU,SAAS,IAAI,MAAM,KAAK,CAAC,IAAI,CAAC,EAAE;gBACxE;gBAEA,mCAAmC;gBACnC,MAAM,YAAY,aAAa,OAAO,CAAC;gBAEvC,4CAA4C;gBAC5C,IAAI,aAAa,QAAQ;oBACvB,MAAM,kBAAkB;wBACtB;wBACA;oBACF;oBAEA,qCAAqC;oBACrC,aAAa,OAAO,CAAC,oBAAoB;gBAC3C;gBAEA,UAAU,OAAO,GAAG;YACtB,EAAE,OAAO,OAAO;gBACd,QAAQ,KAAK,CAAC,uBAAuB;YACvC;QACF;QAEA;IACF,GAAG;QAAC;QAAU;QAAY;QAAM;QAAiB;KAAkB;IAEnE,OAAO;QACL;QACA;QACA;IACF;AACF"}},
    {"offset": {"line": 169, "column": 0}, "map": {"version":3,"sources":["file:///Users/prestondinh/SICC/mvp/app/ConvexClientProvider.tsx"],"sourcesContent":["\"use client\";\n\nimport { ConvexProvider, ConvexReactClient } from \"convex/react\";\nimport { useAuthSync } from \"./hooks/useAuthSync\";\n\nconst convex = new ConvexReactClient(\n  process.env.NEXT_PUBLIC_CONVEX_URL!\n);\n\n// Component that syncs Clerk auth with Convex\nfunction AuthSyncWrapper({ children }: { children: React.ReactNode }) {\n  // This hook handles syncing Clerk user with Convex database\n  useAuthSync();\n  return <>{children}</>;\n}\n\nexport default function ConvexClientProvider({\n  children,\n}: {\n  children: React.ReactNode;\n}) {\n  return (\n    <ConvexProvider client={convex}>\n      <AuthSyncWrapper>{children}</AuthSyncWrapper>\n    </ConvexProvider>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AAAA;AACA;AAHA;;;;AAKA,MAAM,SAAS,IAAI,6KAAiB;AAIpC,8CAA8C;AAC9C,SAAS,gBAAgB,EAAE,QAAQ,EAAiC;IAClE,4DAA4D;IAC5D,IAAA,0IAAW;IACX,qBAAO;kBAAG;;AACZ;AAEe,SAAS,qBAAqB,EAC3C,QAAQ,EAGT;IACC,qBACE,8OAAC,0KAAc;QAAC,QAAQ;kBACtB,cAAA,8OAAC;sBAAiB;;;;;;;;;;;AAGxB"}}]
}