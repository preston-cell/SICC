{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///Users/prestondinh/SICC/mvp/app/api/gap-analysis/route.ts"],"sourcesContent":["import { NextResponse } from \"next/server\";\n\n// Extend Vercel function timeout\nexport const maxDuration = 300;\n\nconst E2B_API_URL = \"/api/e2b/execute\";\n\ninterface IntakeData {\n  estatePlan: { stateOfResidence?: string };\n  personal?: { data: string };\n  family?: { data: string };\n  assets?: { data: string };\n  existingDocuments?: { data: string };\n  goals?: { data: string };\n  beneficiaryDesignations?: BeneficiaryDesignation[];\n}\n\ninterface BeneficiaryDesignation {\n  assetType: string;\n  assetName: string;\n  institution?: string;\n  estimatedValue?: string;\n  primaryBeneficiaryName: string;\n  primaryBeneficiaryRelationship?: string;\n  primaryBeneficiaryPercentage?: number;\n  contingentBeneficiaryName?: string;\n  contingentBeneficiaryRelationship?: string;\n  contingentBeneficiaryPercentage?: number;\n  lastReviewedDate?: string;\n  notes?: string;\n}\n\ninterface ParsedIntake {\n  state: string;\n  personal: Record<string, unknown>;\n  family: Record<string, unknown>;\n  assets: Record<string, unknown>;\n  existingDocs: Record<string, unknown>;\n  goals: Record<string, unknown>;\n  beneficiaries: BeneficiaryDesignation[];\n}\n\nfunction parseIntakeData(intakeData: IntakeData): ParsedIntake {\n  const state = intakeData.estatePlan?.stateOfResidence || \"Unknown\";\n  let personal = {};\n  let family = {};\n  let assets = {};\n  let existingDocs = {};\n  let goals = {};\n\n  try {\n    if (intakeData.personal?.data) personal = JSON.parse(intakeData.personal.data);\n    if (intakeData.family?.data) family = JSON.parse(intakeData.family.data);\n    if (intakeData.assets?.data) assets = JSON.parse(intakeData.assets.data);\n    if (intakeData.existingDocuments?.data) existingDocs = JSON.parse(intakeData.existingDocuments.data);\n    if (intakeData.goals?.data) goals = JSON.parse(intakeData.goals.data);\n  } catch (e) {\n    console.error(\"Error parsing intake data:\", e);\n  }\n\n  return {\n    state,\n    personal,\n    family,\n    assets,\n    existingDocs,\n    goals,\n    beneficiaries: intakeData.beneficiaryDesignations || [],\n  };\n}\n\n// Sophisticated scoring system based on multiple weighted criteria\nfunction calculateScore(parsed: ParsedIntake, analysisResult: Record<string, unknown>): number {\n  let score = 100; // Start with perfect score and deduct\n\n  const hasWill = (parsed.existingDocs as { hasWill?: boolean })?.hasWill;\n  const hasTrust = (parsed.existingDocs as { hasTrust?: boolean })?.hasTrust;\n  const hasPOAFinancial = (parsed.existingDocs as { hasPOAFinancial?: boolean })?.hasPOAFinancial;\n  const hasPOAHealthcare = (parsed.existingDocs as { hasPOAHealthcare?: boolean })?.hasPOAHealthcare;\n  const hasHealthcareDirective = (parsed.existingDocs as { hasHealthcareDirective?: boolean })?.hasHealthcareDirective;\n\n  const hasMinorChildren = (parsed.family as { children?: Array<{ isMinor?: boolean }> })?.children?.some(c => c.isMinor);\n  const estimatedValue = (parsed.assets as { estimatedTotalValue?: number })?.estimatedTotalValue || 0;\n  const isMarried = (parsed.personal as { maritalStatus?: string })?.maritalStatus === \"married\";\n\n  // Core documents (40 points total)\n  if (!hasWill) score -= 15; // Will is essential\n  if (!hasPOAFinancial) score -= 10; // Financial POA critical for incapacity\n  if (!hasPOAHealthcare) score -= 8; // Healthcare POA critical\n  if (!hasHealthcareDirective) score -= 7; // Living will important\n\n  // Trust consideration (15 points) - more important for higher estates\n  if (!hasTrust) {\n    if (estimatedValue > 1000000) score -= 15; // High value estates need trust\n    else if (estimatedValue > 500000) score -= 10;\n    else if (estimatedValue > 100000) score -= 5;\n  }\n\n  // Minor children considerations (15 points)\n  if (hasMinorChildren) {\n    const hasGuardian = (parsed.family as { guardian?: string })?.guardian;\n    if (!hasGuardian) score -= 10; // Guardian nomination critical\n    if (!hasWill) score -= 5; // Will even more important with minors\n  }\n\n  // Beneficiary alignment (10 points)\n  if (parsed.beneficiaries.length === 0 && estimatedValue > 50000) {\n    score -= 10; // Should track beneficiary designations\n  }\n\n  // Marital considerations (10 points)\n  if (isMarried) {\n    if (!hasWill && !hasTrust) score -= 5; // Married couples need estate docs\n    if (estimatedValue > 500000 && !hasTrust) score -= 5; // Consider trust for asset protection\n  }\n\n  // State-specific compliance (5 points)\n  // Deduct if in high-cost probate state without trust\n  const highProbateStates = [\"CA\", \"California\", \"NY\", \"New York\", \"FL\", \"Florida\"];\n  if (highProbateStates.includes(parsed.state) && !hasTrust && estimatedValue > 100000) {\n    score -= 5;\n  }\n\n  // Document currency (5 points) - from analysis result\n  const outdatedDocs = analysisResult?.outdatedDocuments as Array<unknown> || [];\n  if (outdatedDocs.length > 0) {\n    score -= Math.min(5, outdatedDocs.length * 2);\n  }\n\n  // Ensure score stays in valid range\n  return Math.max(0, Math.min(100, Math.round(score)));\n}\n\n// Build comprehensive multi-pass prompt for autonomous Claude Code execution\nfunction buildComprehensivePrompt(parsed: ParsedIntake): string {\n  return `You are an elite estate planning analyst with expertise in tax law, elder law, and wealth transfer strategies. You have access to skill files that contain state-specific legal requirements.\n\nCRITICAL INSTRUCTIONS:\n1. First, read the skill file at /home/user/.claude/skills/us-estate-planning-analyzer/SKILL.md\n2. If available, also read /home/user/.claude/skills/us-estate-planning-analyzer/references/${parsed.state.toLowerCase().replace(' ', '-')}.md for state-specific rules\n3. Perform a COMPREHENSIVE multi-dimensional analysis\n4. You MUST save your output as valid JSON to /home/user/generated/analysis.json using the Write tool\n\n=== CLIENT PROFILE ===\n\nSTATE OF RESIDENCE: ${parsed.state}\n\nPERSONAL INFORMATION:\n${JSON.stringify(parsed.personal, null, 2)}\n\nFAMILY STRUCTURE:\n${JSON.stringify(parsed.family, null, 2)}\n\nASSET INVENTORY:\n${JSON.stringify(parsed.assets, null, 2)}\n\nEXISTING ESTATE PLANNING DOCUMENTS:\n${JSON.stringify(parsed.existingDocs, null, 2)}\n\nBENEFICIARY DESIGNATIONS ON FILE:\n${parsed.beneficiaries.length > 0 ? JSON.stringify(parsed.beneficiaries, null, 2) : \"NONE TRACKED - This is a significant gap\"}\n\nSTATED GOALS AND WISHES:\n${JSON.stringify(parsed.goals, null, 2)}\n\n=== ANALYSIS FRAMEWORK ===\n\nYou must analyze this estate plan across ALL of the following dimensions:\n\n**DIMENSION 1: DOCUMENT COMPLETENESS ANALYSIS**\n- Identify ALL missing essential documents\n- Assess document currency (anything > 3-5 years old needs review)\n- Check for proper execution (witnesses, notarization as required by state)\n- Evaluate document coordination (do they work together?)\n\n**DIMENSION 2: FAMILY PROTECTION ANALYSIS**\n- Minor children: guardian nominations, trusts for inheritance\n- Disabled dependents: special needs trust requirements\n- Blended families: QTIP trusts, separate property protection\n- Aging parents: elder care planning considerations\n\n**DIMENSION 3: ASSET PROTECTION & TRANSFER ANALYSIS**\n- Probate exposure calculation (use state-specific statutory fees)\n- Asset titling review (joint tenancy vs community property vs trust)\n- Beneficiary designation audit (do they align with estate plan?)\n- Business succession planning (if applicable)\n- Creditor protection strategies\n\n**DIMENSION 4: TAX OPTIMIZATION ANALYSIS**\n- Federal estate tax exposure (current exemption $13.61M, sunset to ~$7M in 2026)\n- State estate/inheritance tax (varies by state)\n- Income tax considerations (step-up in basis planning)\n- Gift tax strategies (annual exclusion, lifetime exemption)\n- Generation-skipping transfer tax considerations\n\n**DIMENSION 5: INCAPACITY PLANNING ANALYSIS**\n- Financial management during incapacity\n- Healthcare decision-making authority\n- Digital asset access\n- Business continuity during incapacity\n\n**DIMENSION 6: LONG-TERM CARE & MEDICAID ANALYSIS**\n- Medicaid/Medi-Cal eligibility risks\n- Look-back period considerations (5 years federal, varies by state)\n- Asset protection trust opportunities\n- Long-term care insurance evaluation\n\n**DIMENSION 7: SCENARIO MODELING**\nAnalyze what happens under these scenarios:\n- Scenario A: Client dies tomorrow (current state)\n- Scenario B: Client becomes incapacitated\n- Scenario C: Spouse dies first (if married)\n- Scenario D: Both parents die simultaneously (if minor children)\n- Scenario E: Estate value doubles over next 10 years\n- Scenario F: Federal exemption sunsets to $7M in 2026\n\n=== OUTPUT REQUIREMENTS ===\n\nYou MUST save a JSON file to /home/user/generated/analysis.json with this EXACT structure:\n\n{\n  \"analysisMetadata\": {\n    \"analysisDate\": \"<current date>\",\n    \"stateAnalyzed\": \"${parsed.state}\",\n    \"analysisVersion\": \"2.0\",\n    \"confidenceLevel\": \"<high, medium, or low based on data completeness>\"\n  },\n  \"overallScore\": {\n    \"score\": <0-100 calculated score>,\n    \"grade\": \"<A, B, C, D, or F>\",\n    \"summary\": \"<2-3 sentence overall assessment>\",\n    \"scoringBreakdown\": {\n      \"documentCompleteness\": {\"score\": <0-25>, \"maxScore\": 25, \"details\": \"<explanation>\"},\n      \"familyProtection\": {\"score\": <0-20>, \"maxScore\": 20, \"details\": \"<explanation>\"},\n      \"assetProtection\": {\"score\": <0-20>, \"maxScore\": 20, \"details\": \"<explanation>\"},\n      \"taxEfficiency\": {\"score\": <0-15>, \"maxScore\": 15, \"details\": \"<explanation>\"},\n      \"incapacityPlanning\": {\"score\": <0-10>, \"maxScore\": 10, \"details\": \"<explanation>\"},\n      \"longTermCarePlanning\": {\"score\": <0-10>, \"maxScore\": 10, \"details\": \"<explanation>\"}\n    }\n  },\n  \"estateComplexity\": {\n    \"level\": \"<simple, moderate, complex, or highly-complex>\",\n    \"factors\": [\"<list factors contributing to complexity>\"],\n    \"recommendedPlanningLevel\": \"<basic will-based, trust-based, or advanced multi-entity>\"\n  },\n  \"financialExposure\": {\n    \"estimatedProbateCost\": {\n      \"low\": <number>,\n      \"high\": <number>,\n      \"methodology\": \"<how calculated>\"\n    },\n    \"estimatedEstateTax\": {\n      \"federal\": <number>,\n      \"state\": <number>,\n      \"notes\": \"<explanation of calculations>\"\n    },\n    \"potentialSavingsFromPlanning\": {\n      \"probateAvoidance\": <number>,\n      \"taxReduction\": <number>,\n      \"assetProtection\": <number>,\n      \"total\": <number>\n    }\n  },\n  \"missingDocuments\": [\n    {\n      \"document\": \"<document name>\",\n      \"priority\": \"<critical, high, medium, or low>\",\n      \"urgency\": \"<immediate, within-30-days, within-90-days, or when-convenient>\",\n      \"reason\": \"<detailed explanation>\",\n      \"consequences\": \"<what happens without this document>\",\n      \"estimatedCostToCreate\": \"<dollar range>\",\n      \"estimatedCostOfNotHaving\": \"<dollar range or 'incalculable'>\"\n    }\n  ],\n  \"outdatedDocuments\": [\n    {\n      \"document\": \"<document name>\",\n      \"lastUpdated\": \"<date or 'unknown'>\",\n      \"issue\": \"<what's outdated>\",\n      \"risk\": \"<what could go wrong>\",\n      \"recommendation\": \"<specific action>\"\n    }\n  ],\n  \"inconsistencies\": [\n    {\n      \"type\": \"<beneficiary-mismatch, titling-issue, goal-conflict, or family-structure>\",\n      \"issue\": \"<describe the inconsistency>\",\n      \"details\": \"<specific details>\",\n      \"risk\": \"<potential consequences>\",\n      \"resolution\": \"<how to fix>\"\n    }\n  ],\n  \"taxStrategies\": [\n    {\n      \"strategy\": \"<strategy name>\",\n      \"type\": \"<income-tax, estate-tax, gift-tax, or capital-gains>\",\n      \"applicability\": \"<why this applies to this client>\",\n      \"estimatedSavings\": \"<dollar amount or range>\",\n      \"complexity\": \"<simple, moderate, or complex>\",\n      \"implementation\": \"<steps to implement>\",\n      \"timeframe\": \"<when to implement>\",\n      \"risks\": \"<potential downsides>\"\n    }\n  ],\n  \"scenarioAnalysis\": {\n    \"deathTomorrow\": {\n      \"whatHappens\": \"<detailed description>\",\n      \"whoInherits\": \"<beneficiary breakdown>\",\n      \"probateRequired\": <boolean>,\n      \"estimatedSettlementTime\": \"<timeframe>\",\n      \"estimatedCosts\": <number>,\n      \"familyImpact\": \"<description>\",\n      \"minorChildrenImpact\": \"<description if applicable>\"\n    },\n    \"incapacity\": {\n      \"whoManagesFinances\": \"<name or 'court-appointed conservator'>\",\n      \"whoMakesMedicalDecisions\": \"<name or 'court-appointed'>\",\n      \"accessToAccounts\": \"<description>\",\n      \"businessContinuity\": \"<description if applicable>\",\n      \"estimatedConservatorshipCost\": <number>\n    },\n    \"spouseDiesFirst\": {\n      \"applicability\": \"<applicable or not-married>\",\n      \"assetTransfer\": \"<description>\",\n      \"taxImplications\": \"<description>\",\n      \"portabilityElection\": \"<needed, not-needed, or not-applicable>\"\n    },\n    \"bothParentsDie\": {\n      \"applicability\": \"<applicable or no-minor-children>\",\n      \"guardianship\": \"<named guardian or 'court decides'>\",\n      \"inheritanceManagement\": \"<trust, custodial account, or 'court supervision'>\",\n      \"concerns\": [\"<list of concerns>\"]\n    },\n    \"estateDoubles\": {\n      \"projectedValue\": <number>,\n      \"newTaxExposure\": \"<description>\",\n      \"planningChangesNeeded\": [\"<list of changes>\"]\n    },\n    \"exemptionSunset2026\": {\n      \"currentExemption\": 13610000,\n      \"projectedExemption\": 7000000,\n      \"clientExposure\": \"<description>\",\n      \"recommendedAction\": \"<specific recommendation>\"\n    }\n  },\n  \"medicaidPlanning\": {\n    \"riskLevel\": \"<low, moderate, high, or critical>\",\n    \"currentExposure\": \"<description>\",\n    \"lookbackConcerns\": [\"<list any transfers in lookback period>\"],\n    \"protectionStrategies\": [\n      {\n        \"strategy\": \"<strategy name>\",\n        \"effectiveness\": \"<description>\",\n        \"timing\": \"<when to implement>\",\n        \"cost\": \"<implementation cost>\"\n      }\n    ],\n    \"longTermCareInsurance\": {\n      \"recommended\": <boolean>,\n      \"reason\": \"<explanation>\",\n      \"estimatedPremium\": \"<if recommendable>\"\n    }\n  },\n  \"stateSpecificConsiderations\": [\n    {\n      \"topic\": \"<topic>\",\n      \"rule\": \"<state-specific rule>\",\n      \"impact\": \"<how this affects the client>\",\n      \"action\": \"<what to do about it>\",\n      \"citation\": \"<legal citation>\"\n    }\n  ],\n  \"prioritizedRecommendations\": [\n    {\n      \"rank\": <number 1-N>,\n      \"action\": \"<specific action>\",\n      \"category\": \"<documents, tax, asset-protection, family, or compliance>\",\n      \"priority\": \"<critical, high, medium, or low>\",\n      \"timeline\": \"<immediate, 30-days, 90-days, 6-months, or 1-year>\",\n      \"estimatedCost\": \"<dollar range>\",\n      \"estimatedBenefit\": \"<dollar range or description>\",\n      \"dependsOn\": [\"<list of prerequisite actions by rank>\"],\n      \"detailedSteps\": [\"<step 1>\", \"<step 2>\", \"...\"]\n    }\n  ],\n  \"professionalReferrals\": [\n    {\n      \"professionalType\": \"<estate-attorney, CPA, financial-advisor, insurance-agent, or elder-law-attorney>\",\n      \"reason\": \"<why this professional is needed>\",\n      \"urgency\": \"<immediate, soon, or when-convenient>\",\n      \"questionsToAsk\": [\"<list of questions for the professional>\"]\n    }\n  ]\n}\n\nIMPORTANT:\n- Calculate the score based on actual deficiencies found, NOT a default\n- Be specific with dollar amounts when possible\n- Reference state-specific laws by citation\n- The score should reflect reality: missing critical documents = low score\n- Use the Write tool to save the JSON file\n\nNow perform the comprehensive analysis and save the results.`;\n}\n\nasync function callE2B(prompt: string, baseUrl: string, outputFile: string): Promise<{ success: boolean; stdout?: string; fileContent?: string; error?: string }> {\n  // Create abort controller with 10 minute timeout for comprehensive analysis\n  const controller = new AbortController();\n  const timeoutId = setTimeout(() => controller.abort(), 600000); // 10 minutes\n\n  try {\n    const response = await fetch(`${baseUrl}${E2B_API_URL}`, {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify({\n        prompt,\n        outputFile,\n        timeoutMs: 0, // Disable E2B command timeout\n      }),\n      signal: controller.signal,\n    });\n\n    clearTimeout(timeoutId);\n\n    if (!response.ok) {\n      const errorText = await response.text();\n      return { success: false, error: `E2B API call failed: ${response.status} ${errorText}` };\n    }\n\n    return response.json();\n  } catch (error) {\n    clearTimeout(timeoutId);\n    throw error;\n  }\n}\n\nfunction extractJSON(result: { stdout?: string; fileContent?: string }): Record<string, unknown> | null {\n  // Try file content first (most reliable)\n  if (result.fileContent) {\n    try {\n      return JSON.parse(result.fileContent);\n    } catch (e) {\n      console.error(\"Failed to parse fileContent:\", e);\n    }\n  }\n\n  // Try to extract from stdout\n  if (result.stdout) {\n    // Try code block first\n    const codeBlockMatch = result.stdout.match(/```(?:json)?\\s*\\n([\\s\\S]*?)\\n```/);\n    if (codeBlockMatch) {\n      try {\n        return JSON.parse(codeBlockMatch[1]);\n      } catch (e) {\n        console.error(\"Failed to parse code block JSON:\", e);\n      }\n    }\n\n    // Try to find raw JSON object\n    const jsonStart = result.stdout.indexOf('{');\n    const jsonEnd = result.stdout.lastIndexOf('}');\n    if (jsonStart !== -1 && jsonEnd > jsonStart) {\n      try {\n        return JSON.parse(result.stdout.substring(jsonStart, jsonEnd + 1));\n      } catch (e) {\n        console.error(\"Failed to parse raw JSON from stdout:\", e);\n      }\n    }\n  }\n\n  return null;\n}\n\nexport async function POST(req: Request) {\n  try {\n    const { intakeData } = await req.json();\n\n    if (!intakeData) {\n      return NextResponse.json({ error: \"Intake data is required\" }, { status: 400 });\n    }\n\n    // Parse the intake data\n    const parsed = parseIntakeData(intakeData);\n\n    // Build comprehensive prompt\n    const prompt = buildComprehensivePrompt(parsed);\n\n    // Get base URL\n    const baseUrl = process.env.NEXT_PUBLIC_APP_URL ||\n                    (process.env.VERCEL_URL ? `https://${process.env.VERCEL_URL}` : \"http://localhost:3000\");\n\n    // Execute main analysis via Claude Code in E2B\n    console.log(\"Starting comprehensive gap analysis...\");\n    const result = await callE2B(prompt, baseUrl, \"analysis.json\");\n\n    if (!result.success) {\n      throw new Error(result.error || \"E2B execution failed\");\n    }\n\n    // Extract and parse the JSON result\n    let analysisResult = extractJSON(result);\n\n    // Calculate score if not present or if we need to override\n    if (analysisResult) {\n      const calculatedScore = calculateScore(parsed, analysisResult);\n\n      // If the analysis has a score, validate it; otherwise use calculated\n      if (analysisResult.overallScore && typeof analysisResult.overallScore === 'object') {\n        const overallScore = analysisResult.overallScore as Record<string, unknown>;\n        // Use the higher confidence score (calculated vs AI-generated)\n        const aiScore = typeof overallScore.score === 'number' ? overallScore.score : 50;\n        // Blend the scores - trust AI more but validate with calculation\n        overallScore.score = Math.round((aiScore * 0.7) + (calculatedScore * 0.3));\n        overallScore.calculatedScore = calculatedScore;\n        overallScore.aiGeneratedScore = aiScore;\n      } else {\n        // Create overallScore structure if missing\n        analysisResult.overallScore = {\n          score: calculatedScore,\n          grade: calculatedScore >= 90 ? 'A' : calculatedScore >= 80 ? 'B' : calculatedScore >= 70 ? 'C' : calculatedScore >= 60 ? 'D' : 'F',\n          summary: \"Score calculated based on document completeness and estate planning best practices.\"\n        };\n      }\n\n      // Also set top-level score for backward compatibility\n      analysisResult.score = (analysisResult.overallScore as Record<string, unknown>).score;\n    }\n\n    // If parsing failed completely, create a detailed fallback\n    if (!analysisResult) {\n      const calculatedScore = calculateScore(parsed, {});\n      analysisResult = {\n        score: calculatedScore,\n        overallScore: {\n          score: calculatedScore,\n          grade: calculatedScore >= 90 ? 'A' : calculatedScore >= 80 ? 'B' : calculatedScore >= 70 ? 'C' : calculatedScore >= 60 ? 'D' : 'F',\n          summary: \"Analysis completed but structured output could not be parsed. Review raw output for details.\",\n          calculatedScore: calculatedScore\n        },\n        estateComplexity: { level: \"unknown\", factors: [\"Unable to parse AI analysis\"] },\n        missingDocuments: [],\n        outdatedDocuments: [],\n        inconsistencies: [],\n        taxStrategies: [],\n        scenarioAnalysis: {},\n        medicaidPlanning: { riskLevel: \"unknown\" },\n        stateSpecificConsiderations: [],\n        prioritizedRecommendations: [{\n          rank: 1,\n          action: \"Review raw analysis output and consult estate planning attorney\",\n          category: \"documents\",\n          priority: \"high\",\n          timeline: \"immediate\",\n          estimatedCost: \"Varies\",\n          estimatedBenefit: \"Proper estate planning\",\n          dependsOn: [],\n          detailedSteps: [\"Review the raw analysis output below\", \"Consult with a licensed estate planning attorney\"]\n        }],\n        professionalReferrals: [{\n          professionalType: \"estate-attorney\",\n          reason: \"Comprehensive estate plan review needed\",\n          urgency: \"soon\",\n          questionsToAsk: [\"What documents do I need?\", \"How can I minimize probate costs?\"]\n        }],\n        rawAnalysis: result.stdout\n      };\n    }\n\n    return NextResponse.json({\n      success: true,\n      analysisResult,\n      stdout: result.stdout,\n    });\n\n  } catch (error) {\n    console.error(\"Gap analysis error:\", error);\n    return NextResponse.json(\n      {\n        success: false,\n        error: error instanceof Error ? error.message : \"Unknown error\"\n      },\n      { status: 500 }\n    );\n  }\n}\n"],"names":[],"mappings":"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"}}]
}