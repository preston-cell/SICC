(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,77953,e=>{"use strict";var t=e.i(43476),a=e.i(71645),r=e.i(18566);e.i(50711);var s=e.i(82045),l=e.i(83394),n=e.i(22016);let i=[{value:"will",label:"Will",description:"Last Will and Testament"},{value:"trust",label:"Trust",description:"Revocable or Irrevocable Trust"},{value:"poa_financial",label:"Financial POA",description:"Power of Attorney for Finances"},{value:"poa_healthcare",label:"Healthcare POA",description:"Healthcare Power of Attorney"},{value:"healthcare_directive",label:"Healthcare Directive",description:"Living Will / Advance Directive"},{value:"deed",label:"Deed",description:"Property Deed or Title"},{value:"insurance_policy",label:"Insurance Policy",description:"Life Insurance or Annuity"},{value:"beneficiary_form",label:"Beneficiary Form",description:"Beneficiary Designation"},{value:"other",label:"Other",description:"Other Estate Document"}];function o(){let e=(0,r.useRouter)(),o=(0,r.useSearchParams)().get("planId"),[d,c]=(0,a.useState)(!1),[u,x]=(0,a.useState)(o||null),[m,h]=(0,a.useState)(!1),[g,p]=(0,a.useState)(0),[b,y]=(0,a.useState)(null),[f,k]=(0,a.useState)("will"),[v,j]=(0,a.useState)(!1),[N,w]=(0,a.useState)(!1),[M,D]=(0,a.useState)(!1),C=(0,a.useRef)(null),I=(0,s.useMutation)(l.api.estatePlanning.createEstatePlan),L=(0,s.useMutation)(l.api.uploadedDocuments.generateUploadUrl),P=(0,s.useMutation)(l.api.uploadedDocuments.saveUploadedDocument),S=(0,s.useMutation)(l.api.uploadedDocuments.deleteUploadedDocument),A=(0,s.useAction)(l.api.documentAnalysis.analyzeDocument),E=(0,s.useAction)(l.api.documentExtraction.extractIntakeData),B=(0,s.useQuery)(l.api.uploadedDocuments.getUploadedDocuments,u?{estatePlanId:u}:"skip"),W=(0,s.useQuery)(l.api.extractedData.getExtractedData,u?{estatePlanId:u}:"skip");(0,a.useEffect)(()=>{(async()=>{if(!o&&!u&&!d){let t=localStorage.getItem("estatePlanId");if(t){x(t),e.replace(`/intake/upload?planId=${t}`);return}c(!0);try{let t=`session_${Date.now()}_${Math.random().toString(36).substring(7)}`,a=await I({sessionId:t,name:"My Estate Plan"});localStorage.setItem("estatePlanSessionId",t),localStorage.setItem("estatePlanId",a),x(a),e.replace(`/intake/upload?planId=${a}`)}catch(e){console.error("Failed to create estate plan:",e)}finally{c(!1)}}})()},[o,u,d,I,e]);let z=(0,a.useCallback)(async e=>{if(u){if(!e.type.includes("pdf"))return void y("Please upload a PDF file");if(e.size>0x1400000)return void y("File size must be less than 20MB");h(!0),p(10),y(null);try{let t=await L();p(30);let a=await fetch(t,{method:"POST",headers:{"Content-Type":e.type},body:e});if(!a.ok)throw Error("Upload failed");let{storageId:r}=await a.json();p(60);let s=await P({estatePlanId:u,storageId:r,fileName:e.name,fileSize:e.size,mimeType:e.type,documentType:f});p(80),A({documentId:s}),p(100),C.current&&(C.current.value="")}catch(e){y(e instanceof Error?e.message:"Upload failed")}finally{h(!1),p(0)}}},[u,f,L,P,A]),T=(0,a.useCallback)(e=>{e.preventDefault(),j(!0)},[]),U=(0,a.useCallback)(e=>{e.preventDefault(),j(!1)},[]),H=(0,a.useCallback)(e=>{e.preventDefault(),j(!1);let t=e.dataTransfer.files;t.length>0&&z(t[0])},[z]),F=(0,a.useCallback)(async e=>{confirm("Delete this document?")&&await S({documentId:e})},[S]),$=(0,a.useCallback)(async()=>{if(u){w(!0);try{let e=await E({estatePlanId:u});e.success?D(!0):y(e.error||"Extraction failed")}catch(e){y(e instanceof Error?e.message:"Extraction failed")}finally{w(!1)}}},[u,E]),_=()=>{u&&e.push(`/intake/personal?planId=${u}`)};if(d)return(0,t.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,t.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})});let O=B&&B.length>0,R=W&&W.length>0;return(0,t.jsxs)("div",{className:"max-w-3xl mx-auto space-y-8",children:[(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-blue-100 dark:bg-blue-900/30 rounded-full mb-4",children:(0,t.jsx)("svg",{className:"w-8 h-8 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),(0,t.jsx)("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Do you have existing estate documents?"}),(0,t.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mt-2 max-w-xl mx-auto",children:"Upload your existing wills, trusts, or powers of attorney. We'll extract information to pre-fill your questionnaire and save you time."})]}),(0,t.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6",children:[(0,t.jsx)("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Upload Documents"}),(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Document Type"}),(0,t.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2",children:i.slice(0,6).map(e=>(0,t.jsxs)("button",{type:"button",onClick:()=>k(e.value),className:`
                  p-3 rounded-lg border text-left transition-colors text-sm
                  ${f===e.value?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-200 dark:border-gray-700 hover:border-blue-300"}
                `,children:[(0,t.jsx)("div",{className:"font-medium text-gray-900 dark:text-white",children:e.label}),(0,t.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-0.5",children:e.description})]},e.value))}),(0,t.jsx)("div",{className:"mt-2 flex gap-2",children:i.slice(6).map(e=>(0,t.jsx)("button",{type:"button",onClick:()=>k(e.value),className:`
                  px-3 py-1.5 rounded-lg border text-sm transition-colors
                  ${f===e.value?"border-blue-500 bg-blue-50 dark:bg-blue-900/20 text-blue-700 dark:text-blue-300":"border-gray-200 dark:border-gray-700 text-gray-600 dark:text-gray-400 hover:border-blue-300"}
                `,children:e.label},e.value))})]}),(0,t.jsxs)("div",{onDragOver:T,onDragLeave:U,onDrop:H,onClick:()=>C.current?.click(),className:`
            border-2 border-dashed rounded-lg p-8 text-center cursor-pointer transition-colors
            ${v?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-300 dark:border-gray-600 hover:border-blue-400 dark:hover:border-blue-500"}
            ${m?"pointer-events-none opacity-50":""}
          `,children:[(0,t.jsx)("input",{ref:C,type:"file",accept:".pdf",onChange:e=>e.target.files?.[0]&&z(e.target.files[0]),className:"hidden"}),m?(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-blue-600 mx-auto mb-3"}),(0,t.jsxs)("p",{className:"text-gray-600 dark:text-gray-400",children:["Uploading... ",g,"%"]})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("svg",{className:"w-10 h-10 mx-auto mb-3 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),(0,t.jsxs)("p",{className:"text-gray-600 dark:text-gray-400",children:[(0,t.jsx)("span",{className:"font-medium text-blue-600 dark:text-blue-400",children:"Click to upload"})," ","or drag and drop"]}),(0,t.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-500 mt-1",children:"PDF files up to 20MB"})]})]}),b&&(0,t.jsx)("div",{className:"mt-4 p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:(0,t.jsx)("p",{className:"text-sm text-red-700 dark:text-red-300",children:b})}),O&&(0,t.jsxs)("div",{className:"mt-6",children:[(0,t.jsxs)("h3",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:["Uploaded (",B.length,")"]}),(0,t.jsx)("div",{className:"space-y-2",children:B.map(e=>(0,t.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-900/30 rounded-lg",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("svg",{className:"w-6 h-6 text-red-500 flex-shrink-0",fill:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8l-6-6z"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-900 dark:text-white truncate max-w-[200px]",children:e.fileName}),(0,t.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:i.find(t=>t.value===e.documentType)?.label})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:`
                        text-xs px-2 py-0.5 rounded-full
                        ${"completed"===e.analysisStatus?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-300":"failed"===e.analysisStatus?"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-300":"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-300"}
                      `,children:"completed"===e.analysisStatus?"Ready":"failed"===e.analysisStatus?"Error":"Processing..."}),(0,t.jsx)("button",{onClick:()=>F(e._id),className:"p-1 text-gray-400 hover:text-red-500 transition-colors",children:(0,t.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]},e._id))})]})]}),O&&(0,t.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6",children:[(0,t.jsx)("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Extract Information"}),N?(0,t.jsxs)("div",{className:"text-center py-6",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-blue-600 mx-auto mb-3"}),(0,t.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"AI is reading your documents..."}),(0,t.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-500 mt-1",children:"Extracting names, dates, beneficiaries, and more"})]}):M||R?(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 p-4 bg-green-50 dark:bg-green-900/20 rounded-lg",children:[(0,t.jsx)("div",{className:"w-10 h-10 bg-green-100 dark:bg-green-900/30 rounded-full flex items-center justify-center flex-shrink-0",children:(0,t.jsx)("svg",{className:"w-5 h-5 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium text-green-800 dark:text-green-200",children:"Extraction Complete"}),(0,t.jsx)("p",{className:"text-sm text-green-700 dark:text-green-300",children:"We found information to pre-fill your questionnaire"})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Data extracted for:"}),(0,t.jsx)("div",{className:"grid grid-cols-2 gap-2",children:W?.map(e=>{let a={personal:{label:"Personal Info",icon:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"},family:{label:"Family Details",icon:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"},assets:{label:"Assets",icon:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"},existing_documents:{label:"Existing Docs",icon:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"},goals:{label:"Goals & Wishes",icon:"M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z"}}[e.section]||{label:e.section,icon:""};return(0,t.jsxs)("div",{className:"flex items-center gap-2 p-2 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:[(0,t.jsx)("svg",{className:"w-4 h-4 text-blue-600 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:a.icon})}),(0,t.jsx)("span",{className:"text-sm text-blue-800 dark:text-blue-200 font-medium",children:a.label}),(0,t.jsx)("svg",{className:"w-4 h-4 text-green-500 ml-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})]},e.section)})})]}),(0,t.jsx)("div",{className:"p-3 bg-gray-50 dark:bg-gray-900/30 rounded-lg",children:(0,t.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[(0,t.jsx)("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Next:"})," ","Review the pre-filled forms and make any corrections. Fields from your documents will be marked with a blue badge."]})})]}):(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:"Our AI will read your documents and extract names, addresses, beneficiaries, asset information, and more to pre-fill your questionnaire."}),(0,t.jsxs)("button",{onClick:$,className:"w-full px-4 py-3 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-colors flex items-center justify-center gap-2",children:[(0,t.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),"Extract with AI"]})]})]}),(0,t.jsx)("div",{className:"flex flex-col sm:flex-row gap-4",children:O&&(M||R)?(0,t.jsxs)("button",{onClick:_,className:"flex-1 px-6 py-4 bg-blue-600 text-white rounded-lg font-medium text-lg hover:bg-blue-700 transition-colors flex items-center justify-center gap-2",children:["Continue to Questionnaire",(0,t.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]}):O?(0,t.jsx)("button",{onClick:_,className:"flex-1 px-6 py-4 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg font-medium text-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors",children:"Continue Without Extraction"}):(0,t.jsx)("button",{onClick:()=>{u&&e.push(`/intake/personal?planId=${u}`)},className:"flex-1 px-6 py-4 bg-blue-600 text-white rounded-lg font-medium text-lg hover:bg-blue-700 transition-colors",children:"I Don't Have Documents - Start Fresh"})}),(0,t.jsx)("div",{className:"bg-gray-50 dark:bg-gray-900/30 rounded-lg p-4",children:(0,t.jsxs)("div",{className:"flex gap-3",children:[(0,t.jsx)("svg",{className:"w-5 h-5 text-gray-400 flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,t.jsxs)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:[(0,t.jsx)("p",{className:"font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Why upload documents?"}),(0,t.jsxs)("ul",{className:"list-disc list-inside space-y-1",children:[(0,t.jsx)("li",{children:"Auto-fill your questionnaire with existing information"}),(0,t.jsx)("li",{children:"Identify gaps in your current estate plan"}),(0,t.jsx)("li",{children:"Get AI-powered analysis of your documents"}),(0,t.jsx)("li",{children:"Compare your documents against best practices"})]})]})]})}),(0,t.jsx)("div",{className:"text-center",children:(0,t.jsx)(n.default,{href:"/intake",className:"text-sm text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300",children:"Back to overview"})})]})}function d(){return(0,t.jsx)(a.Suspense,{fallback:(0,t.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,t.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}),children:(0,t.jsx)(o,{})})}e.s(["default",()=>d])}]);