{"version":3,"sources":["../../../../app/analysis/%5BestatePlanId%5D/page.tsx","../../../../app/components/GapAnalysisCard.tsx","../../../../components/GapAnalysisProgress.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState, useMemo, useCallback } from \"react\";\nimport { useParams, useRouter } from \"next/navigation\";\nimport { useQuery, useMutation } from \"convex/react\";\nimport { api } from \"../../../convex/_generated/api\";\nimport { Id } from \"../../../convex/_generated/dataModel\";\nimport Link from \"next/link\";\nimport { Tabs, TabPanel } from \"../../components/ui/Tabs\";\nimport Badge from \"../../components/ui/Badge\";\nimport Button from \"../../components/ui/Button\";\nimport GapAnalysisCard, { ScoreRing, DOCUMENT_TYPE_NAMES } from \"../../components/GapAnalysisCard\";\nimport { GapAnalysisProgress } from \"@/components/GapAnalysisProgress\";\nimport { AnalysisFloatingWidget } from \"@/components/AnalysisFloatingWidget\";\n\ninterface MissingDocument {\n  // New API fields\n  document?: string;\n  priority?: \"critical\" | \"high\" | \"medium\" | \"low\";\n  urgency?: string;\n  reason?: string;\n  consequences?: string | string[];\n  estimatedCostToCreate?: { low: number; high: number };\n  stateRequirements?: string;\n  // Legacy fields for backward compatibility\n  type?: string;\n}\n\ninterface OutdatedDocument {\n  document?: string;\n  type?: string;\n  issue?: string;\n  risk?: string;\n  recommendation?: string;\n  lastUpdated?: string;\n  yearsOld?: number;\n  estimatedUpdateCost?: { low: number; high: number };\n}\n\ninterface Inconsistency {\n  type?: string;\n  severity?: \"critical\" | \"high\" | \"medium\" | \"low\";\n  issue?: string;\n  details?: string;\n  potentialConsequence?: string;\n  resolution?: string;\n  recommendation?: string;\n  estimatedResolutionCost?: { low: number; high: number };\n}\n\ninterface Recommendation {\n  rank?: number;\n  action?: string;\n  category?: string;\n  priority?: \"critical\" | \"high\" | \"medium\" | \"low\";\n  timeline?: string;\n  estimatedCost?: { low: number; high: number };\n  estimatedBenefit?: string | { low: number; high: number };\n  detailedSteps?: string[];\n  professionalNeeded?: string;\n  riskOfDelay?: string;\n  // Legacy fields\n  reason?: string;\n}\n\ninterface StateNote {\n  topic?: string;\n  rule?: string;\n  impact?: string;\n  action?: string;\n  citation?: string;\n  // Legacy fields\n  note?: string;\n  relevance?: string;\n}\n\n// Score interpretation helper\nfunction getScoreInterpretation(score: number): {\n  label: string;\n  description: string;\n  color: string;\n} {\n  if (score >= 80) {\n    return {\n      label: \"Excellent\",\n      description: \"Your estate plan is comprehensive and well-organized.\",\n      color: \"text-[var(--success)]\",\n    };\n  }\n  if (score >= 60) {\n    return {\n      label: \"Good\",\n      description: \"Your estate plan is solid but has some room for improvement.\",\n      color: \"text-[var(--warning)]\",\n    };\n  }\n  if (score >= 40) {\n    return {\n      label: \"Needs Work\",\n      description: \"Several important areas need attention in your estate plan.\",\n      color: \"text-[var(--warning)]\",\n    };\n  }\n  return {\n    label: \"Critical\",\n    description: \"Your estate plan has significant gaps that should be addressed soon.\",\n    color: \"text-[var(--error)]\",\n  };\n}\n\n// Score breakdown interface\ninterface ScoreBreakdown {\n  startingScore: number;\n  deductions: Array<{\n    reason: string;\n    points: number;\n    category: string;\n  }>;\n  finalScore: number;\n  summary: string;\n}\n\nexport default function AnalysisPage() {\n  const params = useParams();\n  const router = useRouter();\n  const estatePlanId = params.estatePlanId as Id<\"estatePlans\">;\n\n  const [isRunning, setIsRunning] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [activeTab, setActiveTab] = useState(\"overview\");\n  const [analysisMode, setAnalysisMode] = useState<\"quick\" | \"comprehensive\">(\"quick\");\n  const [progressStep, setProgressStep] = useState<string>(\"\");\n  const [progressLog, setProgressLog] = useState<string[]>([]);\n  const [comprehensiveRunId, setComprehensiveRunId] = useState<Id<\"gapAnalysisRuns\"> | null>(null);\n\n  // Fetch estate plan and analysis\n  const estatePlan = useQuery(api.queries.getEstatePlan, { estatePlanId });\n  const latestAnalysis = useQuery(api.queries.getLatestGapAnalysis, { estatePlanId });\n  const intakeProgress = useQuery(api.queries.getIntakeProgress, { estatePlanId });\n\n  // Check for active comprehensive analysis run\n  const activeRun = useQuery(api.gapAnalysisProgress.getActiveRun, { estatePlanId });\n\n  // Get full intake data for analysis\n  const intakeData = useQuery(api.queries.getEstatePlanFull, { estatePlanId });\n\n  // Mutation to save gap analysis results\n  const saveGapAnalysis = useMutation(api.estatePlanning.saveGapAnalysisPublic);\n\n  const handleRunAnalysis = useCallback(async (mode: \"quick\" | \"comprehensive\" = \"quick\") => {\n    setIsRunning(true);\n    setError(null);\n    setProgressLog([]);\n    setProgressStep(mode === \"quick\" ? \"Initializing analysis...\" : \"Starting comprehensive analysis...\");\n\n    // Simulate progress updates for better UX\n    const progressSteps = mode === \"quick\"\n      ? [\n          \"Connecting to AI assistant...\",\n          \"Analyzing your documents...\",\n          \"Reviewing state requirements...\",\n          \"Identifying gaps...\",\n          \"Generating recommendations...\",\n        ]\n      : [\n          \"Phase 1: Researching state laws...\",\n          \"Phase 1: Analyzing client context...\",\n          \"Phase 1: Creating document inventory...\",\n          \"Phase 2: Deep analysis in progress...\",\n          \"Phase 3: Synthesizing findings...\",\n          \"Generating final report...\",\n        ];\n\n    let stepIndex = 0;\n    const progressInterval = setInterval(() => {\n      if (stepIndex < progressSteps.length) {\n        setProgressStep(progressSteps[stepIndex]);\n        setProgressLog(prev => [...prev, progressSteps[stepIndex]]);\n        stepIndex++;\n      }\n    }, mode === \"quick\" ? 8000 : 30000);\n\n    try {\n      // Build intake data object for the API\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      const rawIntakeData = intakeData as any;\n      console.log(\"Raw intakeData from Convex:\", rawIntakeData);\n\n      const intakeArray = rawIntakeData?.intakeData || rawIntakeData?.intake || [];\n      console.log(\"Intake array:\", intakeArray);\n      console.log(\"Available sections:\", intakeArray.map?.((i: { section: string }) => i.section) || \"none\");\n\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      const beneficiaries = rawIntakeData?.beneficiaryDesignations || [];\n\n      // Get state from estate plan or from personal data (guided flow stores it there)\n      const personalSection = intakeArray?.find((i: { section: string }) => i.section === \"personal\");\n      let stateOfResidence = estatePlan?.stateOfResidence;\n      if (!stateOfResidence && personalSection?.data) {\n        try {\n          const personalData = JSON.parse(personalSection.data);\n          stateOfResidence = personalData.stateOfResidence;\n        } catch {\n          // Ignore parse errors\n        }\n      }\n\n      const apiIntakeData = {\n        estatePlan: { stateOfResidence },\n        personal: personalSection,\n        family: intakeArray?.find((i: { section: string }) => i.section === \"family\"),\n        assets: intakeArray?.find((i: { section: string }) => i.section === \"assets\"),\n        existingDocuments: intakeArray?.find((i: { section: string }) => i.section === \"existing_documents\"),\n        goals: intakeArray?.find((i: { section: string }) => i.section === \"goals\"),\n        beneficiaryDesignations: beneficiaries,\n      };\n\n      console.log(\"Built apiIntakeData:\", JSON.stringify(apiIntakeData, null, 2));\n\n      // Call different endpoints based on mode\n      // Comprehensive mode calls orchestrate directly to avoid nested fetch timeout\n      const endpoint = mode === \"comprehensive\"\n        ? \"/api/gap-analysis/orchestrate\"\n        : \"/api/gap-analysis\";\n\n      const response = await fetch(endpoint, {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ intakeData: apiIntakeData, mode, estatePlanId }),\n      });\n\n      const result = await response.json();\n\n      // For comprehensive mode, the orchestration is async - we get a runId back\n      if (mode === \"comprehensive\") {\n        if (result.runId) {\n          // Orchestration started - redirect to preparation tasks page\n          console.log(\"Comprehensive analysis started, runId:\", result.runId);\n          setComprehensiveRunId(result.runId as Id<\"gapAnalysisRuns\">);\n          clearInterval(progressInterval);\n          // Redirect to preparation tasks page where user can work while analysis runs\n          router.push(`/analysis/${estatePlanId}/prepare?runId=${result.runId}`);\n          setIsRunning(false);\n          return;\n        } else if (!result.success) {\n          clearInterval(progressInterval);\n          setError(result.error || \"Failed to start comprehensive analysis\");\n          setIsRunning(false);\n          return;\n        }\n      }\n\n      if (!result.success) {\n        setError(result.error || \"Analysis failed\");\n        return;\n      }\n\n      // Debug: Log what we received from the API\n      console.log(\"Gap analysis API response:\", {\n        success: result.success,\n        hasAnalysisResult: !!result.analysisResult,\n        score: result.analysisResult?.score,\n        overallScore: result.analysisResult?.overallScore,\n        missingDocsCount: result.analysisResult?.missingDocuments?.length || 0,\n        recommendationsCount: (result.analysisResult?.recommendations || result.analysisResult?.prioritizedRecommendations)?.length || 0,\n        stateNotesCount: (result.analysisResult?.stateSpecificNotes || result.analysisResult?.stateSpecificConsiderations)?.length || 0,\n      });\n\n      // Clear progress interval\n      clearInterval(progressInterval);\n      setProgressStep(\"Analysis complete!\");\n\n      // Validate we got meaningful data\n      const missingDocs = result.analysisResult?.missingDocuments || [];\n      const recommendations = result.analysisResult?.recommendations || result.analysisResult?.prioritizedRecommendations || [];\n      const stateNotes = result.analysisResult?.stateSpecificNotes || result.analysisResult?.stateSpecificConsiderations || [];\n\n      if (missingDocs.length === 0 && recommendations.length === 0) {\n        console.warn(\"WARNING: API returned empty analysis data - possible parsing issue\");\n        console.warn(\"Full result structure:\", JSON.stringify(result.analysisResult, null, 2).slice(0, 1000));\n      }\n\n      // Log what we're about to save\n      console.log(\"Saving to Convex:\", {\n        score: result.analysisResult?.score || 50,\n        missingDocsCount: missingDocs.length,\n        recommendationsCount: recommendations.length,\n        stateNotesCount: stateNotes.length,\n      });\n\n      // Save results to Convex\n      await saveGapAnalysis({\n        estatePlanId,\n        score: result.analysisResult.score || 50,\n        scoreBreakdown: result.analysisResult.scoreBreakdown\n          ? JSON.stringify(result.analysisResult.scoreBreakdown)\n          : undefined,\n        estateComplexity: result.analysisResult.estateComplexity\n          ? JSON.stringify(result.analysisResult.estateComplexity)\n          : undefined,\n        estimatedEstateTax: (result.analysisResult.estimatedEstateTax || result.analysisResult.financialExposure?.estimatedEstateTax)\n          ? JSON.stringify(result.analysisResult.estimatedEstateTax || result.analysisResult.financialExposure?.estimatedEstateTax)\n          : undefined,\n        missingDocuments: JSON.stringify(result.analysisResult.missingDocuments || []),\n        outdatedDocuments: JSON.stringify(result.analysisResult.outdatedDocuments || []),\n        inconsistencies: JSON.stringify(result.analysisResult.inconsistencies || []),\n        taxOptimization: (result.analysisResult.taxOptimization || result.analysisResult.taxStrategies)\n          ? JSON.stringify(result.analysisResult.taxOptimization || result.analysisResult.taxStrategies)\n          : undefined,\n        medicaidPlanning: result.analysisResult.medicaidPlanning\n          ? JSON.stringify(result.analysisResult.medicaidPlanning)\n          : undefined,\n        recommendations: JSON.stringify(result.analysisResult.recommendations || result.analysisResult.prioritizedRecommendations || []),\n        stateSpecificNotes: JSON.stringify(result.analysisResult.stateSpecificNotes || result.analysisResult.stateSpecificConsiderations || []),\n        rawAnalysis: result.analysisResult.rawAnalysis || result.stdout,\n      });\n\n    } catch (err) {\n      clearInterval(progressInterval);\n      setError(err instanceof Error ? err.message : \"An error occurred\");\n    } finally {\n      clearInterval(progressInterval);\n      setIsRunning(false);\n      setProgressStep(\"\");\n    }\n  }, [estatePlanId, estatePlan, intakeData, saveGapAnalysis]);\n\n  // Parse analysis data\n  const parseJsonArray = <T,>(jsonString: string | undefined): T[] => {\n    if (!jsonString) return [];\n    try {\n      return JSON.parse(jsonString) as T[];\n    } catch {\n      return [];\n    }\n  };\n\n  const missingDocs = parseJsonArray<MissingDocument>(latestAnalysis?.missingDocuments);\n  const outdatedDocs = parseJsonArray<OutdatedDocument>(latestAnalysis?.outdatedDocuments);\n  const inconsistencies = parseJsonArray<Inconsistency>(latestAnalysis?.inconsistencies);\n  const recommendations = parseJsonArray<Recommendation>(latestAnalysis?.recommendations);\n  const stateNotes = parseJsonArray<StateNote>(latestAnalysis?.stateSpecificNotes);\n\n  // Parse score breakdown\n  const scoreBreakdown: ScoreBreakdown | null = useMemo(() => {\n    if (!latestAnalysis?.scoreBreakdown) return null;\n    try {\n      return JSON.parse(latestAnalysis.scoreBreakdown) as ScoreBreakdown;\n    } catch {\n      return null;\n    }\n  }, [latestAnalysis?.scoreBreakdown]);\n\n  // Compute issues count (outdated + inconsistencies)\n  const issuesCount = outdatedDocs.length + inconsistencies.length;\n\n  // Check if intake is complete\n  const intakeComplete = intakeProgress?.isAllComplete;\n\n  // Score interpretation\n  const scoreInfo = latestAnalysis?.score\n    ? getScoreInterpretation(latestAnalysis.score)\n    : null;\n\n  // Tab configuration\n  const tabs = useMemo(\n    () => [\n      {\n        id: \"overview\",\n        label: \"Overview\",\n        icon: (\n          <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z\" />\n          </svg>\n        ),\n      },\n      {\n        id: \"missing\",\n        label: `Missing (${missingDocs.length})`,\n        icon: (\n          <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\" />\n          </svg>\n        ),\n        disabled: missingDocs.length === 0,\n      },\n      {\n        id: \"issues\",\n        label: `Issues (${issuesCount})`,\n        icon: (\n          <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\" />\n          </svg>\n        ),\n        disabled: issuesCount === 0,\n      },\n      {\n        id: \"recommendations\",\n        label: `Actions (${recommendations.length})`,\n        icon: (\n          <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z\" />\n          </svg>\n        ),\n        disabled: recommendations.length === 0,\n      },\n      {\n        id: \"state\",\n        label: \"State Notes\",\n        icon: (\n          <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M3 21v-4m0 0V5a2 2 0 012-2h6.5l1 1H21l-3 6 3 6h-8.5l-1-1H5a2 2 0 00-2 2zm9-13.5V9\" />\n          </svg>\n        ),\n        disabled: stateNotes.length === 0,\n      },\n    ],\n    [missingDocs.length, issuesCount, recommendations.length, stateNotes.length]\n  );\n\n  // Print handler\n  const handlePrint = () => {\n    window.print();\n  };\n\n  if (!estatePlan) {\n    return (\n      <div className=\"min-h-screen bg-white flex items-center justify-center\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-[var(--accent-purple)] mx-auto\"></div>\n          <p className=\"mt-4 text-[var(--text-body)]\">Loading...</p>\n        </div>\n      </div>\n    );\n  }\n\n  // Determine if we should show the floating widget (active run or local comprehensiveRunId)\n  const showFloatingWidget = activeRun?.runId || comprehensiveRunId;\n  const floatingWidgetRunId = activeRun?.runId || comprehensiveRunId;\n\n  return (\n    <div className=\"min-h-screen bg-white print:bg-white\">\n      {/* Floating widget for active comprehensive analysis */}\n      {showFloatingWidget && (\n        <AnalysisFloatingWidget\n          runId={floatingWidgetRunId!}\n          estatePlanId={estatePlanId}\n          onComplete={() => {\n            setComprehensiveRunId(null);\n          }}\n        />\n      )}\n\n      {/* Header */}\n      <header className=\"bg-white shadow-sm print:hidden\">\n        <div className=\"max-w-5xl mx-auto px-4 py-4 flex items-center justify-between\">\n          <Link\n            href=\"/\"\n            className=\"text-xl font-bold text-[var(--text-heading)] hover:text-[var(--accent-purple)] transition-colors\"\n          >\n            Estate Planning Assistant\n          </Link>\n          <div className=\"flex items-center gap-3\">\n            {latestAnalysis && (\n              <Button\n                variant=\"outline\"\n                size=\"sm\"\n                onClick={handlePrint}\n                leftIcon={\n                  <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z\" />\n                  </svg>\n                }\n              >\n                Print Report\n              </Button>\n            )}\n            <Link\n              href={`/intake?planId=${estatePlanId}`}\n              className=\"text-sm text-[var(--text-muted)] hover:text-[var(--text-body)]\"\n            >\n              Back to Intake\n            </Link>\n          </div>\n        </div>\n      </header>\n\n      <main className=\"max-w-5xl mx-auto px-4 py-8\">\n        {/* Intake Incomplete Warning */}\n        {!intakeComplete && (\n          <div className=\"mb-6 bg-[var(--warning-muted)] border border-[var(--warning)] rounded-lg p-4 print:hidden\">\n            <div className=\"flex gap-3\">\n              <svg className=\"w-5 h-5 text-yellow-600 flex-shrink-0 mt-0.5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z\" />\n              </svg>\n              <div>\n                <h3 className=\"font-medium text-[var(--warning)]\">Intake Incomplete</h3>\n                <p className=\"text-sm text-[var(--warning)] mt-1\">\n                  Complete all intake sections for the most accurate analysis.\n                  You&apos;ve completed {intakeProgress?.completedCount || 0} of {intakeProgress?.totalCount || 5} sections.\n                </p>\n                <Link\n                  href={`/intake?planId=${estatePlanId}`}\n                  className=\"inline-block mt-2 text-sm font-medium text-[var(--warning)] hover:underline\"\n                >\n                  Complete Intake →\n                </Link>\n              </div>\n            </div>\n          </div>\n        )}\n\n        {/* Active Analysis Running Banner */}\n        {activeRun && !isRunning && (\n          <div className=\"mb-6 bg-[var(--accent-muted)] border border-[var(--accent-purple)]/30 rounded-xl p-5\">\n            <div className=\"flex items-center justify-between\">\n              <div className=\"flex items-center gap-4\">\n                <div className=\"w-10 h-10 rounded-full bg-[var(--accent-purple)]/10 flex items-center justify-center\">\n                  <div className=\"w-5 h-5 border-2 border-[var(--accent-purple)] border-t-transparent rounded-full animate-spin\" />\n                </div>\n                <div>\n                  <h3 className=\"font-medium text-[var(--text-heading)]\">Comprehensive Analysis Running</h3>\n                  <p className=\"text-sm text-[var(--text-muted)]\">\n                    {activeRun.overallProgress}% complete • Phase {activeRun.currentPhase || 1} of 3\n                  </p>\n                </div>\n              </div>\n              <div className=\"flex items-center gap-3\">\n                <Link\n                  href={`/analysis/${estatePlanId}/prepare?runId=${activeRun.runId}`}\n                  className=\"px-4 py-2 bg-[var(--accent-purple)] text-white text-sm font-medium rounded-lg hover:bg-[var(--accent-hover)] transition-colors\"\n                >\n                  View Preparation Tasks\n                </Link>\n              </div>\n            </div>\n            <div className=\"mt-4 h-2 bg-[var(--border)] rounded-full overflow-hidden\">\n              <div\n                className=\"h-full bg-[var(--accent-purple)] transition-all duration-500\"\n                style={{ width: `${activeRun.overallProgress}%` }}\n              />\n            </div>\n          </div>\n        )}\n\n        {/* Run Analysis State */}\n        {!latestAnalysis && !isRunning && !activeRun && (\n          <div className=\"mb-8 bg-white rounded-xl shadow-lg p-8 text-center\">\n            <div className=\"w-20 h-20 bg-gradient-to-br from-[var(--accent-muted)] to-[var(--accent-purple)]/20 rounded-full flex items-center justify-center mx-auto mb-6\">\n              <svg className=\"w-10 h-10 text-[var(--accent-purple)]\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4\" />\n              </svg>\n            </div>\n            <h2 className=\"text-2xl font-bold text-[var(--text-heading)] mb-3\">\n              Ready to Analyze Your Estate Plan\n            </h2>\n            <p className=\"text-[var(--text-body)] mb-6 max-w-lg mx-auto\">\n              Our AI will review your intake data and identify gaps, outdated documents, and provide personalized recommendations based on your state&apos;s laws.\n            </p>\n\n            {/* Mode Selection */}\n            <div className=\"mb-6\">\n              <p className=\"text-sm text-[var(--text-muted)] mb-3\">Choose analysis depth:</p>\n              <div className=\"flex justify-center gap-3\">\n                <button\n                  onClick={() => setAnalysisMode(\"quick\")}\n                  className={`px-4 py-2 rounded-lg border-2 transition-all ${\n                    analysisMode === \"quick\"\n                      ? \"border-[var(--accent-purple)] bg-[var(--accent-muted)] text-[var(--accent-purple)]\"\n                      : \"border-gray-200 hover:border-gray-300\"\n                  }`}\n                >\n                  <div className=\"font-medium\">Quick Analysis</div>\n                  <div className=\"text-xs text-[var(--text-muted)]\">~1-2 min</div>\n                </button>\n                <button\n                  onClick={() => setAnalysisMode(\"comprehensive\")}\n                  className={`px-4 py-2 rounded-lg border-2 transition-all ${\n                    analysisMode === \"comprehensive\"\n                      ? \"border-[var(--accent-purple)] bg-[var(--accent-muted)] text-[var(--accent-purple)]\"\n                      : \"border-gray-200 hover:border-gray-300\"\n                  }`}\n                >\n                  <div className=\"font-medium\">Comprehensive</div>\n                  <div className=\"text-xs text-[var(--text-muted)]\">~15-20 min (detailed)</div>\n                </button>\n              </div>\n            </div>\n\n            <Button onClick={() => handleRunAnalysis(analysisMode)} size=\"lg\">\n              Run {analysisMode === \"quick\" ? \"Quick\" : \"Comprehensive\"} Analysis\n            </Button>\n          </div>\n        )}\n\n        {/* Running State */}\n        {isRunning && !comprehensiveRunId && (\n          <div className=\"mb-8 bg-white rounded-xl shadow-lg p-8\">\n            <div className=\"text-center mb-6\">\n              <div className=\"relative w-16 h-16 mx-auto mb-4\">\n                <div className=\"absolute inset-0 rounded-full border-4 border-[var(--accent-muted)]\"></div>\n                <div className=\"absolute inset-0 rounded-full border-4 border-[var(--accent-purple)] border-t-transparent animate-spin\"></div>\n              </div>\n              <h2 className=\"text-xl font-bold text-[var(--text-heading)] mb-2\">\n                Analyzing Your Estate Plan...\n              </h2>\n              <p className=\"text-[var(--accent-purple)] font-medium\">\n                {progressStep}\n              </p>\n            </div>\n\n            {/* Progress Log - Terminal-like output */}\n            <div className=\"bg-gray-900 rounded-lg p-4 max-h-64 overflow-y-auto font-mono text-sm\">\n              <div className=\"text-gray-400 mb-2\">$ claude-code --analyze estate-plan</div>\n              {progressLog.map((log, idx) => (\n                <div key={idx} className=\"text-green-400 flex items-center gap-2\">\n                  <span className=\"text-gray-500\">[{String(idx + 1).padStart(2, \"0\")}]</span>\n                  <span>✓ {log}</span>\n                </div>\n              ))}\n              {progressStep && (\n                <div className=\"text-yellow-400 flex items-center gap-2 animate-pulse\">\n                  <span className=\"text-gray-500\">[{String(progressLog.length + 1).padStart(2, \"0\")}]</span>\n                  <span>▶ {progressStep}</span>\n                </div>\n              )}\n            </div>\n\n            <p className=\"text-center text-[var(--text-muted)] text-sm mt-4\">\n              {analysisMode === \"comprehensive\"\n                ? \"Setting up your analysis... You'll be redirected to preparation tasks shortly.\"\n                : \"Quick analysis typically completes in 1-2 minutes.\"}\n            </p>\n          </div>\n        )}\n\n        {/* Comprehensive Analysis Progress */}\n        {comprehensiveRunId && (\n          <div className=\"mb-8\">\n            <GapAnalysisProgress\n              runId={comprehensiveRunId}\n              onComplete={() => {\n                setComprehensiveRunId(null);\n                setIsRunning(false);\n              }}\n            />\n          </div>\n        )}\n\n        {/* Error State */}\n        {error && (\n          <div className=\"mb-6 bg-[var(--error-muted)] border border-[var(--error)] rounded-lg p-4\">\n            <div className=\"flex gap-3\">\n              <svg className=\"w-5 h-5 text-red-600 flex-shrink-0\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\" />\n              </svg>\n              <div>\n                <h3 className=\"font-medium text-[var(--error)]\">Analysis Failed</h3>\n                <p className=\"text-sm text-[var(--error)] mt-1\">{error}</p>\n                <button\n                  onClick={() => handleRunAnalysis(analysisMode)}\n                  className=\"mt-2 text-sm font-medium text-[var(--error)] hover:underline\"\n                >\n                  Try Again\n                </button>\n              </div>\n            </div>\n          </div>\n        )}\n\n        {/* Analysis Results */}\n        {latestAnalysis && !isRunning && (\n          <div className=\"space-y-6\">\n            {/* Hero Section - Score Display */}\n            <div className=\"bg-white rounded-xl shadow-lg overflow-hidden\">\n              {/* Score Hero */}\n              <div className=\"bg-gradient-to-br from-[var(--off-white)] to-[var(--light-gray)]/50 px-6 py-10 text-center\">\n                <h1 className=\"text-lg font-medium text-[var(--text-body)] mb-6\">\n                  {estatePlan.name || \"Your Estate Plan\"} Analysis\n                </h1>\n\n                {/* Large Score Ring */}\n                <div className=\"mb-6\">\n                  <ScoreRing score={latestAnalysis.score || 0} size=\"lg\" />\n                </div>\n\n                {/* Score Interpretation */}\n                {scoreInfo && (\n                  <div className=\"mb-6\">\n                    <h2 className={`text-3xl font-bold ${scoreInfo.color} mb-2`}>\n                      {scoreInfo.label}\n                    </h2>\n                    <p className=\"text-[var(--text-body)] max-w-md mx-auto\">\n                      {scoreInfo.description}\n                    </p>\n                  </div>\n                )}\n\n                {/* Score Breakdown */}\n                {scoreBreakdown && scoreBreakdown.deductions && scoreBreakdown.deductions.length > 0 && (\n                  <div className=\"mb-8 max-w-lg mx-auto\">\n                    <button\n                      onClick={() => {\n                        const el = document.getElementById(\"score-breakdown\");\n                        el?.classList.toggle(\"hidden\");\n                      }}\n                      className=\"text-sm text-[var(--accent-purple)] hover:underline flex items-center gap-1 mx-auto mb-3\"\n                    >\n                      <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\" />\n                      </svg>\n                      Why this score?\n                    </button>\n                    <div id=\"score-breakdown\" className=\"hidden bg-white/80 rounded-lg p-4 text-left border border-[var(--border)]\">\n                      <p className=\"text-sm text-[var(--text-muted)] mb-3\">\n                        Starting from 100 points, the following deductions were made:\n                      </p>\n                      <div className=\"space-y-2\">\n                        {scoreBreakdown.deductions.map((d, idx) => (\n                          <div key={idx} className=\"flex justify-between items-center text-sm\">\n                            <span className=\"text-[var(--text-body)]\">{d.reason}</span>\n                            <span className=\"text-red-600 font-medium\">-{d.points}</span>\n                          </div>\n                        ))}\n                        <div className=\"border-t border-[var(--border)] pt-2 mt-2 flex justify-between items-center font-medium\">\n                          <span>Final Score</span>\n                          <span className={scoreInfo?.color || \"\"}>{scoreBreakdown.finalScore}</span>\n                        </div>\n                      </div>\n                      {scoreBreakdown.summary && (\n                        <p className=\"text-xs text-[var(--text-muted)] mt-3 italic\">\n                          {scoreBreakdown.summary}\n                        </p>\n                      )}\n                    </div>\n                  </div>\n                )}\n\n                {/* Quick Stats Row */}\n                <div className=\"flex flex-wrap justify-center gap-6 md:gap-10\">\n                  <StatCard\n                    label=\"Missing Documents\"\n                    value={missingDocs.length}\n                    color={missingDocs.length > 0 ? \"red\" : \"green\"}\n                    icon={\n                      <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\" />\n                      </svg>\n                    }\n                  />\n                  <StatCard\n                    label=\"Issues Found\"\n                    value={issuesCount}\n                    color={issuesCount > 0 ? \"yellow\" : \"green\"}\n                    icon={\n                      <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\" />\n                      </svg>\n                    }\n                  />\n                  <StatCard\n                    label=\"Recommendations\"\n                    value={recommendations.length}\n                    color=\"blue\"\n                    icon={\n                      <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z\" />\n                      </svg>\n                    }\n                  />\n                </div>\n\n                {/* Action Buttons */}\n                <div className=\"mt-8 flex flex-wrap justify-center gap-4\">\n                  <Link\n                    href={`/analysis/${estatePlanId}/visualization`}\n                    className=\"inline-flex items-center gap-2 px-6 py-3 bg-[#FF7759] hover:bg-[#E85A3C] text-white font-medium rounded-full shadow-md hover:shadow-lg transition-all\"\n                  >\n                    <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M11 3.055A9.001 9.001 0 1020.945 13H11V3.055z\" />\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M20.488 9H15V3.512A9.025 9.025 0 0120.488 9z\" />\n                    </svg>\n                    View Estate Distribution\n                  </Link>\n                  <Link\n                    href={`/analysis/${estatePlanId}/reminders`}\n                    className=\"inline-flex items-center gap-2 px-6 py-3 bg-[#1D1D1B] hover:bg-[#2D2D2B] text-white font-medium rounded-full shadow-md hover:shadow-lg transition-all\"\n                  >\n                    <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9\" />\n                    </svg>\n                    Reminders & Life Events\n                  </Link>\n                </div>\n\n                {/* Preparation Tasks Links */}\n                <div className=\"mt-6 pt-6 border-t border-[var(--border)]\">\n                  <p className=\"text-sm text-[var(--text-muted)] text-center mb-3\">Prepare for Your Attorney Consultation</p>\n                  <div className=\"flex flex-wrap justify-center gap-3\">\n                    <Link\n                      href={`/analysis/${estatePlanId}/prepare/documents`}\n                      className=\"inline-flex items-center gap-1.5 px-4 py-2 text-sm text-[var(--text-body)] hover:text-[var(--accent-purple)] border border-[var(--border)] rounded-lg hover:border-[var(--accent-purple)] transition-colors\"\n                    >\n                      <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={1.5} d=\"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\" />\n                      </svg>\n                      Gather Documents\n                    </Link>\n                    <Link\n                      href={`/analysis/${estatePlanId}/prepare/contacts`}\n                      className=\"inline-flex items-center gap-1.5 px-4 py-2 text-sm text-[var(--text-body)] hover:text-[var(--accent-purple)] border border-[var(--border)] rounded-lg hover:border-[var(--accent-purple)] transition-colors\"\n                    >\n                      <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={1.5} d=\"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0z\" />\n                      </svg>\n                      Add Contacts\n                    </Link>\n                    <Link\n                      href={`/analysis/${estatePlanId}/prepare/questions`}\n                      className=\"inline-flex items-center gap-1.5 px-4 py-2 text-sm text-[var(--text-body)] hover:text-[var(--accent-purple)] border border-[var(--border)] rounded-lg hover:border-[var(--accent-purple)] transition-colors\"\n                    >\n                      <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={1.5} d=\"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\" />\n                      </svg>\n                      Attorney Questions\n                    </Link>\n                  </div>\n                </div>\n              </div>\n\n              {/* Metadata bar */}\n              <div className=\"px-6 py-3 bg-white/50 border-t border-[var(--border)] flex flex-wrap justify-between items-center gap-2 text-sm print:hidden\">\n                <span className=\"text-[var(--text-muted)]\">\n                  Analysis from {new Date(latestAnalysis.createdAt).toLocaleString()}\n                </span>\n                <div className=\"flex items-center gap-2\">\n                  <button\n                    onClick={() => handleRunAnalysis(\"quick\")}\n                    disabled={isRunning}\n                    className=\"text-[var(--accent-purple)] hover:opacity-80 font-medium inline-flex items-center gap-1 text-sm\"\n                  >\n                    <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15\" />\n                    </svg>\n                    Quick Re-run\n                  </button>\n                  <span className=\"text-gray-300\">|</span>\n                  <button\n                    onClick={() => handleRunAnalysis(\"comprehensive\")}\n                    disabled={isRunning}\n                    className=\"text-[var(--text-muted)] hover:text-[var(--accent-purple)] font-medium text-sm\"\n                  >\n                    Comprehensive\n                  </button>\n                </div>\n              </div>\n            </div>\n\n            {/* Tab Navigation */}\n            <div className=\"bg-white rounded-xl shadow-lg overflow-hidden print:shadow-none\">\n              <Tabs\n                tabs={tabs}\n                activeTab={activeTab}\n                onChange={setActiveTab}\n                variant=\"underline\"\n                fullWidth\n                className=\"print:hidden\"\n              >\n                {/* Overview Tab */}\n                <TabPanel tabId=\"overview\">\n                  <div className=\"p-6 space-y-6\">\n                    {/* Summary Cards */}\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                      {/* Priority Actions Card */}\n                      <div className=\"bg-white/50 rounded-lg p-4\">\n                        <h3 className=\"font-semibold text-[var(--text-heading)] mb-3 flex items-center gap-2\">\n                          <svg className=\"w-5 h-5 text-red-500\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\" />\n                          </svg>\n                          Priority Actions\n                        </h3>\n                        {missingDocs.filter((d) => d.priority === \"high\").length > 0 ||\n                        recommendations.filter((r) => r.priority === \"high\").length > 0 ? (\n                          <ul className=\"space-y-2\">\n                            {missingDocs\n                              .filter((d) => d.priority === \"high\")\n                              .slice(0, 3)\n                              .map((doc, idx) => (\n                                <li key={`doc-${idx}`} className=\"flex items-start gap-2 text-sm\">\n                                  <Badge variant=\"error\" size=\"sm\">Missing</Badge>\n                                  <span className=\"text-[var(--text-body)]\">\n                                    {DOCUMENT_TYPE_NAMES[doc.document || doc.type || \"\"] || doc.document || doc.type || \"Document\"}\n                                  </span>\n                                </li>\n                              ))}\n                            {recommendations\n                              .filter((r) => r.priority === \"high\" || r.priority === \"critical\")\n                              .slice(0, 2)\n                              .map((rec, idx) => (\n                                <li key={`rec-${idx}`} className=\"flex items-start gap-2 text-sm\">\n                                  <Badge variant=\"warning\" size=\"sm\">Action</Badge>\n                                  <span className=\"text-[var(--text-body)]\">{rec.action}</span>\n                                </li>\n                              ))}\n                          </ul>\n                        ) : (\n                          <p className=\"text-sm text-[var(--text-muted)]\">\n                            No high-priority actions needed.\n                          </p>\n                        )}\n                      </div>\n\n                      {/* Documents Status Card */}\n                      <div className=\"bg-white/50 rounded-lg p-4\">\n                        <h3 className=\"font-semibold text-[var(--text-heading)] mb-3 flex items-center gap-2\">\n                          <svg className=\"w-5 h-5 text-blue-500\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\" />\n                          </svg>\n                          Document Status\n                        </h3>\n                        <div className=\"space-y-2\">\n                          <div className=\"flex justify-between text-sm\">\n                            <span className=\"text-[var(--text-body)]\">Missing</span>\n                            <span className=\"font-medium text-red-600\">{missingDocs.length}</span>\n                          </div>\n                          <div className=\"flex justify-between text-sm\">\n                            <span className=\"text-[var(--text-body)]\">Outdated</span>\n                            <span className=\"font-medium text-yellow-600\">{outdatedDocs.length}</span>\n                          </div>\n                          <div className=\"flex justify-between text-sm\">\n                            <span className=\"text-[var(--text-body)]\">Inconsistencies</span>\n                            <span className=\"font-medium text-orange-600\">{inconsistencies.length}</span>\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n\n                    {/* Quick Actions */}\n                    <div className=\"flex flex-col sm:flex-row gap-4 pt-4\">\n                      <Link\n                        href={`/documents/generate/${estatePlanId}`}\n                        className=\"flex-1\"\n                      >\n                        <Button variant=\"primary\" fullWidth>\n                          Generate Documents\n                        </Button>\n                      </Link>\n                      <Link\n                        href={`/documents/upload/${estatePlanId}`}\n                        className=\"flex-1\"\n                      >\n                        <Button variant=\"secondary\" fullWidth>\n                          Upload & Analyze\n                        </Button>\n                      </Link>\n                      <Link href={`/intake?planId=${estatePlanId}`} className=\"flex-1\">\n                        <Button variant=\"outline\" fullWidth>\n                          Update Information\n                        </Button>\n                      </Link>\n                    </div>\n                  </div>\n                </TabPanel>\n\n                {/* Missing Documents Tab */}\n                <TabPanel tabId=\"missing\">\n                  <div className=\"p-6\">\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                      {missingDocs.map((doc, idx) => {\n                        const docName = doc.document || doc.type || \"Unknown Document\";\n                        const docType = doc.type || doc.document?.toLowerCase().replace(/\\s+/g, \"_\") || \"\";\n                        const priority = doc.priority || \"medium\";\n                        const priorityVariant = priority === \"critical\" || priority === \"high\" ? \"error\" : priority === \"medium\" ? \"warning\" : \"success\";\n                        return (\n                          <div\n                            key={idx}\n                            className=\"bg-[var(--error-muted)] border border-[var(--error)] rounded-lg p-4\"\n                          >\n                            <div className=\"flex items-start justify-between mb-2\">\n                              <h4 className=\"font-semibold text-[var(--text-heading)]\">\n                                {DOCUMENT_TYPE_NAMES[docType] || docName}\n                              </h4>\n                              <Badge variant={priorityVariant} size=\"sm\">\n                                {priority}\n                              </Badge>\n                            </div>\n                            <p className=\"text-sm text-[var(--text-body)] mb-2\">\n                              {doc.reason || \"This document is recommended for your estate plan.\"}\n                            </p>\n                            {doc.consequences && (\n                              <p className=\"text-sm text-[var(--error)] mb-2\">\n                                <strong>Without it:</strong> {Array.isArray(doc.consequences) ? doc.consequences.join(\". \") : doc.consequences}\n                              </p>\n                            )}\n                            {doc.estimatedCostToCreate && (\n                              <p className=\"text-xs text-[var(--text-muted)] mb-4\">\n                                Est. cost: ${doc.estimatedCostToCreate.low.toLocaleString()} - ${doc.estimatedCostToCreate.high.toLocaleString()}\n                              </p>\n                            )}\n                            <Link\n                              href={`/documents/generate/${estatePlanId}?type=${docType}`}\n                              className=\"inline-flex items-center gap-1 text-sm font-medium text-[var(--accent-purple)] hover:opacity-80\"\n                            >\n                              Generate Document →\n                            </Link>\n                          </div>\n                        );\n                      })}\n                    </div>\n                  </div>\n                </TabPanel>\n\n                {/* Issues Tab */}\n                <TabPanel tabId=\"issues\">\n                  <div className=\"p-6 space-y-6\">\n                    {/* Outdated Documents */}\n                    {outdatedDocs.length > 0 && (\n                      <div>\n                        <h3 className=\"text-lg font-semibold text-[var(--text-heading)] mb-4 flex items-center gap-2\">\n                          <svg className=\"w-5 h-5 text-yellow-500\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z\" />\n                          </svg>\n                          Outdated Documents ({outdatedDocs.length})\n                        </h3>\n                        <div className=\"space-y-3\">\n                          {outdatedDocs.map((doc, idx) => {\n                            const docName = doc.document || doc.type || \"Document\";\n                            const description = [\n                              doc.issue,\n                              doc.risk && `Risk: ${doc.risk}`,\n                              doc.recommendation\n                            ].filter(Boolean).join(\". \");\n                            return (\n                              <GapAnalysisCard\n                                key={idx}\n                                type=\"outdated\"\n                                title={DOCUMENT_TYPE_NAMES[docName] || docName}\n                                description={description || \"This document may need review.\"}\n                              />\n                            );\n                          })}\n                        </div>\n                      </div>\n                    )}\n\n                    {/* Inconsistencies */}\n                    {inconsistencies.length > 0 && (\n                      <div>\n                        <h3 className=\"text-lg font-semibold text-[var(--text-heading)] mb-4 flex items-center gap-2\">\n                          <svg className=\"w-5 h-5 text-orange-500\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\" />\n                          </svg>\n                          Inconsistencies ({inconsistencies.length})\n                        </h3>\n                        <div className=\"space-y-3\">\n                          {inconsistencies.map((item, idx) => {\n                            const title = item.issue || item.type || \"Inconsistency Found\";\n                            const description = [\n                              item.details || item.potentialConsequence,\n                              (item.resolution || item.recommendation) && `Resolution: ${item.resolution || item.recommendation}`\n                            ].filter(Boolean).join(\". \");\n                            // Map \"critical\" to \"high\" for component compatibility\n                            const mappedPriority = item.severity === \"critical\" ? \"high\" : item.severity;\n                            return (\n                              <GapAnalysisCard\n                                key={idx}\n                                type=\"inconsistency\"\n                                title={title}\n                                description={description || \"Please review this inconsistency.\"}\n                                priority={mappedPriority}\n                              />\n                            );\n                          })}\n                        </div>\n                      </div>\n                    )}\n                  </div>\n                </TabPanel>\n\n                {/* Recommendations Tab */}\n                <TabPanel tabId=\"recommendations\">\n                  <div className=\"p-6\">\n                    <div className=\"space-y-4\">\n                      {recommendations.map((rec, idx) => {\n                        const title = rec.action || \"Recommendation\";\n                        const priority = rec.priority || \"medium\";\n                        // Handle estimatedBenefit which might be an object {low, high}\n                        const benefitValue = rec.estimatedBenefit;\n                        const benefitText = typeof benefitValue === 'object' && benefitValue !== null && 'low' in benefitValue && 'high' in benefitValue\n                          ? `Estimated benefit: $${(benefitValue as {low: number; high: number}).low.toLocaleString()} - $${(benefitValue as {low: number; high: number}).high.toLocaleString()}`\n                          : benefitValue;\n                        const description = rec.reason || rec.riskOfDelay || benefitText || \"\";\n                        return (\n                          <div\n                            key={idx}\n                            className=\"bg-white border border-[var(--border)] rounded-lg p-4\"\n                          >\n                            <div className=\"flex items-start justify-between mb-2\">\n                              <div className=\"flex items-center gap-2\">\n                                {rec.rank && (\n                                  <span className=\"flex items-center justify-center w-6 h-6 rounded-full bg-[var(--accent-muted)] text-[var(--accent-purple)] text-xs font-bold\">\n                                    {rec.rank}\n                                  </span>\n                                )}\n                                <h4 className=\"font-semibold text-[var(--text-heading)]\">{title}</h4>\n                              </div>\n                              <div className=\"flex items-center gap-2\">\n                                {rec.timeline && (\n                                  <Badge variant=\"default\" size=\"sm\">{rec.timeline}</Badge>\n                                )}\n                                <Badge\n                                  variant={priority === \"critical\" || priority === \"high\" ? \"error\" : priority === \"medium\" ? \"warning\" : \"success\"}\n                                  size=\"sm\"\n                                >\n                                  {priority}\n                                </Badge>\n                              </div>\n                            </div>\n                            {description && (\n                              <p className=\"text-sm text-[var(--text-body)] mb-3\">{description}</p>\n                            )}\n                            {rec.detailedSteps && rec.detailedSteps.length > 0 && (\n                              <div className=\"mt-3 pt-3 border-t border-[var(--border)]\">\n                                <p className=\"text-xs font-medium text-[var(--text-muted)] mb-2\">Steps:</p>\n                                <ul className=\"text-sm text-[var(--text-body)] space-y-1\">\n                                  {rec.detailedSteps.slice(0, 3).map((step, i) => (\n                                    <li key={i} className=\"flex items-start gap-2\">\n                                      <span className=\"text-gray-400\">•</span>\n                                      <span>{step}</span>\n                                    </li>\n                                  ))}\n                                  {rec.detailedSteps.length > 3 && (\n                                    <li className=\"text-gray-400 text-xs\">+ {rec.detailedSteps.length - 3} more steps...</li>\n                                  )}\n                                </ul>\n                              </div>\n                            )}\n                            {rec.estimatedCost && (\n                              <p className=\"text-xs text-[var(--text-muted)] mt-2\">\n                                Est. cost: ${rec.estimatedCost.low?.toLocaleString()} - ${rec.estimatedCost.high?.toLocaleString()}\n                              </p>\n                            )}\n                          </div>\n                        );\n                      })}\n                    </div>\n                  </div>\n                </TabPanel>\n\n                {/* State Notes Tab */}\n                <TabPanel tabId=\"state\">\n                  <div className=\"p-6\">\n                    <div className=\"space-y-4\">\n                      {stateNotes.map((note, idx) => {\n                        const title = note.topic || note.note || \"State Consideration\";\n                        const description = [\n                          note.rule,\n                          note.impact,\n                          note.action && `Action: ${note.action}`,\n                          note.relevance\n                        ].filter(Boolean).join(\". \");\n                        return (\n                          <div\n                            key={idx}\n                            className=\"bg-[var(--info-muted)] border border-[var(--info)] rounded-lg p-4\"\n                          >\n                            <h4 className=\"font-semibold text-[var(--text-heading)] mb-2\">{title}</h4>\n                            {description && (\n                              <p className=\"text-sm text-[var(--text-body)] mb-2\">{description}</p>\n                            )}\n                            {note.citation && (\n                              <p className=\"text-xs text-[var(--accent-purple)] font-mono\">\n                                {note.citation}\n                              </p>\n                            )}\n                          </div>\n                        );\n                      })}\n                      {stateNotes.length === 0 && (\n                        <p className=\"text-[var(--text-muted)] text-center py-8\">\n                          No state-specific considerations found. This may be due to limited state information provided.\n                        </p>\n                      )}\n                    </div>\n                  </div>\n                </TabPanel>\n              </Tabs>\n\n              {/* Print-only content */}\n              <div className=\"hidden print:block p-6 space-y-8\">\n                <PrintSection title=\"Missing Documents\" items={missingDocs} type=\"missing\" />\n                <PrintSection title=\"Outdated Documents\" items={outdatedDocs} type=\"outdated\" />\n                <PrintSection title=\"Inconsistencies\" items={inconsistencies} type=\"inconsistency\" />\n                <PrintSection title=\"Recommendations\" items={recommendations} type=\"recommendation\" />\n                <PrintSection title=\"State-Specific Notes\" items={stateNotes} type=\"note\" />\n              </div>\n            </div>\n\n            {/* Disclaimer */}\n            <div className=\"bg-[var(--warning-muted)] border border-[var(--warning)] rounded-lg p-4\">\n              <p className=\"text-sm text-[var(--warning)]\">\n                <strong>Disclaimer:</strong> This analysis is for informational purposes only and does not constitute legal advice.\n                Please consult with a licensed attorney in your state to review your specific situation and any documents before signing.\n              </p>\n            </div>\n          </div>\n        )}\n      </main>\n    </div>\n  );\n}\n\n// Stat Card component\ninterface StatCardProps {\n  label: string;\n  value: number;\n  color: \"red\" | \"yellow\" | \"green\" | \"blue\";\n  icon: React.ReactNode;\n}\n\nfunction StatCard({ label, value, color, icon }: StatCardProps) {\n  const colorClasses = {\n    red: \"text-[var(--error)] bg-[var(--error-muted)]\",\n    yellow: \"text-[var(--warning)] bg-[var(--warning-muted)]\",\n    green: \"text-[var(--success)] bg-[var(--success-muted)]\",\n    blue: \"text-[var(--accent-purple)] bg-[var(--accent-muted)]\",\n  };\n\n  return (\n    <div className=\"text-center\">\n      <div\n        className={`w-12 h-12 rounded-full ${colorClasses[color]} flex items-center justify-center mx-auto mb-2`}\n      >\n        {icon}\n      </div>\n      <div className=\"text-3xl font-bold text-[var(--text-heading)]\">{value}</div>\n      <div className=\"text-sm text-[var(--text-muted)]\">{label}</div>\n    </div>\n  );\n}\n\n// Print section component\ninterface PrintSectionProps {\n  title: string;\n  items: Array<{\n    type?: string;\n    priority?: string;\n    reason?: string;\n    issue?: string;\n    details?: string;\n    recommendation?: string;\n    action?: string;\n    note?: string;\n    relevance?: string;\n  }>;\n  type: \"missing\" | \"outdated\" | \"inconsistency\" | \"recommendation\" | \"note\";\n}\n\nfunction PrintSection({ title, items, type }: PrintSectionProps) {\n  if (items.length === 0) return null;\n\n  return (\n    <div className=\"break-inside-avoid\">\n      <h3 className=\"text-lg font-semibold text-gray-900 mb-3 border-b pb-2\">{title}</h3>\n      <ul className=\"space-y-2\">\n        {items.map((item, idx) => (\n          <li key={idx} className=\"text-sm\">\n            {type === \"missing\" && (() => {\n              const doc = item as MissingDocument;\n              const docName = doc.document || doc.type || \"Document\";\n              return (\n                <>\n                  <strong>{DOCUMENT_TYPE_NAMES[docName] || docName}</strong>\n                  {\" - \"}\n                  {doc.reason || (Array.isArray(doc.consequences) ? doc.consequences.join(\". \") : doc.consequences) || \"Recommended for your estate plan\"}\n                </>\n              );\n            })()}\n            {type === \"outdated\" && (() => {\n              const doc = item as OutdatedDocument;\n              const docName = doc.document || doc.type || \"Document\";\n              return (\n                <>\n                  <strong>{DOCUMENT_TYPE_NAMES[docName] || docName}</strong>\n                  {\" - \"}\n                  {doc.issue}. {doc.recommendation}\n                </>\n              );\n            })()}\n            {type === \"inconsistency\" && (() => {\n              const inc = item as Inconsistency;\n              return (\n                <>\n                  <strong>{inc.issue || inc.type || \"Inconsistency\"}</strong>\n                  {\" - \"}\n                  {inc.details || inc.potentialConsequence || \"\"}. {inc.recommendation || inc.resolution || \"\"}\n                </>\n              );\n            })()}\n            {type === \"recommendation\" && (() => {\n              const rec = item as Recommendation;\n              // Handle estimatedBenefit which might be an object {low, high} instead of string\n              const benefit = rec.estimatedBenefit;\n              const benefitText = typeof benefit === 'object' && benefit !== null && 'low' in benefit && 'high' in benefit\n                ? `$${(benefit as {low: number; high: number}).low.toLocaleString()} - $${(benefit as {low: number; high: number}).high.toLocaleString()}`\n                : benefit;\n              return (\n                <>\n                  <strong>{rec.action || \"Recommendation\"}</strong>\n                  {\" - \"}\n                  {rec.reason || rec.riskOfDelay || benefitText || \"\"}\n                </>\n              );\n            })()}\n            {type === \"note\" && (() => {\n              const note = item as StateNote;\n              return (\n                <>\n                  <strong>{note.topic || note.note || \"State Consideration\"}</strong>\n                  {\" - \"}\n                  {note.rule || note.impact || note.relevance || \"\"}\n                </>\n              );\n            })()}\n          </li>\n        ))}\n      </ul>\n    </div>\n  );\n}\n","\"use client\";\n\nimport { ReactNode, useState } from \"react\";\n\ntype Priority = \"high\" | \"medium\" | \"low\";\ntype Severity = \"critical\" | \"high\" | \"medium\" | \"low\";\n\ninterface GapAnalysisCardProps {\n  type: \"missing\" | \"outdated\" | \"inconsistency\" | \"recommendation\" | \"note\" | \"common_issue\";\n  title: string;\n  description: string;\n  priority?: Priority;\n  action?: ReactNode;\n  documentType?: string;\n  issueType?: string;\n  severity?: Severity;\n  affectedAssets?: string[];\n  recommendation?: string;\n  showResolutionSteps?: boolean;\n}\n\nconst TYPE_CONFIG = {\n  missing: {\n    icon: (\n      <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z\" />\n      </svg>\n    ),\n    bgColor: \"bg-red-50 dark:bg-red-900/20\",\n    borderColor: \"border-red-200 dark:border-red-800\",\n    iconColor: \"text-red-500\",\n    titleColor: \"text-red-800 dark:text-red-300\",\n  },\n  outdated: {\n    icon: (\n      <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z\" />\n      </svg>\n    ),\n    bgColor: \"bg-yellow-50 dark:bg-yellow-900/20\",\n    borderColor: \"border-yellow-200 dark:border-yellow-800\",\n    iconColor: \"text-yellow-500\",\n    titleColor: \"text-yellow-800 dark:text-yellow-300\",\n  },\n  inconsistency: {\n    icon: (\n      <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\" />\n      </svg>\n    ),\n    bgColor: \"bg-orange-50 dark:bg-orange-900/20\",\n    borderColor: \"border-orange-200 dark:border-orange-800\",\n    iconColor: \"text-orange-500\",\n    titleColor: \"text-orange-800 dark:text-orange-300\",\n  },\n  recommendation: {\n    icon: (\n      <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z\" />\n      </svg>\n    ),\n    bgColor: \"bg-blue-50 dark:bg-blue-900/20\",\n    borderColor: \"border-blue-200 dark:border-blue-800\",\n    iconColor: \"text-blue-500\",\n    titleColor: \"text-blue-800 dark:text-blue-300\",\n  },\n  note: {\n    icon: (\n      <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\" />\n      </svg>\n    ),\n    bgColor: \"bg-gray-50 dark:bg-gray-700\",\n    borderColor: \"border-gray-200 dark:border-gray-600\",\n    iconColor: \"text-gray-500\",\n    titleColor: \"text-gray-800 dark:text-gray-200\",\n  },\n  common_issue: {\n    icon: (\n      <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z\" />\n      </svg>\n    ),\n    bgColor: \"bg-purple-50 dark:bg-purple-900/20\",\n    borderColor: \"border-purple-200 dark:border-purple-800\",\n    iconColor: \"text-purple-500\",\n    titleColor: \"text-purple-800 dark:text-purple-300\",\n  },\n};\n\nconst PRIORITY_BADGE = {\n  high: \"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300\",\n  medium: \"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-300\",\n  low: \"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300\",\n};\n\nconst SEVERITY_BADGE = {\n  critical: \"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300\",\n  high: \"bg-orange-100 text-orange-800 dark:bg-orange-900/30 dark:text-orange-300\",\n  medium: \"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-300\",\n  low: \"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300\",\n};\n\n// Document type display names\nexport const DOCUMENT_TYPE_NAMES: Record<string, string> = {\n  will: \"Last Will & Testament\",\n  trust: \"Revocable Living Trust\",\n  poa_financial: \"Financial Power of Attorney\",\n  poa_healthcare: \"Healthcare Power of Attorney\",\n  healthcare_directive: \"Healthcare Directive / Living Will\",\n  hipaa: \"HIPAA Authorization\",\n  credit_shelter_trust: \"Credit Shelter Trust\",\n  ilit: \"Irrevocable Life Insurance Trust\",\n  homestead_declaration: \"Homestead Declaration\",\n  other: \"Other Document\",\n};\n\n// ============================================\n// PLAIN-LANGUAGE EXPLANATIONS\n// ============================================\n\n/**\n * Get a plain-language explanation of what a document does and why it matters\n */\nexport function getDocumentExplanation(documentType: string): {\n  whatItIs: string;\n  whyYouNeedIt: string;\n  whatHappensWithout: string;\n} {\n  const explanations: Record<string, { whatItIs: string; whyYouNeedIt: string; whatHappensWithout: string }> = {\n    will: {\n      whatItIs: \"A Last Will & Testament is a legal document that spells out your wishes for how your belongings (property, money, possessions) should be distributed after you pass away. It also lets you name a guardian for any minor children.\",\n      whyYouNeedIt: \"Without a will, you have no say in who gets your assets or who raises your children. A will gives you control and makes things much easier for your loved ones during a difficult time.\",\n      whatHappensWithout: \"Your state's laws will decide who inherits your assets (called 'intestate succession'). This may not match your wishes. For example, your assets might go to distant relatives instead of close friends, or be split in ways you wouldn't want.\",\n    },\n    trust: {\n      whatItIs: \"A Revocable Living Trust is like a container that holds your assets during your lifetime. You control everything while you're alive, but when you pass away, your chosen trustee distributes assets according to your instructions - without going through probate court.\",\n      whyYouNeedIt: \"A trust helps your family avoid the lengthy and expensive probate process. It also keeps your affairs private (wills become public record) and can help if you become incapacitated.\",\n      whatHappensWithout: \"Your assets may need to go through probate, which can take months or years, cost thousands in legal fees, and become part of the public record. Your family may face delays in accessing funds they need.\",\n    },\n    poa_financial: {\n      whatItIs: \"A Financial Power of Attorney lets you name someone you trust (called your 'agent') to handle your financial matters if you can't do it yourself - like paying bills, managing investments, or selling property.\",\n      whyYouNeedIt: \"If you're in an accident, have a medical emergency, or develop dementia, someone needs to be able to pay your bills and manage your finances. Without this document, your family may need to go to court to get that authority.\",\n      whatHappensWithout: \"Your family may need to petition a court to become your conservator - a process that's expensive, time-consuming, and emotionally draining. Meanwhile, bills go unpaid and financial matters pile up.\",\n    },\n    poa_healthcare: {\n      whatItIs: \"A Healthcare Power of Attorney (also called a Healthcare Proxy) names someone to make medical decisions for you if you're unable to communicate or make decisions yourself.\",\n      whyYouNeedIt: \"Medical emergencies can happen suddenly. Having someone legally authorized to speak with doctors and make decisions ensures your care isn't delayed and your wishes are respected.\",\n      whatHappensWithout: \"Doctors may not know who to consult about your care. Family members may disagree about treatment, causing delays and conflict. In worst cases, a court may need to appoint a guardian.\",\n    },\n    healthcare_directive: {\n      whatItIs: \"A Healthcare Directive (or Living Will) documents your wishes for end-of-life medical care - like whether you want to be kept on life support, receive CPR, or have a feeding tube. It speaks for you when you can't.\",\n      whyYouNeedIt: \"This document takes the burden of difficult decisions off your loved ones. Instead of guessing what you'd want, they can follow your clearly stated wishes during an incredibly stressful time.\",\n      whatHappensWithout: \"Your family may face agonizing decisions without knowing your wishes. Family members may disagree, leading to conflict and guilt. Medical staff may default to aggressive treatment you wouldn't have wanted.\",\n    },\n    hipaa: {\n      whatItIs: \"A HIPAA Authorization allows specific people to access your medical records and speak with your healthcare providers about your health information.\",\n      whyYouNeedIt: \"Due to privacy laws, doctors and hospitals can't share your medical information - even with close family - without your permission. This form ensures your loved ones can stay informed about your health.\",\n      whatHappensWithout: \"Even your spouse or adult children may be unable to get information about your condition, test results, or treatment plans. This can cause enormous frustration during health crises.\",\n    },\n    credit_shelter_trust: {\n      whatItIs: \"A Credit Shelter Trust (also called a Bypass Trust or Family Trust) is a special trust for married couples that can reduce estate taxes by using both spouses' tax exemptions.\",\n      whyYouNeedIt: \"For larger estates, this trust can save hundreds of thousands of dollars in estate taxes while still providing for your surviving spouse and ultimately passing assets to your children.\",\n      whatHappensWithout: \"You may pay more estate taxes than necessary. Your spouse might not be able to use your estate tax exemption, essentially wasting a valuable tax benefit.\",\n    },\n    ilit: {\n      whatItIs: \"An Irrevocable Life Insurance Trust (ILIT) owns your life insurance policy outside of your estate. This means the death benefit isn't counted as part of your estate for tax purposes.\",\n      whyYouNeedIt: \"For people with large estates, life insurance can push you over the estate tax threshold. An ILIT keeps those proceeds out of your taxable estate, potentially saving your heirs significant taxes.\",\n      whatHappensWithout: \"Life insurance proceeds become part of your taxable estate. For large estates, this could mean 40% or more of your insurance payout goes to taxes instead of your beneficiaries.\",\n    },\n    homestead_declaration: {\n      whatItIs: \"A Homestead Declaration is a document filed with your county that protects your home from certain creditors. It creates a legal shield around the equity in your primary residence.\",\n      whyYouNeedIt: \"If you face a lawsuit or financial trouble, a homestead declaration can protect your home equity (up to state limits) from being seized to pay creditors. It's an important layer of asset protection.\",\n      whatHappensWithout: \"Your home equity could be vulnerable to creditor claims from lawsuits, medical bills, or business debts. You might lose your home or be forced to sell it to pay creditors.\",\n    },\n  };\n\n  return explanations[documentType] || {\n    whatItIs: \"This is an important estate planning document.\",\n    whyYouNeedIt: \"It helps protect you and your family.\",\n    whatHappensWithout: \"You may not have proper legal protections in place.\",\n  };\n}\n\n/**\n * Get plain-language explanation for common issue types\n */\nexport function getIssueTypeExplanation(issueType: string): string {\n  const explanations: Record<string, string> = {\n    missing_beneficiary: \"A beneficiary is the person (or people) you've named to receive assets from accounts like retirement plans, life insurance, or bank accounts. These assets pass directly to beneficiaries - they don't go through your will.\",\n    unclear_trust: \"This means there's something about your trust that could cause problems - maybe it's not properly funded (assets haven't been transferred into it), or key details like who manages it after you're gone aren't clear.\",\n    missing_guardian: \"A guardian is the person you want to raise your children if something happens to you. Without naming one in your will, a court will decide - and it might not be who you'd choose.\",\n    outdated_designation: \"Beneficiary designations should be reviewed regularly. Life changes - marriages, divorces, births, deaths - can make old designations problematic or even give assets to the wrong people.\",\n    inconsistent_beneficiary: \"Your beneficiary designations on accounts may not match what's in your will or what you actually want. This can cause confusion, family conflict, or assets going to unintended recipients.\",\n  };\n\n  return explanations[issueType] || \"This issue may need your attention to ensure your estate plan works as intended.\";\n}\n\n// ============================================\n// RESOLUTION STEPS\n// ============================================\n\n/**\n * Get step-by-step resolution instructions for missing documents\n */\nexport function getDocumentResolutionSteps(documentType: string): string[] {\n  const steps: Record<string, string[]> = {\n    will: [\n      \"Decide who you want to inherit your assets and in what proportions\",\n      \"Choose an executor - someone responsible to carry out your wishes\",\n      \"If you have minor children, decide who should be their guardian\",\n      \"Consult with an estate planning attorney to draft your will\",\n      \"Sign your will in front of witnesses (requirements vary by state)\",\n      \"Store the original in a safe place and tell your executor where it is\",\n    ],\n    trust: [\n      \"Decide what type of trust best fits your needs (revocable is most common)\",\n      \"Choose a successor trustee to manage the trust after you\",\n      \"List the beneficiaries and their shares\",\n      \"Work with an estate planning attorney to create the trust document\",\n      \"Fund the trust by transferring assets into it (retitling property, accounts)\",\n      \"Update beneficiary designations on retirement accounts to align with your plan\",\n    ],\n    poa_financial: [\n      \"Choose someone you trust completely to handle your finances if needed\",\n      \"Consider naming a backup agent in case your first choice can't serve\",\n      \"Decide when the power should take effect (immediately or only if incapacitated)\",\n      \"Work with an attorney to draft the document with appropriate powers\",\n      \"Sign the document according to your state's requirements (notarization usually required)\",\n      \"Give a copy to your agent and keep the original in a safe place\",\n    ],\n    poa_healthcare: [\n      \"Choose someone who understands your healthcare wishes and can advocate for you\",\n      \"Have a conversation with them about your preferences for medical care\",\n      \"Consider naming an alternate agent as a backup\",\n      \"Work with an attorney or use your state's official form\",\n      \"Sign the document with proper witnesses/notarization as required\",\n      \"Give copies to your agent, your doctor, and the hospital where you'd likely receive care\",\n    ],\n    healthcare_directive: [\n      \"Think carefully about your wishes for end-of-life care\",\n      \"Consider: life support, CPR, feeding tubes, pain management preferences\",\n      \"Discuss your values and wishes with your family and healthcare proxy\",\n      \"Complete your state's official advance directive form or work with an attorney\",\n      \"Sign the document with proper witnesses as required by your state\",\n      \"Distribute copies to your healthcare agent, doctors, and family members\",\n    ],\n    hipaa: [\n      \"Decide who should be able to access your medical information\",\n      \"Obtain a HIPAA authorization form (from your doctor or attorney)\",\n      \"List each person by name with their relationship to you\",\n      \"Specify what information they can access (usually 'all' is recommended)\",\n      \"Sign and date the form\",\n      \"Give copies to each authorized person and your healthcare providers\",\n    ],\n    credit_shelter_trust: [\n      \"Evaluate your estate size to see if this trust would provide tax benefits\",\n      \"Discuss the strategy with your spouse - both must understand the implications\",\n      \"Consult with an estate planning attorney who specializes in tax planning\",\n      \"Coordinate the trust with your will and other estate documents\",\n      \"Fund the trust appropriately after the first spouse passes\",\n      \"Review periodically as estate tax laws change\",\n    ],\n    ilit: [\n      \"Determine if your estate is large enough to benefit from an ILIT\",\n      \"Choose a trustee (cannot be you or your spouse)\",\n      \"Work with an attorney to create the irrevocable trust\",\n      \"Transfer existing policy ownership to the trust OR have the trust purchase a new policy\",\n      \"Make annual gifts to the trust to pay premiums (using Crummey notices)\",\n      \"Understand this trust cannot be changed once created - it's permanent\",\n    ],\n    homestead_declaration: [\n      \"Verify your state offers homestead protection (not all do)\",\n      \"Obtain the homestead declaration form from your county recorder's office\",\n      \"Fill out the form with your property information\",\n      \"Sign the form (notarization may be required)\",\n      \"File the form with your county recorder's office and pay any filing fee\",\n      \"Keep a copy with your important documents\",\n    ],\n  };\n\n  return steps[documentType] || [\n    \"Identify what document you need\",\n    \"Gather information about your wishes and situation\",\n    \"Consult with an estate planning attorney\",\n    \"Sign the document according to your state's requirements\",\n    \"Store it safely and inform relevant parties\",\n  ];\n}\n\n/**\n * Get resolution steps for common issues\n */\nexport function getIssueResolutionSteps(issueType: string): string[] {\n  const steps: Record<string, string[]> = {\n    missing_beneficiary: [\n      \"Gather account statements for all retirement accounts, life insurance, and bank accounts\",\n      \"Contact each financial institution to request current beneficiary information\",\n      \"Review each designation - does it still reflect your wishes?\",\n      \"Update any outdated designations with new beneficiary forms\",\n      \"Name both primary AND contingent (backup) beneficiaries on every account\",\n      \"Keep copies of all beneficiary designation forms with your estate documents\",\n    ],\n    unclear_trust: [\n      \"Locate your original trust document and any amendments\",\n      \"Review who is named as successor trustee - are they still the right choice?\",\n      \"Check if the trust has been funded - are assets actually titled in the trust's name?\",\n      \"Verify beneficiary designations are clear and percentages add up to 100%\",\n      \"Meet with an estate planning attorney to address any gaps or unclear provisions\",\n      \"Create a trust funding checklist and transfer any assets still in your personal name\",\n    ],\n    missing_guardian: [\n      \"Have a conversation with your spouse/partner about who you'd want to raise your children\",\n      \"Consider the potential guardian's values, parenting style, and financial stability\",\n      \"Think about location - would your children need to move schools?\",\n      \"Talk to your chosen guardian to make sure they're willing and able\",\n      \"Name an alternate guardian in case your first choice can't serve\",\n      \"Add guardian nominations to your will and have it properly signed\",\n    ],\n    outdated_designation: [\n      \"Pull recent statements for all accounts with beneficiary designations\",\n      \"Make a list showing current beneficiaries for each account\",\n      \"Compare against your current wishes and family situation\",\n      \"Contact financial institutions to update any that need changing\",\n      \"Set a calendar reminder to review beneficiaries annually\",\n      \"Review after any major life event (marriage, divorce, birth, death)\",\n    ],\n    inconsistent_beneficiary: [\n      \"Create a spreadsheet listing all your accounts and their current beneficiaries\",\n      \"Compare this list with your will and/or trust beneficiaries\",\n      \"Identify any inconsistencies that could cause confusion or conflict\",\n      \"Decide what the correct beneficiary should be for each account\",\n      \"Update beneficiary forms to match your intended plan\",\n      \"Keep everything consistent - your will, trust, and beneficiary designations should tell the same story\",\n    ],\n  };\n\n  return steps[issueType] || [\n    \"Review your current estate planning documents\",\n    \"Identify what needs to be updated or created\",\n    \"Consult with an estate planning professional\",\n    \"Make the necessary changes\",\n    \"Document everything and store safely\",\n  ];\n}\n\n// ============================================\n// COMPONENTS\n// ============================================\n\nexport default function GapAnalysisCard({\n  type,\n  title,\n  description,\n  priority,\n  action,\n  documentType,\n  issueType,\n  severity,\n  affectedAssets,\n  recommendation,\n  showResolutionSteps = false,\n}: GapAnalysisCardProps) {\n  const [isExpanded, setIsExpanded] = useState(false);\n  const config = TYPE_CONFIG[type];\n\n  // Get explanation and steps based on context\n  const docExplanation = documentType ? getDocumentExplanation(documentType) : null;\n  const issueExplanation = issueType ? getIssueTypeExplanation(issueType) : null;\n  const resolutionSteps = documentType\n    ? getDocumentResolutionSteps(documentType)\n    : issueType\n      ? getIssueResolutionSteps(issueType)\n      : [];\n\n  return (\n    <div className={`${config.bgColor} ${config.borderColor} border rounded-lg p-4`}>\n      <div className=\"flex items-start gap-3\">\n        <div className={`flex-shrink-0 ${config.iconColor}`}>\n          {config.icon}\n        </div>\n        <div className=\"flex-1 min-w-0\">\n          <div className=\"flex items-center gap-2 flex-wrap\">\n            <h4 className={`font-medium ${config.titleColor}`}>{title}</h4>\n            {priority && (\n              <span className={`text-xs px-2 py-0.5 rounded-full font-medium ${PRIORITY_BADGE[priority]}`}>\n                {priority.charAt(0).toUpperCase() + priority.slice(1)} Priority\n              </span>\n            )}\n            {severity && (\n              <span className={`text-xs px-2 py-0.5 rounded-full font-medium ${SEVERITY_BADGE[severity]}`}>\n                {severity.charAt(0).toUpperCase() + severity.slice(1)}\n              </span>\n            )}\n          </div>\n\n          <p className=\"text-sm text-gray-600 dark:text-gray-400 mt-1\">{description}</p>\n\n          {/* Affected Assets */}\n          {affectedAssets && affectedAssets.length > 0 && (\n            <div className=\"mt-2\">\n              <span className=\"text-xs text-gray-500 dark:text-gray-400\">Affected: </span>\n              <span className=\"text-xs font-medium text-gray-700 dark:text-gray-300\">\n                {affectedAssets.join(\", \")}\n              </span>\n            </div>\n          )}\n\n          {/* Recommendation */}\n          {recommendation && (\n            <div className=\"mt-2 p-2 bg-white/50 dark:bg-gray-800/50 rounded text-sm\">\n              <span className=\"font-medium text-gray-700 dark:text-gray-300\">Recommendation: </span>\n              <span className=\"text-gray-600 dark:text-gray-400\">{recommendation}</span>\n            </div>\n          )}\n\n          {/* Expandable Details */}\n          {(docExplanation || issueExplanation || showResolutionSteps) && (\n            <div className=\"mt-3\">\n              <button\n                onClick={() => setIsExpanded(!isExpanded)}\n                className=\"flex items-center gap-1 text-sm font-medium text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 transition-colors\"\n              >\n                <svg\n                  className={`w-4 h-4 transition-transform ${isExpanded ? 'rotate-90' : ''}`}\n                  fill=\"none\"\n                  stroke=\"currentColor\"\n                  viewBox=\"0 0 24 24\"\n                >\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 5l7 7-7 7\" />\n                </svg>\n                {isExpanded ? 'Hide details' : 'Learn more & how to fix'}\n              </button>\n\n              {isExpanded && (\n                <div className=\"mt-3 space-y-4 p-3 bg-white/70 dark:bg-gray-800/70 rounded-lg\">\n                  {/* Plain Language Explanation */}\n                  {docExplanation && (\n                    <div className=\"space-y-3\">\n                      <div>\n                        <h5 className=\"text-sm font-semibold text-gray-800 dark:text-gray-200\">\n                          What is this document?\n                        </h5>\n                        <p className=\"text-sm text-gray-600 dark:text-gray-400 mt-1\">\n                          {docExplanation.whatItIs}\n                        </p>\n                      </div>\n                      <div>\n                        <h5 className=\"text-sm font-semibold text-gray-800 dark:text-gray-200\">\n                          Why do you need it?\n                        </h5>\n                        <p className=\"text-sm text-gray-600 dark:text-gray-400 mt-1\">\n                          {docExplanation.whyYouNeedIt}\n                        </p>\n                      </div>\n                      <div>\n                        <h5 className=\"text-sm font-semibold text-amber-700 dark:text-amber-400\">\n                          What happens without it?\n                        </h5>\n                        <p className=\"text-sm text-gray-600 dark:text-gray-400 mt-1\">\n                          {docExplanation.whatHappensWithout}\n                        </p>\n                      </div>\n                    </div>\n                  )}\n\n                  {/* Issue Type Explanation */}\n                  {issueExplanation && !docExplanation && (\n                    <div>\n                      <h5 className=\"text-sm font-semibold text-gray-800 dark:text-gray-200\">\n                        What does this mean?\n                      </h5>\n                      <p className=\"text-sm text-gray-600 dark:text-gray-400 mt-1\">\n                        {issueExplanation}\n                      </p>\n                    </div>\n                  )}\n\n                  {/* Resolution Steps */}\n                  {resolutionSteps.length > 0 && (\n                    <div>\n                      <h5 className=\"text-sm font-semibold text-green-700 dark:text-green-400 mb-2\">\n                        How to resolve this:\n                      </h5>\n                      <ol className=\"space-y-2\">\n                        {resolutionSteps.map((step, index) => (\n                          <li key={index} className=\"flex gap-2 text-sm\">\n                            <span className=\"flex-shrink-0 w-5 h-5 rounded-full bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400 flex items-center justify-center text-xs font-medium\">\n                              {index + 1}\n                            </span>\n                            <span className=\"text-gray-600 dark:text-gray-400\">{step}</span>\n                          </li>\n                        ))}\n                      </ol>\n                    </div>\n                  )}\n                </div>\n              )}\n            </div>\n          )}\n\n          {action && <div className=\"mt-3\">{action}</div>}\n        </div>\n      </div>\n    </div>\n  );\n}\n\n// ============================================\n// COMMON ISSUE CARD (Specialized component)\n// ============================================\n\ninterface CommonIssueCardProps {\n  type: \"missing_beneficiary\" | \"unclear_trust\" | \"missing_guardian\" | \"outdated_designation\" | \"inconsistent_beneficiary\";\n  severity: Severity;\n  title: string;\n  description: string;\n  affectedAssets?: string[];\n  recommendation: string;\n}\n\nexport function CommonIssueCard({\n  type,\n  severity,\n  title,\n  description,\n  affectedAssets,\n  recommendation,\n}: CommonIssueCardProps) {\n  return (\n    <GapAnalysisCard\n      type=\"common_issue\"\n      title={title}\n      description={description}\n      severity={severity}\n      issueType={type}\n      affectedAssets={affectedAssets}\n      recommendation={recommendation}\n      showResolutionSteps={true}\n    />\n  );\n}\n\n// Score ring component\ninterface ScoreRingProps {\n  score: number;\n  size?: \"sm\" | \"md\" | \"lg\";\n}\n\nexport function ScoreRing({ score, size = \"md\" }: ScoreRingProps) {\n  const sizeConfig = {\n    sm: { ring: 60, stroke: 6, text: \"text-lg\" },\n    md: { ring: 100, stroke: 8, text: \"text-2xl\" },\n    lg: { ring: 140, stroke: 10, text: \"text-4xl\" },\n  };\n\n  const config = sizeConfig[size];\n  const radius = (config.ring - config.stroke) / 2;\n  const circumference = radius * 2 * Math.PI;\n  const offset = circumference - (score / 100) * circumference;\n\n  const getColor = (score: number) => {\n    if (score >= 80) return \"text-green-500\";\n    if (score >= 60) return \"text-yellow-500\";\n    if (score >= 40) return \"text-orange-500\";\n    return \"text-red-500\";\n  };\n\n  const getLabel = (score: number) => {\n    if (score >= 80) return \"Good\";\n    if (score >= 60) return \"Fair\";\n    if (score >= 40) return \"Needs Work\";\n    return \"Critical\";\n  };\n\n  return (\n    <div className=\"flex flex-col items-center\">\n      <div className=\"relative inline-flex items-center justify-center\">\n        <svg width={config.ring} height={config.ring} className=\"-rotate-90\">\n          {/* Background circle */}\n          <circle\n            cx={config.ring / 2}\n            cy={config.ring / 2}\n            r={radius}\n            fill=\"none\"\n            stroke=\"currentColor\"\n            strokeWidth={config.stroke}\n            className=\"text-gray-200 dark:text-gray-700\"\n          />\n          {/* Progress circle */}\n          <circle\n            cx={config.ring / 2}\n            cy={config.ring / 2}\n            r={radius}\n            fill=\"none\"\n            stroke=\"currentColor\"\n            strokeWidth={config.stroke}\n            strokeDasharray={circumference}\n            strokeDashoffset={offset}\n            strokeLinecap=\"round\"\n            className={`${getColor(score)} transition-all duration-500`}\n          />\n        </svg>\n        <div className=\"absolute inset-0 flex items-center justify-center\">\n          <span className={`font-bold ${config.text} ${getColor(score)}`}>{score}</span>\n        </div>\n      </div>\n      {size !== \"sm\" && (\n        <span className={`mt-1 text-sm font-medium ${getColor(score)}`}>\n          {getLabel(score)}\n        </span>\n      )}\n    </div>\n  );\n}\n\n// ============================================\n// SUMMARY COMPONENTS\n// ============================================\n\ninterface GapSummaryProps {\n  criticalCount: number;\n  highCount: number;\n  mediumCount: number;\n  lowCount: number;\n}\n\nexport function GapSummary({ criticalCount, highCount, mediumCount, lowCount }: GapSummaryProps) {\n  const total = criticalCount + highCount + mediumCount + lowCount;\n\n  if (total === 0) {\n    return (\n      <div className=\"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg p-4 text-center\">\n        <svg className=\"w-8 h-8 mx-auto text-green-500 mb-2\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z\" />\n        </svg>\n        <p className=\"text-green-800 dark:text-green-200 font-medium\">No issues found!</p>\n        <p className=\"text-sm text-green-600 dark:text-green-400 mt-1\">Your estate plan looks complete.</p>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"bg-gray-50 dark:bg-gray-800 rounded-lg p-4\">\n      <h3 className=\"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3\">Issues Found</h3>\n      <div className=\"grid grid-cols-4 gap-2 text-center\">\n        {criticalCount > 0 && (\n          <div className=\"bg-red-100 dark:bg-red-900/30 rounded-lg p-2\">\n            <div className=\"text-xl font-bold text-red-700 dark:text-red-400\">{criticalCount}</div>\n            <div className=\"text-xs text-red-600 dark:text-red-500\">Critical</div>\n          </div>\n        )}\n        {highCount > 0 && (\n          <div className=\"bg-orange-100 dark:bg-orange-900/30 rounded-lg p-2\">\n            <div className=\"text-xl font-bold text-orange-700 dark:text-orange-400\">{highCount}</div>\n            <div className=\"text-xs text-orange-600 dark:text-orange-500\">High</div>\n          </div>\n        )}\n        {mediumCount > 0 && (\n          <div className=\"bg-yellow-100 dark:bg-yellow-900/30 rounded-lg p-2\">\n            <div className=\"text-xl font-bold text-yellow-700 dark:text-yellow-400\">{mediumCount}</div>\n            <div className=\"text-xs text-yellow-600 dark:text-yellow-500\">Medium</div>\n          </div>\n        )}\n        {lowCount > 0 && (\n          <div className=\"bg-green-100 dark:bg-green-900/30 rounded-lg p-2\">\n            <div className=\"text-xl font-bold text-green-700 dark:text-green-400\">{lowCount}</div>\n            <div className=\"text-xs text-green-600 dark:text-green-500\">Low</div>\n          </div>\n        )}\n      </div>\n      {criticalCount > 0 && (\n        <p className=\"text-xs text-red-600 dark:text-red-400 mt-3 text-center\">\n          Address critical issues first - they have the biggest impact on your estate plan.\n        </p>\n      )}\n    </div>\n  );\n}\n","\"use client\";\n\nimport { useQuery } from \"convex/react\";\nimport { api } from \"@/convex/_generated/api\";\nimport { Id } from \"@/convex/_generated/dataModel\";\n\ninterface GapAnalysisProgressProps {\n  runId: Id<\"gapAnalysisRuns\">;\n  onComplete?: () => void;\n}\n\nconst phaseLabels: Record<string, string> = {\n  research: \"Research & Context\",\n  analysis: \"Deep Analysis\",\n  synthesis: \"Synthesis\",\n};\n\nconst runTypeLabels: Record<string, string> = {\n  state_law_research: \"Researching State Laws\",\n  client_context_analysis: \"Analyzing Client Context\",\n  document_inventory: \"Creating Document Inventory\",\n  document_completeness: \"Checking Document Completeness\",\n  tax_optimization: \"Identifying Tax Strategies\",\n  medicaid_planning: \"Analyzing Medicaid Options\",\n  beneficiary_coordination: \"Coordinating Beneficiaries\",\n  family_protection: \"Evaluating Family Protection\",\n  asset_protection: \"Assessing Asset Protection\",\n  existing_document_review: \"Reviewing Existing Documents\",\n  scenario_modeling: \"Modeling What-If Scenarios\",\n  priority_matrix: \"Building Priority Matrix\",\n  final_report: \"Generating Final Report\",\n};\n\nexport function GapAnalysisProgress({ runId, onComplete }: GapAnalysisProgressProps) {\n  const progress = useQuery(api.gapAnalysisProgress.getRunProgress, { runId });\n\n  // Call onComplete when analysis finishes\n  if (progress?.status === \"completed\" || progress?.status === \"partial\") {\n    onComplete?.();\n  }\n\n  if (!progress) {\n    return (\n      <div className=\"p-6 bg-white rounded-lg border border-gray-200 animate-pulse\">\n        <div className=\"h-4 bg-gray-200 rounded w-3/4 mb-4\"></div>\n        <div className=\"h-2 bg-gray-200 rounded w-full mb-6\"></div>\n        <div className=\"space-y-4\">\n          {[1, 2, 3].map((i) => (\n            <div key={i} className=\"h-16 bg-gray-100 rounded\"></div>\n          ))}\n        </div>\n      </div>\n    );\n  }\n\n  const isRunning = ![\"completed\", \"failed\", \"partial\"].includes(progress.status);\n\n  return (\n    <div className=\"p-6 bg-white rounded-lg border border-gray-200\">\n      {/* Header */}\n      <div className=\"flex items-center justify-between mb-4\">\n        <h3 className=\"text-lg font-semibold text-gray-900\">\n          Comprehensive Analysis\n        </h3>\n        <span\n          className={`px-3 py-1 rounded-full text-sm font-medium ${\n            progress.status === \"completed\"\n              ? \"bg-green-100 text-green-800\"\n              : progress.status === \"failed\"\n              ? \"bg-red-100 text-red-800\"\n              : progress.status === \"partial\"\n              ? \"bg-yellow-100 text-yellow-800\"\n              : \"bg-blue-100 text-blue-800\"\n          }`}\n        >\n          {progress.status === \"completed\"\n            ? \"Complete\"\n            : progress.status === \"failed\"\n            ? \"Failed\"\n            : progress.status === \"partial\"\n            ? \"Partial\"\n            : \"In Progress\"}\n        </span>\n      </div>\n\n      {/* Overall Progress */}\n      <div className=\"mb-6\">\n        <div className=\"flex justify-between text-sm text-gray-600 mb-2\">\n          <span>Overall Progress</span>\n          <span>{progress.overallProgress}%</span>\n        </div>\n        <div className=\"w-full bg-gray-200 rounded-full h-3 overflow-hidden\">\n          <div\n            className=\"h-full bg-gradient-to-r from-blue-500 to-blue-600 rounded-full transition-all duration-500\"\n            style={{ width: `${progress.overallProgress}%` }}\n          />\n        </div>\n      </div>\n\n      {/* Current Activity */}\n      {isRunning && progress.currentRun && (\n        <div className=\"mb-6 p-4 bg-blue-50 rounded-lg border border-blue-100\">\n          <div className=\"flex items-center gap-3\">\n            <div className=\"w-2 h-2 bg-blue-500 rounded-full animate-pulse\" />\n            <span className=\"text-sm text-blue-800 font-medium\">\n              {runTypeLabels[progress.currentRun.runType] || progress.currentRun.runType}\n            </span>\n          </div>\n        </div>\n      )}\n\n      {/* Phase Progress */}\n      <div className=\"space-y-4\">\n        {progress.phases.map((phase) => (\n          <PhaseCard key={phase.phaseNumber} phase={phase} />\n        ))}\n      </div>\n\n      {/* Estimated Time */}\n      {isRunning && progress.estimatedCompletionMs && progress.estimatedCompletionMs > 0 && (\n        <div className=\"mt-6 pt-4 border-t border-gray-200\">\n          <p className=\"text-sm text-gray-500 text-center\">\n            Estimated time remaining:{\" \"}\n            <span className=\"font-medium\">\n              {formatDuration(progress.estimatedCompletionMs)}\n            </span>\n          </p>\n        </div>\n      )}\n\n      {/* Error Message */}\n      {progress.error && (\n        <div className=\"mt-4 p-4 bg-red-50 rounded-lg border border-red-200\">\n          <p className=\"text-sm text-red-800\">{progress.error}</p>\n        </div>\n      )}\n    </div>\n  );\n}\n\ninterface PhaseCardProps {\n  phase: {\n    phaseNumber: number;\n    phaseType: string;\n    status: string;\n    totalRuns: number;\n    completedRuns: number;\n    failedRuns: number;\n  };\n}\n\nfunction PhaseCard({ phase }: PhaseCardProps) {\n  const isComplete = phase.status === \"completed\";\n  const isFailed = phase.status === \"failed\";\n  const isRunning = phase.status === \"running\";\n  const isPending = phase.status === \"pending\";\n\n  return (\n    <div\n      className={`p-4 rounded-lg border ${\n        isComplete\n          ? \"bg-green-50 border-green-200\"\n          : isFailed\n          ? \"bg-red-50 border-red-200\"\n          : isRunning\n          ? \"bg-blue-50 border-blue-200\"\n          : \"bg-gray-50 border-gray-200\"\n      }`}\n    >\n      <div className=\"flex items-center justify-between\">\n        <div className=\"flex items-center gap-3\">\n          {/* Phase Icon */}\n          <div\n            className={`w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold ${\n              isComplete\n                ? \"bg-green-500 text-white\"\n                : isFailed\n                ? \"bg-red-500 text-white\"\n                : isRunning\n                ? \"bg-blue-500 text-white\"\n                : \"bg-gray-300 text-gray-600\"\n            }`}\n          >\n            {isComplete ? (\n              <CheckIcon />\n            ) : isFailed ? (\n              <XIcon />\n            ) : (\n              phase.phaseNumber\n            )}\n          </div>\n\n          <div>\n            <h4\n              className={`font-medium ${\n                isComplete\n                  ? \"text-green-800\"\n                  : isFailed\n                  ? \"text-red-800\"\n                  : isRunning\n                  ? \"text-blue-800\"\n                  : \"text-gray-600\"\n              }`}\n            >\n              Phase {phase.phaseNumber}: {phaseLabels[phase.phaseType]}\n            </h4>\n            <p className=\"text-xs text-gray-500\">\n              {phase.completedRuns} of {phase.totalRuns} runs complete\n              {phase.failedRuns > 0 && ` (${phase.failedRuns} failed)`}\n            </p>\n          </div>\n        </div>\n\n        {/* Phase Progress */}\n        {isRunning && (\n          <div className=\"flex items-center gap-2\">\n            <div className=\"w-16 bg-blue-200 rounded-full h-2 overflow-hidden\">\n              <div\n                className=\"h-full bg-blue-500 rounded-full transition-all duration-300\"\n                style={{\n                  width: `${(phase.completedRuns / phase.totalRuns) * 100}%`,\n                }}\n              />\n            </div>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n\nfunction CheckIcon() {\n  return (\n    <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n      <path\n        strokeLinecap=\"round\"\n        strokeLinejoin=\"round\"\n        strokeWidth={2}\n        d=\"M5 13l4 4L19 7\"\n      />\n    </svg>\n  );\n}\n\nfunction XIcon() {\n  return (\n    <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n      <path\n        strokeLinecap=\"round\"\n        strokeLinejoin=\"round\"\n        strokeWidth={2}\n        d=\"M6 18L18 6M6 6l12 12\"\n      />\n    </svg>\n  );\n}\n\nfunction formatDuration(ms: number): string {\n  const minutes = Math.floor(ms / 60000);\n  const seconds = Math.floor((ms % 60000) / 1000);\n\n  if (minutes > 0) {\n    return `${minutes}m ${seconds}s`;\n  }\n  return `${seconds}s`;\n}\n"],"names":[],"mappings":"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U,iLACV,aAAc,2LACd,mBAAoB,2JACtB,EACA,KAAM,CACJ,SAAU,yLACV,aAAc,sMACd,mBAAoB,kLACtB,EACA,sBAAuB,CACrB,SAAU,sLACV,aAAc,yMACd,mBAAoB,6KACtB,EACF,CAEmB,CAAC,AA+LyC,EA/L5B,EAAI,CACnC,SAAU,iDACV,aAAc,wCACd,mBAAoB,qDACtB,EA2L6E,KACvE,EAAmB,EA7KlB,CARsC,CAC3C,QAoLmC,YApLd,+NACrB,cAAe,yNACf,iBAAkB,qLAClB,qBAAsB,6LACtB,yBAA0B,8LAC5B,CAEmB,CAAC,AA6KyC,EA7K/B,EAAI,mFA6KwC,KACpE,EAAkB,EAxFjB,CA3EiC,CACtC,KAAM,CACJ,KAkKA,gEAjKA,oEACA,kEACA,8DACA,oEACA,wEACD,CACD,MAAO,CACL,4EACA,2DACA,0CACA,qEACA,+EACA,iFACD,CACD,cAAe,CACb,wEACA,uEACA,kFACA,sEACA,2FACA,kEACD,CACD,eAAgB,CACd,iFACA,wEACA,iDACA,0DACA,mEACA,2FACD,CACD,qBAAsB,CACpB,yDACA,0EACA,uEACA,iFACA,oEACA,0EACD,CACD,MAAO,CACL,+DACA,mEACA,0DACA,0EACA,yBACA,sEACD,CACD,qBAAsB,CACpB,4EACA,gFACA,2EACA,iEACA,6DACA,gDACD,CACD,KAAM,CACJ,mEACA,kDACA,wDACA,0FACA,yEACA,wEACD,CACD,sBAAuB,CACrB,6DACA,2EACA,mDACA,+CACA,0EACA,4CACD,CACH,CAEY,CAAC,AAyFkB,EAzFL,EAAI,CAC5B,kCACA,qDACA,2CACA,2DACA,8CACD,CAoFG,EAlCG,CA3CiC,CACtC,QA6EI,YA7EiB,CACnB,2FACA,gFACA,+DACA,8DACA,2EACA,8EACD,CACD,cAAe,CACb,yDACA,8EACA,uFACA,2EACA,kFACA,uFACD,CACD,iBAAkB,CAChB,2FACA,qFACA,mEACA,qEACA,mEACA,oEACD,CACD,qBAAsB,CACpB,wEACA,6DACA,2DACA,kEACA,2DACA,sEACD,CACD,yBAA0B,CACxB,iFACA,8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"}