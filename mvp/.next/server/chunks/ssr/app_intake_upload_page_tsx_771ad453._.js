module.exports=[84342,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944);a.i(11241);var e=a.i(96373),f=a.i(1322),g=a.i(38246),h=a.i(49815),i=a.i(55768);let j=!!process.env.NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY,k=[{value:"will",label:"Will",description:"Last Will and Testament"},{value:"trust",label:"Trust",description:"Revocable or Irrevocable Trust"},{value:"poa_financial",label:"Financial POA",description:"Power of Attorney for Finances"},{value:"poa_healthcare",label:"Healthcare POA",description:"Healthcare Power of Attorney"},{value:"healthcare_directive",label:"Healthcare Directive",description:"Living Will / Advance Directive"},{value:"deed",label:"Deed",description:"Property Deed or Title"},{value:"insurance_policy",label:"Insurance Policy",description:"Life Insurance or Annuity"},{value:"beneficiary_form",label:"Beneficiary Form",description:"Beneficiary Designation"},{value:"tax_return",label:"Tax Return",description:"Federal or State Income Tax Return"},{value:"other",label:"Other",description:"Other Estate Document"}];function l(){let a=(0,d.useRouter)(),l=(0,d.useSearchParams)().get("planId"),{isSignedIn:m,isLoaded:n}=(0,h.useUser)();(0,i.useAuthSync)();let[o,p]=(0,c.useState)(!1),[q,r]=(0,c.useState)(l||null),[s,t]=(0,c.useState)(!1),[u,v]=(0,c.useState)(0),[w,x]=(0,c.useState)(null),[y,z]=(0,c.useState)("will"),[A,B]=(0,c.useState)(!1),[C,D]=(0,c.useState)(!1),[E,F]=(0,c.useState)(!1),G=(0,c.useRef)(null),H=(0,e.useMutation)(f.api.estatePlanning.createEstatePlan),I=(0,e.useMutation)(f.api.uploadedDocuments.generateUploadUrl),J=(0,e.useMutation)(f.api.uploadedDocuments.saveUploadedDocument),K=(0,e.useMutation)(f.api.uploadedDocuments.deleteUploadedDocument),L=(0,e.useAction)(f.api.documentAnalysis.analyzeDocument),M=(0,e.useAction)(f.api.documentExtraction.extractIntakeData),N=(0,e.useQuery)(f.api.uploadedDocuments.getUploadedDocuments,q?{estatePlanId:q}:"skip"),O=(0,e.useQuery)(f.api.extractedData.getExtractedData,q?{estatePlanId:q}:"skip");(0,c.useEffect)(()=>{j&&n&&!m&&a.push("/intake")},[n,m,a]),(0,c.useEffect)(()=>{(async()=>{if((!j||n)&&!l&&!q&&!o){let b=localStorage.getItem("estatePlanId");if(b){r(b),a.replace(`/intake/upload?planId=${b}`);return}p(!0);try{let b;{let a=`session_${Date.now()}_${Math.random().toString(36).substring(7)}`;b=await H({sessionId:a,name:"My Estate Plan"}),localStorage.setItem("estatePlanSessionId",a)}localStorage.setItem("estatePlanId",b),r(b),a.replace(`/intake/upload?planId=${b}`)}catch(a){console.error("Failed to create estate plan:",a)}finally{p(!1)}}})()},[l,q,o,H,a,n,null]);let P=(0,c.useCallback)(async a=>{if(q){if(!a.type.includes("pdf"))return void x("Please upload a PDF file");if(a.size>0x1400000)return void x("File size must be less than 20MB");t(!0),v(10),x(null);try{let b=await I();v(30);let c=await fetch(b,{method:"POST",headers:{"Content-Type":a.type},body:a});if(!c.ok)throw Error("Upload failed");let{storageId:d}=await c.json();v(60);let e=await J({estatePlanId:q,storageId:d,fileName:a.name,fileSize:a.size,mimeType:a.type,documentType:y});v(80),L({documentId:e}),v(100),G.current&&(G.current.value="")}catch(a){x(a instanceof Error?a.message:"Upload failed")}finally{t(!1),v(0)}}},[q,y,I,J,L]),Q=(0,c.useCallback)(a=>{a.preventDefault(),B(!0)},[]),R=(0,c.useCallback)(a=>{a.preventDefault(),B(!1)},[]),S=(0,c.useCallback)(a=>{a.preventDefault(),B(!1);let b=a.dataTransfer.files;b.length>0&&P(b[0])},[P]),T=(0,c.useCallback)(async a=>{confirm("Delete this document?")&&await K({documentId:a})},[K]),U=(0,c.useCallback)(async()=>{if(q){D(!0);try{let a=await M({estatePlanId:q});a.success?F(!0):x(a.error||"Extraction failed")}catch(a){x(a instanceof Error?a.message:"Extraction failed")}finally{D(!1)}}},[q,M]),V=()=>{q&&a.push(`/intake/personal?planId=${q}`)};if(o)return(0,b.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,b.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})});let W=N&&N.length>0,X=O&&O.length>0;return(0,b.jsxs)("div",{className:"max-w-3xl mx-auto space-y-8",children:[(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-blue-100 dark:bg-blue-900/30 rounded-full mb-4",children:(0,b.jsx)("svg",{className:"w-8 h-8 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),(0,b.jsx)("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Do you have existing estate documents?"}),(0,b.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mt-2 max-w-xl mx-auto",children:"Upload your existing wills, trusts, or powers of attorney. We'll extract information to pre-fill your questionnaire and save you time."})]}),(0,b.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6",children:[(0,b.jsx)("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Upload Documents"}),(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Document Type"}),(0,b.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2",children:k.slice(0,6).map(a=>(0,b.jsxs)("button",{type:"button",onClick:()=>z(a.value),className:`
                  p-3 rounded-lg border text-left transition-colors text-sm
                  ${y===a.value?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-200 dark:border-gray-700 hover:border-blue-300"}
                `,children:[(0,b.jsx)("div",{className:"font-medium text-gray-900 dark:text-white",children:a.label}),(0,b.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-0.5",children:a.description})]},a.value))}),(0,b.jsx)("div",{className:"mt-2 flex gap-2",children:k.slice(6).map(a=>(0,b.jsx)("button",{type:"button",onClick:()=>z(a.value),className:`
                  px-3 py-1.5 rounded-lg border text-sm transition-colors
                  ${y===a.value?"border-blue-500 bg-blue-50 dark:bg-blue-900/20 text-blue-700 dark:text-blue-300":"border-gray-200 dark:border-gray-700 text-gray-600 dark:text-gray-400 hover:border-blue-300"}
                `,children:a.label},a.value))})]}),(0,b.jsxs)("div",{onDragOver:Q,onDragLeave:R,onDrop:S,onClick:()=>G.current?.click(),className:`
            border-2 border-dashed rounded-lg p-8 text-center cursor-pointer transition-colors
            ${A?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-300 dark:border-gray-600 hover:border-blue-400 dark:hover:border-blue-500"}
            ${s?"pointer-events-none opacity-50":""}
          `,children:[(0,b.jsx)("input",{ref:G,type:"file",accept:".pdf",onChange:a=>a.target.files?.[0]&&P(a.target.files[0]),className:"hidden"}),s?(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-blue-600 mx-auto mb-3"}),(0,b.jsxs)("p",{className:"text-gray-600 dark:text-gray-400",children:["Uploading... ",u,"%"]})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("svg",{className:"w-10 h-10 mx-auto mb-3 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),(0,b.jsxs)("p",{className:"text-gray-600 dark:text-gray-400",children:[(0,b.jsx)("span",{className:"font-medium text-blue-600 dark:text-blue-400",children:"Click to upload"})," ","or drag and drop"]}),(0,b.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-500 mt-1",children:"PDF files up to 20MB"})]})]}),w&&(0,b.jsx)("div",{className:"mt-4 p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:(0,b.jsx)("p",{className:"text-sm text-red-700 dark:text-red-300",children:w})}),W&&(0,b.jsxs)("div",{className:"mt-6",children:[(0,b.jsxs)("h3",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:["Uploaded (",N.length,")"]}),(0,b.jsx)("div",{className:"space-y-2",children:N.map(a=>(0,b.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-900/30 rounded-lg",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("svg",{className:"w-6 h-6 text-red-500 flex-shrink-0",fill:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8l-6-6z"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium text-gray-900 dark:text-white truncate max-w-[200px]",children:a.fileName}),(0,b.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:k.find(b=>b.value===a.documentType)?.label})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:`
                        text-xs px-2 py-0.5 rounded-full
                        ${"completed"===a.analysisStatus?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-300":"failed"===a.analysisStatus?"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-300":"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-300"}
                      `,children:"completed"===a.analysisStatus?"Ready":"failed"===a.analysisStatus?"Error":"Processing..."}),(0,b.jsx)("button",{onClick:()=>T(a._id),className:"p-1 text-gray-400 hover:text-red-500 transition-colors",children:(0,b.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]},a._id))})]})]}),W&&(0,b.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6",children:[(0,b.jsx)("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Extract Information"}),C?(0,b.jsxs)("div",{className:"text-center py-6",children:[(0,b.jsx)("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-blue-600 mx-auto mb-3"}),(0,b.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"AI is reading your documents..."}),(0,b.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-500 mt-1",children:"Extracting names, dates, beneficiaries, and more"})]}):E||X?(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 p-4 bg-green-50 dark:bg-green-900/20 rounded-lg",children:[(0,b.jsx)("div",{className:"w-10 h-10 bg-green-100 dark:bg-green-900/30 rounded-full flex items-center justify-center flex-shrink-0",children:(0,b.jsx)("svg",{className:"w-5 h-5 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium text-green-800 dark:text-green-200",children:"Extraction Complete"}),(0,b.jsx)("p",{className:"text-sm text-green-700 dark:text-green-300",children:"We found information to pre-fill your questionnaire"})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Data extracted for:"}),(0,b.jsx)("div",{className:"grid grid-cols-2 gap-2",children:O?.map(a=>{let c={personal:{label:"Personal Info",icon:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"},family:{label:"Family Details",icon:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"},assets:{label:"Assets",icon:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"},existing_documents:{label:"Existing Docs",icon:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"},goals:{label:"Goals & Wishes",icon:"M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z"}}[a.section]||{label:a.section,icon:""};return(0,b.jsxs)("div",{className:"flex items-center gap-2 p-2 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:[(0,b.jsx)("svg",{className:"w-4 h-4 text-blue-600 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:c.icon})}),(0,b.jsx)("span",{className:"text-sm text-blue-800 dark:text-blue-200 font-medium",children:c.label}),(0,b.jsx)("svg",{className:"w-4 h-4 text-green-500 ml-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})]},a.section)})})]}),(0,b.jsx)("div",{className:"p-3 bg-gray-50 dark:bg-gray-900/30 rounded-lg",children:(0,b.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[(0,b.jsx)("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Next:"})," ","Review the pre-filled forms and make any corrections. Fields from your documents will be marked with a blue badge."]})})]}):(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:"Our AI will read your documents and extract names, addresses, beneficiaries, asset information, and more to pre-fill your questionnaire."}),(0,b.jsxs)("button",{onClick:U,className:"w-full px-4 py-3 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-colors flex items-center justify-center gap-2",children:[(0,b.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),"Extract with AI"]})]})]}),(0,b.jsx)("div",{className:"flex flex-col sm:flex-row gap-4",children:W&&(E||X)?(0,b.jsxs)("button",{onClick:V,className:"flex-1 px-6 py-4 bg-blue-600 text-white rounded-lg font-medium text-lg hover:bg-blue-700 transition-colors flex items-center justify-center gap-2",children:["Continue to Questionnaire",(0,b.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]}):W?(0,b.jsx)("button",{onClick:V,className:"flex-1 px-6 py-4 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg font-medium text-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors",children:"Continue Without Extraction"}):(0,b.jsx)("button",{onClick:()=>{q&&a.push(`/intake/personal?planId=${q}`)},className:"flex-1 px-6 py-4 bg-blue-600 text-white rounded-lg font-medium text-lg hover:bg-blue-700 transition-colors",children:"I Don't Have Documents - Start Fresh"})}),(0,b.jsx)("div",{className:"bg-gray-50 dark:bg-gray-900/30 rounded-lg p-4",children:(0,b.jsxs)("div",{className:"flex gap-3",children:[(0,b.jsx)("svg",{className:"w-5 h-5 text-gray-400 flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,b.jsxs)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:[(0,b.jsx)("p",{className:"font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Why upload documents?"}),(0,b.jsxs)("ul",{className:"list-disc list-inside space-y-1",children:[(0,b.jsx)("li",{children:"Auto-fill your questionnaire with existing information"}),(0,b.jsx)("li",{children:"Identify gaps in your current estate plan"}),(0,b.jsx)("li",{children:"Get AI-powered analysis of your documents"}),(0,b.jsx)("li",{children:"Compare your documents against best practices"})]})]})]})}),(0,b.jsx)("div",{className:"text-center",children:(0,b.jsx)(g.default,{href:"/intake",className:"text-sm text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300",children:"Back to overview"})})]})}function m(){return(0,b.jsx)(c.Suspense,{fallback:(0,b.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,b.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}),children:(0,b.jsx)(l,{})})}a.s(["default",()=>m])}];

//# sourceMappingURL=app_intake_upload_page_tsx_771ad453._.js.map