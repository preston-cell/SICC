{"version":3,"sources":["../../../../node_modules/%40clerk/shared/src/utils/instance.ts","../../../../node_modules/%40clerk/shared/src/utils/runtimeEnvironment.ts","../../../../node_modules/%40clerk/shared/src/utils/handleValueOrFn.ts","../../../../node_modules/%40clerk/shared/src/utils/noop.ts","../../../../node_modules/%40clerk/shared/src/utils/createDeferredPromise.ts","../../../../node_modules/%40clerk/shared/src/utils/allSettled.ts","../../../../node_modules/%40clerk/shared/src/utils/logErrorInDevMode.ts","../../../../node_modules/%40clerk/shared/src/utils/fastDeepMerge.ts","../../../../node_modules/%40clerk/shared/dist/runtime/utils/index.js","../../../../node_modules/%40clerk/nextjs/src/utils/sdk-versions.ts","../../../../node_modules/%40clerk/nextjs/src/utils/feature-flags.ts","../../../../node_modules/%40clerk/shared/src/telemetry/throttler.ts","../../../../node_modules/%40clerk/shared/src/telemetry/collector.ts","../../../../node_modules/%40clerk/shared/src/telemetry/events/component-mounted.ts","../../../../node_modules/%40clerk/shared/src/telemetry/events/method-called.ts","../../../../node_modules/%40clerk/shared/src/telemetry/events/framework-metadata.ts","../../../../node_modules/%40clerk/shared/src/telemetry/events/theme-usage.ts","../../../../node_modules/%40clerk/shared/dist/runtime/telemetry.js"],"sourcesContent":["/**\n * Check if the frontendApi ends with a staging domain\n */\nexport function isStaging(frontendApi: string): boolean {\n  return (\n    frontendApi.endsWith('.lclstage.dev') ||\n    frontendApi.endsWith('.stgstage.dev') ||\n    frontendApi.endsWith('.clerkstage.dev') ||\n    frontendApi.endsWith('.accountsstage.dev')\n  );\n}\n","export const isDevelopmentEnvironment = (): boolean => {\n  try {\n    return process.env.NODE_ENV === 'development';\n    // eslint-disable-next-line no-empty\n  } catch {}\n\n  // TODO: add support for import.meta.env.DEV that is being used by vite\n\n  return false;\n};\n\nexport const isTestEnvironment = (): boolean => {\n  try {\n    return process.env.NODE_ENV === 'test';\n    // eslint-disable-next-line no-empty\n  } catch {}\n\n  // TODO: add support for import.meta.env.DEV that is being used by vite\n  return false;\n};\n\nexport const isProductionEnvironment = (): boolean => {\n  try {\n    return process.env.NODE_ENV === 'production';\n    // eslint-disable-next-line no-empty\n  } catch {}\n\n  // TODO: add support for import.meta.env.DEV that is being used by vite\n  return false;\n};\n","type VOrFnReturnsV<T> = T | undefined | ((v: URL) => T);\nexport function handleValueOrFn<T>(value: VOrFnReturnsV<T>, url: URL): T | undefined;\nexport function handleValueOrFn<T>(value: VOrFnReturnsV<T>, url: URL, defaultValue: T): T;\nexport function handleValueOrFn<T>(value: VOrFnReturnsV<T>, url: URL, defaultValue?: unknown): unknown {\n  if (typeof value === 'function') {\n    return (value as (v: URL) => T)(url);\n  }\n\n  if (typeof value !== 'undefined') {\n    return value;\n  }\n\n  if (typeof defaultValue !== 'undefined') {\n    return defaultValue;\n  }\n\n  return undefined;\n}\n","export const noop = (..._args: any[]): void => {\n  // do nothing.\n};\n","import { noop } from './noop';\n\ntype Callback = (val?: any) => void;\n\n/**\n * Create a promise that can be resolved or rejected from\n * outside the Promise constructor callback\n * A ES6 compatible utility that implements `Promise.withResolvers`\n * @internal\n */\nexport const createDeferredPromise = () => {\n  let resolve: Callback = noop;\n  let reject: Callback = noop;\n  const promise = new Promise((res, rej) => {\n    resolve = res;\n    reject = rej;\n  });\n  return { promise, resolve, reject };\n};\n","/**\n * A ES6 compatible utility that implements `Promise.allSettled`\n * @internal\n */\nexport function allSettled<T>(\n  iterable: Iterable<Promise<T>>,\n): Promise<({ status: 'fulfilled'; value: T } | { status: 'rejected'; reason: any })[]> {\n  const promises = Array.from(iterable).map(p =>\n    p.then(\n      value => ({ status: 'fulfilled', value }) as const,\n      reason => ({ status: 'rejected', reason }) as const,\n    ),\n  );\n  return Promise.all(promises);\n}\n","import { isDevelopmentEnvironment } from './runtimeEnvironment';\n\nexport const logErrorInDevMode = (message: string) => {\n  if (isDevelopmentEnvironment()) {\n    console.error(`Clerk: ${message}`);\n  }\n};\n","/**\n * Merges 2 objects without creating new object references\n * The merged props will appear on the `target` object\n * If `target` already has a value for a given key it will not be overwritten\n */\nexport const fastDeepMergeAndReplace = (\n  source: Record<any, any> | undefined | null,\n  target: Record<any, any> | undefined | null,\n) => {\n  if (!source || !target) {\n    return;\n  }\n\n  for (const key in source) {\n    if (Object.prototype.hasOwnProperty.call(source, key) && source[key] !== null && typeof source[key] === `object`) {\n      if (target[key] === undefined) {\n        target[key] = new (Object.getPrototypeOf(source[key]).constructor)();\n      }\n      fastDeepMergeAndReplace(source[key], target[key]);\n    } else if (Object.prototype.hasOwnProperty.call(source, key) && source[key] !== undefined) {\n      target[key] = source[key];\n    }\n  }\n};\n\nexport const fastDeepMergeAndKeep = (\n  source: Record<any, any> | undefined | null,\n  target: Record<any, any> | undefined | null,\n) => {\n  if (!source || !target) {\n    return;\n  }\n\n  for (const key in source) {\n    if (Object.prototype.hasOwnProperty.call(source, key) && source[key] !== null && typeof source[key] === `object`) {\n      if (target[key] === undefined) {\n        target[key] = new (Object.getPrototypeOf(source[key]).constructor)();\n      }\n      fastDeepMergeAndKeep(source[key], target[key]);\n    } else if (Object.prototype.hasOwnProperty.call(source, key) && target[key] === undefined) {\n      target[key] = source[key];\n    }\n  }\n};\n","const require_runtimeEnvironment = require('../runtimeEnvironment-MfBG-86q.js');\nconst require_handleValueOrFn = require('../handleValueOrFn-KR1byaCL.js');\nconst require_noop = require('../noop-Bi5xtB31.js');\nconst require_createDeferredPromise = require('../createDeferredPromise-BgvUcqYv.js');\nconst require_utils = require('../utils-4vju2Zr4.js');\nconst require_instance = require('../instance-CDcvbQik.js');\n\nexports.allSettled = require_utils.allSettled;\nexports.createDeferredPromise = require_createDeferredPromise.createDeferredPromise;\nexports.fastDeepMergeAndKeep = require_utils.fastDeepMergeAndKeep;\nexports.fastDeepMergeAndReplace = require_utils.fastDeepMergeAndReplace;\nexports.handleValueOrFn = require_handleValueOrFn.handleValueOrFn;\nexports.isDevelopmentEnvironment = require_runtimeEnvironment.isDevelopmentEnvironment;\nexports.isProductionEnvironment = require_runtimeEnvironment.isProductionEnvironment;\nexports.isStaging = require_instance.isStaging;\nexports.isTestEnvironment = require_runtimeEnvironment.isTestEnvironment;\nexports.logErrorInDevMode = require_utils.logErrorInDevMode;\nexports.noop = require_noop.noop;","import nextPkg from 'next/package.json';\n\nconst isNext13 = nextPkg.version.startsWith('13.');\n\n/**\n * Those versions are affected by a bundling issue that will break the application if `node:fs` is used inside a server function.\n * The affected versions are >=next@13.5.4 and <=next@14.0.4\n */\nconst isNextWithUnstableServerActions = isNext13 || nextPkg.version.startsWith('14.0');\n\nexport { isNext13, isNextWithUnstableServerActions };\n","import { isDevelopmentEnvironment } from '@clerk/shared/utils';\n\nimport { KEYLESS_DISABLED } from '../server/constants';\nimport { isNextWithUnstableServerActions } from './sdk-versions';\n\nconst canUseKeyless =\n  !isNextWithUnstableServerActions &&\n  // Next.js will inline the value of 'development' or 'production' on the client bundle, so this is client-safe.\n  isDevelopmentEnvironment() &&\n  !KEYLESS_DISABLED;\n\nexport { canUseKeyless };\n","import type { TelemetryEvent } from '../types';\n\ntype TtlInMilliseconds = number;\n\nconst DEFAULT_CACHE_TTL_MS = 86400000; // 24 hours\n\n/**\n * Interface for cache storage used by the telemetry throttler.\n * Implementations can use localStorage, in-memory storage, or any other storage mechanism.\n */\nexport interface ThrottlerCache {\n  getItem(key: string): TtlInMilliseconds | undefined;\n  setItem(key: string, value: TtlInMilliseconds): void;\n  removeItem(key: string): void;\n}\n\n/**\n * Manages throttling for telemetry events using a configurable cache implementation\n * to mitigate event flooding in frequently executed code paths.\n */\nexport class TelemetryEventThrottler {\n  #cache: ThrottlerCache;\n  #cacheTtl = DEFAULT_CACHE_TTL_MS;\n\n  constructor(cache: ThrottlerCache) {\n    this.#cache = cache;\n  }\n\n  isEventThrottled(payload: TelemetryEvent): boolean {\n    const now = Date.now();\n    const key = this.#generateKey(payload);\n    const entry = this.#cache.getItem(key);\n\n    if (!entry) {\n      this.#cache.setItem(key, now);\n      return false;\n    }\n\n    const shouldInvalidate = now - entry > this.#cacheTtl;\n    if (shouldInvalidate) {\n      this.#cache.setItem(key, now);\n      return false;\n    }\n\n    return true;\n  }\n\n  /**\n   * Generates a consistent unique key for telemetry events by sorting payload properties.\n   * This ensures that payloads with identical content in different orders produce the same key.\n   */\n  #generateKey(event: TelemetryEvent): string {\n    const { sk: _sk, pk: _pk, payload, ...rest } = event;\n\n    const sanitizedEvent: Omit<TelemetryEvent, 'sk' | 'pk' | 'payload'> & TelemetryEvent['payload'] = {\n      ...payload,\n      ...rest,\n    };\n\n    return JSON.stringify(\n      Object.keys({\n        ...payload,\n        ...rest,\n      })\n        .sort()\n        .map(key => sanitizedEvent[key]),\n    );\n  }\n}\n\n/**\n * LocalStorage-based cache implementation for browser environments.\n */\nexport class LocalStorageThrottlerCache implements ThrottlerCache {\n  #storageKey = 'clerk_telemetry_throttler';\n\n  getItem(key: string): TtlInMilliseconds | undefined {\n    return this.#getCache()[key];\n  }\n\n  setItem(key: string, value: TtlInMilliseconds): void {\n    try {\n      const cache = this.#getCache();\n      cache[key] = value;\n      localStorage.setItem(this.#storageKey, JSON.stringify(cache));\n    } catch (err: unknown) {\n      const isQuotaExceededError =\n        err instanceof DOMException &&\n        // Check error names for different browsers\n        (err.name === 'QuotaExceededError' || err.name === 'NS_ERROR_DOM_QUOTA_REACHED');\n\n      if (isQuotaExceededError && localStorage.length > 0) {\n        // Clear our cache if quota exceeded\n        localStorage.removeItem(this.#storageKey);\n      }\n    }\n  }\n\n  removeItem(key: string): void {\n    try {\n      const cache = this.#getCache();\n      delete cache[key];\n      localStorage.setItem(this.#storageKey, JSON.stringify(cache));\n    } catch {\n      // Silently fail if we can't remove\n    }\n  }\n\n  #getCache(): Record<string, TtlInMilliseconds> {\n    try {\n      const cacheString = localStorage.getItem(this.#storageKey);\n      if (!cacheString) {\n        return {};\n      }\n      return JSON.parse(cacheString);\n    } catch {\n      return {};\n    }\n  }\n\n  static isSupported(): boolean {\n    return typeof window !== 'undefined' && !!window.localStorage;\n  }\n}\n\n/**\n * In-memory cache implementation for non-browser environments (e.g., React Native).\n */\nexport class InMemoryThrottlerCache implements ThrottlerCache {\n  #cache: Map<string, TtlInMilliseconds> = new Map();\n  #maxSize = 10000; // Defensive limit to prevent memory issues\n\n  getItem(key: string): TtlInMilliseconds | undefined {\n    // Defensive: clear cache if it gets too large\n    if (this.#cache.size > this.#maxSize) {\n      this.#cache.clear();\n      return undefined;\n    }\n\n    return this.#cache.get(key);\n  }\n\n  setItem(key: string, value: TtlInMilliseconds): void {\n    this.#cache.set(key, value);\n  }\n\n  removeItem(key: string): void {\n    this.#cache.delete(key);\n  }\n}\n","/**\n * The `TelemetryCollector` class handles collection of telemetry events from Clerk SDKs. Telemetry is opt-out and can be disabled by setting a CLERK_TELEMETRY_DISABLED environment variable.\n * The `ClerkProvider` also accepts a `telemetry` prop that will be passed to the collector during initialization:.\n *\n * ```jsx\n * <ClerkProvider telemetry={false}>\n *    ...\n * </ClerkProvider>\n * ```\n *\n * For more information, please see the telemetry documentation page: https://clerk.com/docs/telemetry.\n */\nimport { parsePublishableKey } from '../keys';\nimport type {\n  InstanceType,\n  SDKMetadata,\n  TelemetryCollector as TelemetryCollectorInterface,\n  TelemetryEvent,\n  TelemetryEventRaw,\n  TelemetryLogEntry,\n} from '../types';\nimport { isTruthy } from '../underscore';\nimport { InMemoryThrottlerCache, LocalStorageThrottlerCache, TelemetryEventThrottler } from './throttler';\nimport type { TelemetryCollectorOptions } from './types';\n\n/**\n * Local interface for window.Clerk to avoid global type pollution.\n * This is only used within this module and doesn't affect other packages.\n */\ninterface WindowWithClerk extends Window {\n  Clerk?: {\n    constructor?: {\n      sdkMetadata?: SDKMetadata;\n    };\n  };\n}\n\n/**\n * Type guard to check if window.Clerk exists and has the expected structure.\n */\nfunction isWindowClerkWithMetadata(clerk: unknown): clerk is { constructor: { sdkMetadata?: SDKMetadata } } {\n  return (\n    typeof clerk === 'object' && clerk !== null && 'constructor' in clerk && typeof clerk.constructor === 'function'\n  );\n}\n\ntype TelemetryCollectorConfig = Pick<\n  TelemetryCollectorOptions,\n  'samplingRate' | 'disabled' | 'debug' | 'maxBufferSize' | 'perEventSampling'\n> & {\n  endpoint: string;\n};\n\ntype TelemetryMetadata = Required<\n  Pick<TelemetryCollectorOptions, 'clerkVersion' | 'sdk' | 'sdkVersion' | 'publishableKey' | 'secretKey'>\n> & {\n  /**\n   * The instance type, derived from the provided publishableKey.\n   */\n  instanceType: InstanceType;\n};\n\n/**\n * Structure of log data sent to the telemetry endpoint.\n */\ntype TelemetryLogData = {\n  /** Service that generated the log. */\n  sdk: string;\n  /** The version of the SDK where the event originated from. */\n  sdkv: string;\n  /** The version of Clerk where the event originated from. */\n  cv: string;\n  /** Log level (info, warn, error, debug, etc.). */\n  lvl: TelemetryLogEntry['level'];\n  /** Log message. */\n  msg: string;\n  /** Instance ID - optional. */\n  iid?: string;\n  /** Timestamp when log was generated. */\n  ts: string;\n  /** Primary key. */\n  pk: string | null;\n  /** Additional payload for the log. */\n  payload: Record<string, unknown> | null;\n};\n\ntype TelemetryBufferItem = { kind: 'event'; value: TelemetryEvent } | { kind: 'log'; value: TelemetryLogData };\n\n// Accepted log levels for runtime validation\nconst VALID_LOG_LEVELS = new Set<string>(['error', 'warn', 'info', 'debug', 'trace']);\n\nconst DEFAULT_CONFIG: Partial<TelemetryCollectorConfig> = {\n  samplingRate: 1,\n  maxBufferSize: 5,\n  // Production endpoint: https://clerk-telemetry.com\n  // Staging endpoint: https://staging.clerk-telemetry.com\n  // Local: http://localhost:8787\n  endpoint: 'https://clerk-telemetry.com',\n};\n\nexport class TelemetryCollector implements TelemetryCollectorInterface {\n  #config: Required<TelemetryCollectorConfig>;\n  #eventThrottler: TelemetryEventThrottler;\n  #metadata: TelemetryMetadata = {} as TelemetryMetadata;\n  #buffer: TelemetryBufferItem[] = [];\n  #pendingFlush: number | ReturnType<typeof setTimeout> | null = null;\n\n  constructor(options: TelemetryCollectorOptions) {\n    this.#config = {\n      maxBufferSize: options.maxBufferSize ?? DEFAULT_CONFIG.maxBufferSize,\n      samplingRate: options.samplingRate ?? DEFAULT_CONFIG.samplingRate,\n      perEventSampling: options.perEventSampling ?? true,\n      disabled: options.disabled ?? false,\n      debug: options.debug ?? false,\n      endpoint: DEFAULT_CONFIG.endpoint,\n    } as Required<TelemetryCollectorConfig>;\n\n    if (!options.clerkVersion && typeof window === 'undefined') {\n      // N/A in a server environment\n      this.#metadata.clerkVersion = '';\n    } else {\n      this.#metadata.clerkVersion = options.clerkVersion ?? '';\n    }\n\n    // We will try to grab the SDK data lazily when an event is triggered, so it should always be defined once the event is sent.\n    // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n    this.#metadata.sdk = options.sdk!;\n    // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n    this.#metadata.sdkVersion = options.sdkVersion!;\n\n    this.#metadata.publishableKey = options.publishableKey ?? '';\n\n    const parsedKey = parsePublishableKey(options.publishableKey);\n    if (parsedKey) {\n      this.#metadata.instanceType = parsedKey.instanceType;\n    }\n\n    if (options.secretKey) {\n      // Only send the first 16 characters of the secret key to to avoid sending the full key. We can still query against the partial key.\n      this.#metadata.secretKey = options.secretKey.substring(0, 16);\n    }\n\n    // Use LocalStorage cache in browsers where it's supported, otherwise fall back to in-memory cache\n    const cache = LocalStorageThrottlerCache.isSupported()\n      ? new LocalStorageThrottlerCache()\n      : new InMemoryThrottlerCache();\n    this.#eventThrottler = new TelemetryEventThrottler(cache);\n  }\n\n  get isEnabled(): boolean {\n    if (this.#metadata.instanceType !== 'development') {\n      return false;\n    }\n\n    // In browser or client environments, we most likely pass the disabled option to the collector, but in environments\n    // where environment variables are available we also check for `CLERK_TELEMETRY_DISABLED`.\n    if (\n      this.#config.disabled ||\n      (typeof process !== 'undefined' && process.env && isTruthy(process.env.CLERK_TELEMETRY_DISABLED))\n    ) {\n      return false;\n    }\n\n    // navigator.webdriver is a property generally set by headless browsers that are running in an automated testing environment.\n    // Data from these environments is not meaningful for us and has the potential to produce a large volume of events, so we disable\n    // collection in this case. (ref: https://developer.mozilla.org/en-US/docs/Web/API/Navigator/webdriver)\n    if (typeof window !== 'undefined' && !!window?.navigator?.webdriver) {\n      return false;\n    }\n\n    return true;\n  }\n\n  get isDebug(): boolean {\n    return (\n      this.#config.debug ||\n      (typeof process !== 'undefined' && process.env && isTruthy(process.env.CLERK_TELEMETRY_DEBUG))\n    );\n  }\n\n  record(event: TelemetryEventRaw): void {\n    try {\n      const preparedPayload = this.#preparePayload(event.event, event.payload);\n\n      this.#logEvent(preparedPayload.event, preparedPayload);\n\n      if (!this.#shouldRecord(preparedPayload, event.eventSamplingRate)) {\n        return;\n      }\n\n      this.#buffer.push({ kind: 'event', value: preparedPayload });\n\n      this.#scheduleFlush();\n    } catch (error) {\n      console.error('[clerk/telemetry] Error recording telemetry event', error);\n    }\n  }\n\n  /**\n   * Records a telemetry log entry if logging is enabled and not in debug mode.\n   *\n   * @param entry - The telemetry log entry to record.\n   */\n  recordLog(entry: TelemetryLogEntry): void {\n    try {\n      if (!this.#shouldRecordLog(entry)) {\n        return;\n      }\n\n      const levelIsValid = typeof entry?.level === 'string' && VALID_LOG_LEVELS.has(entry.level);\n      const messageIsValid = typeof entry?.message === 'string' && entry.message.trim().length > 0;\n\n      let normalizedTimestamp: Date | null = null;\n      const timestampInput: unknown = (entry as unknown as { timestamp?: unknown })?.timestamp;\n      if (typeof timestampInput === 'number' || typeof timestampInput === 'string') {\n        const candidate = new Date(timestampInput);\n        if (!Number.isNaN(candidate.getTime())) {\n          normalizedTimestamp = candidate;\n        }\n      }\n\n      if (!levelIsValid || !messageIsValid || normalizedTimestamp === null) {\n        if (this.isDebug && typeof console !== 'undefined') {\n          console.warn('[clerk/telemetry] Dropping invalid telemetry log entry', {\n            levelIsValid,\n            messageIsValid,\n            timestampIsValid: normalizedTimestamp !== null,\n          });\n        }\n        return;\n      }\n\n      const sdkMetadata = this.#getSDKMetadata();\n\n      const logData: TelemetryLogData = {\n        sdk: sdkMetadata.name,\n        sdkv: sdkMetadata.version,\n        cv: this.#metadata.clerkVersion ?? '',\n        lvl: entry.level,\n        msg: entry.message,\n        ts: normalizedTimestamp.toISOString(),\n        pk: this.#metadata.publishableKey || null,\n        payload: this.#sanitizeContext(entry.context),\n      };\n\n      this.#buffer.push({ kind: 'log', value: logData });\n\n      this.#scheduleFlush();\n    } catch (error) {\n      console.error('[clerk/telemetry] Error recording telemetry log entry', error);\n    }\n  }\n\n  #shouldRecord(preparedPayload: TelemetryEvent, eventSamplingRate?: number) {\n    return this.isEnabled && !this.isDebug && this.#shouldBeSampled(preparedPayload, eventSamplingRate);\n  }\n\n  #shouldRecordLog(_entry: TelemetryLogEntry): boolean {\n    // Always allow logs from debug logger to be sent. Debug logger itself is already gated elsewhere.\n    return true;\n  }\n\n  #shouldBeSampled(preparedPayload: TelemetryEvent, eventSamplingRate?: number) {\n    const randomSeed = Math.random();\n\n    const toBeSampled =\n      randomSeed <= this.#config.samplingRate &&\n      (this.#config.perEventSampling === false ||\n        typeof eventSamplingRate === 'undefined' ||\n        randomSeed <= eventSamplingRate);\n\n    if (!toBeSampled) {\n      return false;\n    }\n\n    return !this.#eventThrottler.isEventThrottled(preparedPayload);\n  }\n\n  #scheduleFlush(): void {\n    // On the server, we want to flush immediately as we have less guarantees about the lifecycle of the process\n    if (typeof window === 'undefined') {\n      this.#flush();\n      return;\n    }\n    const isBufferFull = this.#buffer.length >= this.#config.maxBufferSize;\n    if (isBufferFull) {\n      // If the buffer is full, flush immediately to make sure we minimize the chance of event loss.\n      // Cancel any pending flushes as we're going to flush immediately\n      if (this.#pendingFlush) {\n        if (typeof cancelIdleCallback !== 'undefined') {\n          cancelIdleCallback(Number(this.#pendingFlush));\n        } else {\n          clearTimeout(Number(this.#pendingFlush));\n        }\n      }\n      this.#flush();\n      return;\n    }\n\n    // If we have a pending flush, do nothing\n    if (this.#pendingFlush) {\n      return;\n    }\n\n    if ('requestIdleCallback' in window) {\n      this.#pendingFlush = requestIdleCallback(() => {\n        this.#flush();\n        this.#pendingFlush = null;\n      });\n    } else {\n      // This is not an ideal solution, but it at least waits until the next tick\n      this.#pendingFlush = setTimeout(() => {\n        this.#flush();\n        this.#pendingFlush = null;\n      }, 0);\n    }\n  }\n\n  #flush(): void {\n    // Capture the current buffer and clear it immediately to avoid closure references\n    const itemsToSend = [...this.#buffer];\n    this.#buffer = [];\n\n    this.#pendingFlush = null;\n\n    if (itemsToSend.length === 0) {\n      return;\n    }\n\n    const eventsToSend = itemsToSend\n      .filter(item => item.kind === 'event')\n      .map(item => (item as { kind: 'event'; value: TelemetryEvent }).value);\n\n    const logsToSend = itemsToSend\n      .filter(item => item.kind === 'log')\n      .map(item => (item as { kind: 'log'; value: TelemetryLogData }).value);\n\n    if (eventsToSend.length > 0) {\n      const eventsUrl = new URL('/v1/event', this.#config.endpoint);\n      fetch(eventsUrl, {\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        keepalive: true,\n        method: 'POST',\n        // TODO: We send an array here with that idea that we can eventually send multiple events.\n        body: JSON.stringify({ events: eventsToSend }),\n      }).catch(() => void 0);\n    }\n\n    if (logsToSend.length > 0) {\n      const logsUrl = new URL('/v1/logs', this.#config.endpoint);\n      fetch(logsUrl, {\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        keepalive: true,\n        method: 'POST',\n        body: JSON.stringify({ logs: logsToSend }),\n      }).catch(() => void 0);\n    }\n  }\n\n  /**\n   * If running in debug mode, log the event and its payload to the console.\n   */\n  #logEvent(event: TelemetryEvent['event'], payload: Record<string, any>) {\n    if (!this.isDebug) {\n      return;\n    }\n\n    if (typeof console.groupCollapsed !== 'undefined') {\n      console.groupCollapsed('[clerk/telemetry]', event);\n      console.log(payload);\n      console.groupEnd();\n    } else {\n      console.log('[clerk/telemetry]', event, payload);\n    }\n  }\n\n  /**\n   * If in browser, attempt to lazily grab the SDK metadata from the Clerk singleton, otherwise fallback to the initially passed in values.\n   *\n   * This is necessary because the sdkMetadata can be set by the host SDK after the TelemetryCollector is instantiated.\n   */\n  #getSDKMetadata() {\n    const sdkMetadata = {\n      name: this.#metadata.sdk,\n      version: this.#metadata.sdkVersion,\n    };\n\n    if (typeof window !== 'undefined') {\n      const windowWithClerk = window as WindowWithClerk;\n\n      if (windowWithClerk.Clerk) {\n        const windowClerk = windowWithClerk.Clerk;\n\n        if (isWindowClerkWithMetadata(windowClerk) && windowClerk.constructor.sdkMetadata) {\n          const { name, version } = windowClerk.constructor.sdkMetadata;\n\n          if (name !== undefined) {\n            sdkMetadata.name = name;\n          }\n          if (version !== undefined) {\n            sdkMetadata.version = version;\n          }\n        }\n      }\n    }\n\n    return sdkMetadata;\n  }\n\n  /**\n   * Append relevant metadata from the Clerk singleton to the event payload.\n   */\n  #preparePayload(event: TelemetryEvent['event'], payload: TelemetryEvent['payload']): TelemetryEvent {\n    const sdkMetadata = this.#getSDKMetadata();\n\n    return {\n      event,\n      cv: this.#metadata.clerkVersion ?? '',\n      it: this.#metadata.instanceType ?? '',\n      sdk: sdkMetadata.name,\n      sdkv: sdkMetadata.version,\n      ...(this.#metadata.publishableKey ? { pk: this.#metadata.publishableKey } : {}),\n      ...(this.#metadata.secretKey ? { sk: this.#metadata.secretKey } : {}),\n      payload,\n    };\n  }\n\n  /**\n   * Best-effort sanitization of the context payload. Returns a plain object with JSON-serializable\n   * values or null when the input is missing or not serializable. Arrays are not accepted.\n   */\n  #sanitizeContext(context: unknown): Record<string, unknown> | null {\n    if (context === null || typeof context === 'undefined') {\n      return null;\n    }\n    if (typeof context !== 'object') {\n      return null;\n    }\n    try {\n      const cleaned = JSON.parse(JSON.stringify(context));\n      if (cleaned && typeof cleaned === 'object' && !Array.isArray(cleaned)) {\n        return cleaned as Record<string, unknown>;\n      }\n      return null;\n    } catch {\n      return null;\n    }\n  }\n}\n","import type { TelemetryEventRaw } from '../../types';\n\nconst EVENT_COMPONENT_MOUNTED = 'COMPONENT_MOUNTED';\nconst EVENT_COMPONENT_OPENED = 'COMPONENT_OPENED';\nconst EVENT_SAMPLING_RATE = 0.1;\n\n/** Increase sampling for high-signal auth components on mount. */\nconst AUTH_COMPONENTS = new Set<string>(['SignIn', 'SignUp']);\n\n/**\n * Returns the per-event sampling rate for component-mounted telemetry events.\n * Uses a higher rate for SignIn/SignUp to improve signal quality.\n *\n *  @internal\n */\nfunction getComponentMountedSamplingRate(component: string): number {\n  return AUTH_COMPONENTS.has(component) ? 1 : EVENT_SAMPLING_RATE;\n}\n\ntype ComponentMountedBase = {\n  component: string;\n};\n\ntype EventPrebuiltComponent = ComponentMountedBase & {\n  appearanceProp: boolean;\n  elements: boolean;\n  variables: boolean;\n  baseTheme: boolean;\n};\n\ntype EventComponentMounted = ComponentMountedBase & TelemetryEventRaw['payload'];\n\n/**\n * Factory for prebuilt component telemetry events.\n *\n * @internal\n */\nfunction createPrebuiltComponentEvent(event: typeof EVENT_COMPONENT_MOUNTED | typeof EVENT_COMPONENT_OPENED) {\n  return function (\n    component: string,\n    props?: Record<string, any>,\n    additionalPayload?: TelemetryEventRaw['payload'],\n  ): TelemetryEventRaw<EventPrebuiltComponent> {\n    return {\n      event,\n      eventSamplingRate:\n        event === EVENT_COMPONENT_MOUNTED ? getComponentMountedSamplingRate(component) : EVENT_SAMPLING_RATE,\n      payload: {\n        component,\n        appearanceProp: Boolean(props?.appearance),\n        baseTheme: Boolean(props?.appearance?.baseTheme),\n        elements: Boolean(props?.appearance?.elements),\n        variables: Boolean(props?.appearance?.variables),\n        ...additionalPayload,\n      },\n    };\n  };\n}\n\n/**\n * Helper function for `telemetry.record()`. Create a consistent event object for when a prebuilt (AIO) component is mounted.\n *\n * @param component - The name of the component.\n * @param props - The props passed to the component. Will be filtered to a known list of props.\n * @param additionalPayload - Additional data to send with the event.\n * @example\n * telemetry.record(eventPrebuiltComponentMounted('SignUp', props));\n */\nexport function eventPrebuiltComponentMounted(\n  component: string,\n  props?: Record<string, any>,\n  additionalPayload?: TelemetryEventRaw['payload'],\n): TelemetryEventRaw<EventPrebuiltComponent> {\n  return createPrebuiltComponentEvent(EVENT_COMPONENT_MOUNTED)(component, props, additionalPayload);\n}\n\n/**\n * Helper function for `telemetry.record()`. Create a consistent event object for when a prebuilt (AIO) component is opened as a modal.\n *\n * @param component - The name of the component.\n * @param props - The props passed to the component. Will be filtered to a known list of props.\n * @param additionalPayload - Additional data to send with the event.\n * @example\n * telemetry.record(eventPrebuiltComponentOpened('GoogleOneTap', props));\n */\nexport function eventPrebuiltComponentOpened(\n  component: string,\n  props?: Record<string, any>,\n  additionalPayload?: TelemetryEventRaw['payload'],\n): TelemetryEventRaw<EventPrebuiltComponent> {\n  return createPrebuiltComponentEvent(EVENT_COMPONENT_OPENED)(component, props, additionalPayload);\n}\n\n/**\n * Helper function for `telemetry.record()`. Create a consistent event object for when a component is mounted. Use `eventPrebuiltComponentMounted` for prebuilt components.\n *\n * **Caution:** Filter the `props` you pass to this function to avoid sending too much data.\n *\n * @param component - The name of the component.\n * @param props - The props passed to the component. Ideally you only pass a handful of props here.\n * @example\n * telemetry.record(eventComponentMounted('SignUp', props));\n */\nexport function eventComponentMounted(\n  component: string,\n  props: TelemetryEventRaw['payload'] = {},\n): TelemetryEventRaw<EventComponentMounted> {\n  return {\n    event: EVENT_COMPONENT_MOUNTED,\n    eventSamplingRate: getComponentMountedSamplingRate(component),\n    payload: {\n      component,\n      ...props,\n    },\n  };\n}\n","import type { TelemetryEventRaw } from '../../types';\n\nconst EVENT_METHOD_CALLED = 'METHOD_CALLED';\nconst EVENT_SAMPLING_RATE = 0.1;\n\ntype EventMethodCalled = {\n  method: string;\n} & Record<string, string | number | boolean>;\n\n/**\n * Fired when a helper method is called from a Clerk SDK.\n */\nexport function eventMethodCalled(\n  method: string,\n  payload?: Record<string, unknown>,\n): TelemetryEventRaw<EventMethodCalled> {\n  return {\n    event: EVENT_METHOD_CALLED,\n    eventSamplingRate: EVENT_SAMPLING_RATE,\n    payload: {\n      method,\n      ...payload,\n    },\n  };\n}\n","import type { TelemetryEventRaw } from '../../types';\n\nconst EVENT_FRAMEWORK_METADATA = 'FRAMEWORK_METADATA';\nconst EVENT_SAMPLING_RATE = 0.1;\n\ntype EventFrameworkMetadata = Record<string, string | number | boolean>;\n\n/**\n * Fired when a helper method is called from a Clerk SDK.\n */\nexport function eventFrameworkMetadata(payload: EventFrameworkMetadata): TelemetryEventRaw<EventFrameworkMetadata> {\n  return {\n    event: EVENT_FRAMEWORK_METADATA,\n    eventSamplingRate: EVENT_SAMPLING_RATE,\n    payload,\n  };\n}\n","import type { Appearance, BaseTheme, TelemetryEventRaw } from '../../types';\n\nexport const EVENT_THEME_USAGE = 'THEME_USAGE';\nexport const EVENT_SAMPLING_RATE = 1;\n\ntype EventThemeUsage = {\n  /**\n   * The name of the theme being used (e.g., \"shadcn\", \"neobrutalism\", etc.).\n   */\n  themeName?: string;\n};\n\n/**\n * Helper function for `telemetry.record()`. Create a consistent event object for tracking theme usage in ClerkProvider.\n *\n * @param appearance - The appearance prop from ClerkProvider.\n * @example\n * telemetry.record(eventThemeUsage(appearance));\n */\nexport function eventThemeUsage(appearance?: Appearance): TelemetryEventRaw<EventThemeUsage> {\n  const payload = analyzeThemeUsage(appearance);\n\n  return {\n    event: EVENT_THEME_USAGE,\n    eventSamplingRate: EVENT_SAMPLING_RATE,\n    payload,\n  };\n}\n\n/**\n * Analyzes the appearance prop to extract theme usage information for telemetry.\n *\n * @internal\n */\nfunction analyzeThemeUsage(appearance?: Appearance): EventThemeUsage {\n  if (!appearance || typeof appearance !== 'object') {\n    return {};\n  }\n\n  // Prioritize the new theme property over deprecated baseTheme\n  const themeProperty = appearance.theme || appearance.baseTheme;\n\n  if (!themeProperty) {\n    return {};\n  }\n\n  let themeName: string | undefined;\n\n  if (Array.isArray(themeProperty)) {\n    // Look for the first identifiable theme name in the array\n    for (const theme of themeProperty) {\n      const name = extractThemeName(theme);\n      if (name) {\n        themeName = name;\n        break;\n      }\n    }\n  } else {\n    themeName = extractThemeName(themeProperty);\n  }\n\n  return { themeName };\n}\n\n/**\n * Extracts the theme name from a theme object.\n *\n * @internal\n */\nfunction extractThemeName(theme: BaseTheme): string | undefined {\n  if (typeof theme === 'string') {\n    return theme;\n  }\n\n  if (typeof theme === 'object' && theme !== null) {\n    // Check for explicit theme name\n    if ('name' in theme && typeof theme.name === 'string') {\n      return theme.name;\n    }\n  }\n\n  return undefined;\n}\n","require('./constants-B8tEdUlH.js');\nrequire('./isomorphicAtob-Chnw1Md3.js');\nrequire('./isomorphicBtoa-oWNvIgSP.js');\nrequire('./keys-wr08qE7Y.js');\nrequire('./underscore-C7r5Yoz7.js');\nconst require_telemetry = require('./telemetry-DKa_Z2f1.js');\n\nexports.EVENT_SAMPLING_RATE = require_telemetry.EVENT_SAMPLING_RATE;\nexports.EVENT_THEME_USAGE = require_telemetry.EVENT_THEME_USAGE;\nexports.TelemetryCollector = require_telemetry.TelemetryCollector;\nexports.eventComponentMounted = require_telemetry.eventComponentMounted;\nexports.eventFrameworkMetadata = require_telemetry.eventFrameworkMetadata;\nexports.eventMethodCalled = require_telemetry.eventMethodCalled;\nexports.eventPrebuiltComponentMounted = require_telemetry.eventPrebuiltComponentMounted;\nexports.eventPrebuiltComponentOpened = require_telemetry.eventPrebuiltComponentOpened;\nexports.eventThemeUsage = require_telemetry.eventThemeUsage;"],"names":["resolve: Callback","noop","reject: Callback","isDevelopmentEnvironment","nextPkg","#cache","#generateKey","#cacheTtl","sanitizedEvent: Omit<TelemetryEvent, 'sk' | 'pk' | 'payload'> & TelemetryEvent['payload']","#getCache","#storageKey","err: unknown","#maxSize","DEFAULT_CONFIG: Partial<TelemetryCollectorConfig>","#config","#metadata","parsePublishableKey","#eventThrottler","isTruthy","#preparePayload","#logEvent","#shouldRecord","#buffer","#scheduleFlush","#shouldRecordLog","normalizedTimestamp: Date | null","timestampInput: unknown","#getSDKMetadata","logData: TelemetryLogData","#sanitizeContext","#shouldBeSampled","#flush","#pendingFlush","EVENT_SAMPLING_RATE","themeName: string | undefined"],"mappings":"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","ignoreList":[8,17]}