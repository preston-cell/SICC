{"version":3,"sources":["../../../../app/documents/generate/%5BestatePlanId%5D/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useParams, useSearchParams } from \"next/navigation\";\nimport { useQuery, useMutation } from \"convex/react\";\nimport { api } from \"../../../../convex/_generated/api\";\nimport { Id } from \"../../../../convex/_generated/dataModel\";\nimport Link from \"next/link\";\nimport { useState, useCallback, useRef } from \"react\";\nimport ReactMarkdown from \"react-markdown\";\n\ntype DocumentType = \"will\" | \"trust\" | \"poa_financial\" | \"poa_healthcare\" | \"healthcare_directive\" | \"hipaa\";\n\nconst DOCUMENT_TYPES: Array<{\n  type: DocumentType;\n  name: string;\n  description: string;\n  estimatedTime: string;\n  icon: React.ReactNode;\n}> = [\n  {\n    type: \"will\",\n    name: \"Last Will & Testament\",\n    description: \"Specify how your assets should be distributed after death and name guardians for minor children\",\n    estimatedTime: \"2-3 minutes\",\n    icon: (\n      <svg className=\"w-8 h-8\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\" />\n      </svg>\n    ),\n  },\n  {\n    type: \"trust\",\n    name: \"Revocable Living Trust\",\n    description: \"Avoid probate and maintain privacy for your estate with a flexible trust\",\n    estimatedTime: \"3-4 minutes\",\n    icon: (\n      <svg className=\"w-8 h-8\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4\" />\n      </svg>\n    ),\n  },\n  {\n    type: \"poa_financial\",\n    name: \"Financial Power of Attorney\",\n    description: \"Authorize someone to manage your finances if you become incapacitated\",\n    estimatedTime: \"1-2 minutes\",\n    icon: (\n      <svg className=\"w-8 h-8\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z\" />\n      </svg>\n    ),\n  },\n  {\n    type: \"poa_healthcare\",\n    name: \"Healthcare Power of Attorney\",\n    description: \"Designate someone to make medical decisions on your behalf\",\n    estimatedTime: \"1-2 minutes\",\n    icon: (\n      <svg className=\"w-8 h-8\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z\" />\n      </svg>\n    ),\n  },\n  {\n    type: \"healthcare_directive\",\n    name: \"Healthcare Directive / Living Will\",\n    description: \"Document your wishes for end-of-life medical treatment\",\n    estimatedTime: \"2-3 minutes\",\n    icon: (\n      <svg className=\"w-8 h-8\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01\" />\n      </svg>\n    ),\n  },\n  {\n    type: \"hipaa\",\n    name: \"HIPAA Authorization\",\n    description: \"Allow designated individuals to access your medical information\",\n    estimatedTime: \"1 minute\",\n    icon: (\n      <svg className=\"w-8 h-8\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z\" />\n      </svg>\n    ),\n  },\n];\n\ninterface GenerationState {\n  isGenerating: boolean;\n  generatingType: DocumentType | null;\n  error: string | null;\n}\n\ninterface PreviewState {\n  isOpen: boolean;\n  title: string;\n  content: string;\n  documentId: string | null;\n}\n\nexport default function DocumentGeneratePage() {\n  const params = useParams();\n  const searchParams = useSearchParams();\n  const estatePlanId = params.estatePlanId as Id<\"estatePlans\">;\n  const highlightType = searchParams.get(\"type\");\n\n  // State\n  const [generationState, setGenerationState] = useState<GenerationState>({\n    isGenerating: false,\n    generatingType: null,\n    error: null,\n  });\n  const [previewState, setPreviewState] = useState<PreviewState>({\n    isOpen: false,\n    title: \"\",\n    content: \"\",\n    documentId: null,\n  });\n  const [useAI, setUseAI] = useState(false);\n  const [isGeneratingPDF, setIsGeneratingPDF] = useState(false);\n  const pdfContentRef = useRef<HTMLDivElement>(null);\n\n  // Fetch estate plan\n  const estatePlan = useQuery(api.queries.getEstatePlan, { estatePlanId });\n\n  // Fetch existing documents\n  const existingDocs = useQuery(api.queries.getDocuments, { estatePlanId });\n\n  // Fetch gap analysis for recommendations\n  const gapAnalysis = useQuery(api.queries.getLatestGapAnalysis, { estatePlanId });\n\n  // Fetch intake progress\n  const intakeProgress = useQuery(api.queries.getIntakeProgress, { estatePlanId });\n\n  // Fetch full intake data for API call\n  const intakeData = useQuery(api.queries.getEstatePlanFull, { estatePlanId });\n\n  // Mutation to save generated document\n  const createDocument = useMutation(api.estatePlanning.createDocument);\n\n  // Parse missing documents from gap analysis\n  const missingDocTypes = new Set<string>();\n  if (gapAnalysis?.missingDocuments) {\n    try {\n      const missing = JSON.parse(gapAnalysis.missingDocuments);\n      missing.forEach((doc: { type: string }) => missingDocTypes.add(doc.type));\n    } catch {\n      // Ignore parse errors\n    }\n  }\n\n  // Handle document generation - calls API directly (bypasses Convex timeout)\n  const handleGenerate = useCallback(async (docType: DocumentType) => {\n    setGenerationState({\n      isGenerating: true,\n      generatingType: docType,\n      error: null,\n    });\n\n    try {\n      // Build intake data object for the API\n      // Note: intakeData from getEstatePlanFull has the intake array at .intakeData\n      const intake = intakeData?.intakeData || [];\n      const apiIntakeData = {\n        personal: intake.find((i: { section: string; data: string }) => i.section === \"personal\")?.data\n          ? JSON.parse(intake.find((i: { section: string }) => i.section === \"personal\")?.data || \"{}\")\n          : {},\n        family: intake.find((i: { section: string; data: string }) => i.section === \"family\")?.data\n          ? JSON.parse(intake.find((i: { section: string }) => i.section === \"family\")?.data || \"{}\")\n          : {},\n        assets: intake.find((i: { section: string; data: string }) => i.section === \"assets\")?.data\n          ? JSON.parse(intake.find((i: { section: string }) => i.section === \"assets\")?.data || \"{}\")\n          : {},\n        goals: intake.find((i: { section: string; data: string }) => i.section === \"goals\")?.data\n          ? JSON.parse(intake.find((i: { section: string }) => i.section === \"goals\")?.data || \"{}\")\n          : {},\n      };\n\n      // Call the API route directly (bypasses Convex timeout issues)\n      const response = await fetch(\"/api/document-generation\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ documentType: docType, intakeData: apiIntakeData }),\n      });\n\n      const result = await response.json();\n\n      if (!result.success) {\n        setGenerationState(prev => ({\n          ...prev,\n          error: result.error || \"Failed to generate document\",\n        }));\n        return;\n      }\n\n      // Save the document to Convex\n      const docInfo = DOCUMENT_TYPES.find(d => d.type === docType);\n      const documentId = await createDocument({\n        estatePlanId,\n        type: docType,\n        title: docInfo?.name || \"Generated Document\",\n        content: result.content,\n        format: \"markdown\",\n      });\n\n      setPreviewState({\n        isOpen: true,\n        title: docInfo?.name || \"Generated Document\",\n        content: result.content,\n        documentId: documentId || null,\n      });\n    } catch (error) {\n      setGenerationState(prev => ({\n        ...prev,\n        error: error instanceof Error ? error.message : \"An error occurred\",\n      }));\n    } finally {\n      setGenerationState(prev => ({\n        ...prev,\n        isGenerating: false,\n        generatingType: null,\n      }));\n    }\n  }, [estatePlanId, intakeData, createDocument]);\n\n  // Handle download\n  const handleDownload = useCallback(() => {\n    const blob = new Blob([previewState.content], { type: \"text/markdown\" });\n    const url = URL.createObjectURL(blob);\n    const a = document.createElement(\"a\");\n    a.href = url;\n    a.download = `${previewState.title.replace(/\\s+/g, \"_\")}.md`;\n    document.body.appendChild(a);\n    a.click();\n    document.body.removeChild(a);\n    URL.revokeObjectURL(url);\n  }, [previewState.content, previewState.title]);\n\n  // Copy to clipboard\n  const handleCopy = useCallback(async () => {\n    try {\n      await navigator.clipboard.writeText(previewState.content);\n      // Could add a toast notification here\n    } catch (error) {\n      console.error(\"Failed to copy:\", error);\n    }\n  }, [previewState.content]);\n\n  // Download as PDF\n  const handleDownloadPDF = useCallback(async () => {\n    if (!pdfContentRef.current) return;\n\n    setIsGeneratingPDF(true);\n    try {\n      // Dynamically import html2pdf to avoid SSR issues\n      const html2pdfModule = await import(\"html2pdf.js\");\n      const html2pdf = html2pdfModule.default;\n\n      const element = pdfContentRef.current;\n      const filename = `${previewState.title.replace(/\\s+/g, \"_\")}.pdf`;\n\n      // Temporarily apply print-friendly styles for PDF generation\n      const originalStyle = element.getAttribute(\"style\") || \"\";\n      element.style.cssText = `\n        background-color: white !important;\n        color: black !important;\n        font-family: 'Times New Roman', Times, serif !important;\n        font-size: 12pt !important;\n        line-height: 1.6 !important;\n        padding: 0 !important;\n      `;\n\n      // Apply styles to all child elements\n      const allElements = element.querySelectorAll(\"*\");\n      const originalStyles: string[] = [];\n      allElements.forEach((el, index) => {\n        const htmlEl = el as HTMLElement;\n        originalStyles[index] = htmlEl.getAttribute(\"style\") || \"\";\n        htmlEl.style.color = \"black\";\n        htmlEl.style.backgroundColor = \"transparent\";\n      });\n\n      // Style headings specifically\n      element.querySelectorAll(\"h1, h2, h3, h4, h5, h6\").forEach((heading) => {\n        const h = heading as HTMLElement;\n        h.style.fontWeight = \"bold\";\n        h.style.marginTop = \"1em\";\n        h.style.marginBottom = \"0.5em\";\n      });\n\n      element.querySelectorAll(\"h1\").forEach((h) => {\n        (h as HTMLElement).style.fontSize = \"18pt\";\n      });\n      element.querySelectorAll(\"h2\").forEach((h) => {\n        (h as HTMLElement).style.fontSize = \"16pt\";\n      });\n      element.querySelectorAll(\"h3\").forEach((h) => {\n        (h as HTMLElement).style.fontSize = \"14pt\";\n      });\n\n      const opt = {\n        margin: [0.75, 0.75, 0.75, 0.75] as [number, number, number, number],\n        filename,\n        image: { type: \"jpeg\" as const, quality: 0.98 },\n        html2canvas: { scale: 2, useCORS: true, logging: false, backgroundColor: \"#ffffff\" },\n        jsPDF: { unit: \"in\", format: \"letter\", orientation: \"portrait\" as const },\n        pagebreak: { mode: [\"avoid-all\", \"css\", \"legacy\"] },\n      };\n\n      await html2pdf().set(opt).from(element).save();\n\n      // Restore original styles\n      element.setAttribute(\"style\", originalStyle);\n      allElements.forEach((el, index) => {\n        const htmlEl = el as HTMLElement;\n        if (originalStyles[index]) {\n          htmlEl.setAttribute(\"style\", originalStyles[index]);\n        } else {\n          htmlEl.removeAttribute(\"style\");\n        }\n      });\n    } catch (error) {\n      console.error(\"Failed to generate PDF:\", error);\n    } finally {\n      setIsGeneratingPDF(false);\n    }\n  }, [previewState.title]);\n\n  if (!estatePlan) {\n    return (\n      <div className=\"min-h-screen bg-white flex items-center justify-center\">\n        <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-[var(--accent-purple)]\"></div>\n      </div>\n    );\n  }\n\n  const hasEnoughData = intakeProgress && intakeProgress.percentComplete >= 40;\n\n  return (\n    <div className=\"min-h-screen bg-white\">\n      {/* Header */}\n      <header className=\"bg-white shadow-sm border-b border-[var(--border)]\">\n        <div className=\"max-w-4xl mx-auto px-4 py-4 flex items-center justify-between\">\n          <Link\n            href=\"/\"\n            className=\"text-xl font-bold text-[var(--text-heading)] hover:text-[var(--accent-purple)] transition-colors\"\n          >\n            Estate Planning Assistant\n          </Link>\n          <Link\n            href={`/analysis/${estatePlanId}`}\n            className=\"text-sm text-[var(--text-muted)] hover:text-[var(--text-body)]\"\n          >\n            Back to Analysis\n          </Link>\n        </div>\n      </header>\n\n      <main className=\"max-w-4xl mx-auto px-4 py-8\">\n        {/* Page Header */}\n        <div className=\"mb-8\">\n          <h1 className=\"text-3xl font-bold text-[var(--text-heading)]\">\n            Generate Documents\n          </h1>\n          <p className=\"text-[var(--text-body)] mt-2\">\n            Select a document type to generate a customized draft based on your information.\n          </p>\n        </div>\n\n        {/* Progress Warning */}\n        {!hasEnoughData && (\n          <div className=\"mb-6 bg-[var(--warning-muted)] border border-[var(--warning)] rounded-lg p-4\">\n            <div className=\"flex gap-3\">\n              <svg className=\"w-5 h-5 text-[var(--warning)] flex-shrink-0 mt-0.5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z\" />\n              </svg>\n              <div>\n                <h3 className=\"font-medium text-[var(--warning)]\">More Information Needed</h3>\n                <p className=\"text-sm text-[var(--warning)] mt-1\">\n                  Your intake questionnaire is only {intakeProgress?.percentComplete || 0}% complete.\n                  Documents generated with incomplete information will have placeholder values.{\" \"}\n                  <Link href={`/intake/${estatePlanId}`} className=\"underline hover:no-underline\">\n                    Complete the questionnaire\n                  </Link>{\" \"}\n                  for better results.\n                </p>\n              </div>\n            </div>\n          </div>\n        )}\n\n        {/* AI Enhancement Toggle */}\n        <div className=\"mb-6 bg-white border border-[var(--border)] rounded-lg shadow-sm p-4\">\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <h3 className=\"font-medium text-[var(--text-heading)]\">AI-Enhanced Generation</h3>\n              <p className=\"text-sm text-[var(--text-muted)]\">\n                Use Claude AI to generate more detailed and customized documents\n              </p>\n            </div>\n            <button\n              onClick={() => setUseAI(!useAI)}\n              className={`\n                relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent\n                transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-[var(--accent-purple)] focus:ring-offset-2\n                ${useAI ? \"bg-[var(--accent-purple)]\" : \"bg-[var(--light-gray)]\"}\n              `}\n            >\n              <span\n                className={`\n                  pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0\n                  transition duration-200 ease-in-out\n                  ${useAI ? \"translate-x-5\" : \"translate-x-0\"}\n                `}\n              />\n            </button>\n          </div>\n        </div>\n\n        {/* Error Display */}\n        {generationState.error && (\n          <div className=\"mb-6 bg-[var(--error-muted)] border border-[var(--error)] rounded-lg p-4\">\n            <div className=\"flex gap-3\">\n              <svg className=\"w-5 h-5 text-[var(--error)] flex-shrink-0 mt-0.5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\" />\n              </svg>\n              <div>\n                <h3 className=\"font-medium text-[var(--error)]\">Generation Error</h3>\n                <p className=\"text-sm text-[var(--error)] mt-1\">{generationState.error}</p>\n              </div>\n            </div>\n          </div>\n        )}\n\n        {/* Document Types Grid */}\n        <div className=\"grid md:grid-cols-2 gap-4\">\n          {DOCUMENT_TYPES.map((doc) => {\n            const isRecommended = missingDocTypes.has(doc.type);\n            const isHighlighted = highlightType === doc.type;\n            const existingDoc = existingDocs?.find((d) => d.type === doc.type);\n            const isGenerating = generationState.isGenerating && generationState.generatingType === doc.type;\n\n            return (\n              <div\n                key={doc.type}\n                className={`\n                  bg-white rounded-lg shadow-sm p-6 border-2 transition-all hover:shadow-md\n                  ${isHighlighted\n                    ? \"border-[var(--accent-purple)] ring-2 ring-[var(--accent-muted)]\"\n                    : isRecommended\n                      ? \"border-[var(--error)]\"\n                      : \"border-[var(--border)]\"\n                  }\n                `}\n              >\n                <div className=\"flex items-start gap-4\">\n                  <div className={`flex-shrink-0 ${isRecommended ? \"text-[var(--error)]\" : \"text-[var(--accent-purple)]\"}`}>\n                    {doc.icon}\n                  </div>\n                  <div className=\"flex-1\">\n                    <div className=\"flex items-center gap-2 flex-wrap\">\n                      <h3 className=\"font-semibold text-[var(--text-heading)]\">\n                        {doc.name}\n                      </h3>\n                      {isRecommended && (\n                        <span className=\"text-xs px-2 py-0.5 bg-[var(--error-muted)] text-[var(--error)] rounded-full\">\n                          Recommended\n                        </span>\n                      )}\n                      {existingDoc && (\n                        <span className=\"text-xs px-2 py-0.5 bg-[var(--success-muted)] text-[var(--success)] rounded-full\">\n                          Draft v{existingDoc.version}\n                        </span>\n                      )}\n                    </div>\n                    <p className=\"text-sm text-[var(--text-body)] mt-1\">\n                      {doc.description}\n                    </p>\n                    <p className=\"text-xs text-[var(--text-muted)] mt-1\">\n                      Est. time: {doc.estimatedTime}\n                    </p>\n                    <div className=\"mt-4 flex gap-2\">\n                      <button\n                        onClick={() => handleGenerate(doc.type)}\n                        disabled={generationState.isGenerating}\n                        className={`\n                          px-4 py-2 rounded-lg text-sm font-medium transition-colors\n                          ${isGenerating\n                            ? \"bg-[var(--accent-muted)] text-[var(--accent-purple)] cursor-wait\"\n                            : generationState.isGenerating\n                              ? \"bg-[var(--light-gray)] text-[var(--text-muted)] cursor-not-allowed\"\n                              : \"bg-[var(--accent-purple)] hover:opacity-90 text-white\"\n                          }\n                        `}\n                      >\n                        {isGenerating ? (\n                          <span className=\"flex items-center gap-2\">\n                            <svg className=\"animate-spin h-4 w-4\" fill=\"none\" viewBox=\"0 0 24 24\">\n                              <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\" />\n                              <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\" />\n                            </svg>\n                            Generating...\n                          </span>\n                        ) : existingDoc ? (\n                          \"Regenerate\"\n                        ) : (\n                          \"Generate\"\n                        )}\n                      </button>\n                      {existingDoc && (\n                        <button\n                          onClick={() => {\n                            setPreviewState({\n                              isOpen: true,\n                              title: existingDoc.title,\n                              content: existingDoc.content,\n                              documentId: existingDoc._id,\n                            });\n                          }}\n                          className=\"px-4 py-2 bg-[var(--off-white)] text-[var(--text-body)] hover:bg-[var(--light-gray)] rounded-lg text-sm font-medium transition-colors\"\n                        >\n                          View Draft\n                        </button>\n                      )}\n                    </div>\n                  </div>\n                </div>\n              </div>\n            );\n          })}\n        </div>\n\n        {/* Disclaimer */}\n        <div className=\"mt-8 bg-[var(--warning-muted)] border border-[var(--warning)] rounded-lg p-4\">\n          <p className=\"text-sm text-[var(--warning)]\">\n            <strong>Disclaimer:</strong> Generated documents are drafts for informational purposes only and do not constitute legal advice.\n            All documents should be reviewed by a licensed attorney in your state before signing or relying upon them.\n          </p>\n        </div>\n      </main>\n\n      {/* Document Preview Modal */}\n      {previewState.isOpen && (\n        <div className=\"fixed inset-0 z-50 overflow-y-auto\">\n          <div className=\"fixed inset-0 bg-black/50\" onClick={() => setPreviewState(prev => ({ ...prev, isOpen: false }))} />\n          <div className=\"relative min-h-screen flex items-center justify-center p-4\">\n            <div className=\"relative bg-white rounded-xl shadow-2xl w-full max-w-4xl max-h-[90vh] flex flex-col\">\n              {/* Modal Header */}\n              <div className=\"flex items-center justify-between px-6 py-4 border-b border-[var(--border)]\">\n                <h2 className=\"text-xl font-semibold text-[var(--text-heading)]\">\n                  {previewState.title}\n                </h2>\n                <div className=\"flex items-center gap-2\">\n                  <button\n                    onClick={handleCopy}\n                    className=\"p-2 text-[var(--text-muted)] hover:text-[var(--text-body)] hover:bg-[var(--off-white)] rounded-lg transition-colors\"\n                    title=\"Copy to clipboard\"\n                  >\n                    <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3\" />\n                    </svg>\n                  </button>\n                  <button\n                    onClick={handleDownload}\n                    className=\"p-2 text-[var(--text-muted)] hover:text-[var(--text-body)] hover:bg-[var(--off-white)] rounded-lg transition-colors\"\n                    title=\"Download as Markdown\"\n                  >\n                    <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4\" />\n                    </svg>\n                  </button>\n                  <button\n                    onClick={handleDownloadPDF}\n                    disabled={isGeneratingPDF}\n                    className=\"p-2 text-[var(--text-muted)] hover:text-[var(--text-body)] hover:bg-[var(--off-white)] rounded-lg transition-colors disabled:opacity-50\"\n                    title=\"Download as PDF\"\n                  >\n                    {isGeneratingPDF ? (\n                      <svg className=\"w-5 h-5 animate-spin\" fill=\"none\" viewBox=\"0 0 24 24\">\n                        <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\" />\n                        <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\" />\n                      </svg>\n                    ) : (\n                      <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z\" />\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 11v6m-3-3h6\" />\n                      </svg>\n                    )}\n                  </button>\n                  <button\n                    onClick={() => setPreviewState(prev => ({ ...prev, isOpen: false }))}\n                    className=\"p-2 text-[var(--text-muted)] hover:text-[var(--text-body)] hover:bg-[var(--off-white)] rounded-lg transition-colors\"\n                  >\n                    <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n                    </svg>\n                  </button>\n                </div>\n              </div>\n\n              {/* Modal Body - Document Content */}\n              <div className=\"flex-1 overflow-y-auto p-6\">\n                <div ref={pdfContentRef} className=\"prose prose-sm max-w-none bg-white pdf-content [&>hr]:hidden [&_hr]:hidden\">\n                  <ReactMarkdown>{\n                    previewState.content\n                      .replace(/<br\\s*\\/?>/gi, \"\\n\\n\")\n                      .replace(/<hr\\s*\\/?>/gi, \"\\n\\n\")\n                      .replace(/^---+$/gm, \"\")\n                      .replace(/^\\*\\*\\*+$/gm, \"\")\n                      .replace(/^___+$/gm, \"\")\n                  }</ReactMarkdown>\n                </div>\n              </div>\n\n              {/* Modal Footer */}\n              <div className=\"flex items-center justify-between px-6 py-4 border-t border-[var(--border)] bg-[var(--off-white)] rounded-b-xl\">\n                <p className=\"text-xs text-[var(--text-muted)]\">\n                  This is a draft document. Please review with an attorney before signing.\n                </p>\n                <div className=\"flex gap-3\">\n                  <button\n                    onClick={() => setPreviewState(prev => ({ ...prev, isOpen: false }))}\n                    className=\"px-4 py-2 text-[var(--text-body)] hover:bg-[var(--light-gray)] rounded-lg text-sm font-medium transition-colors\"\n                  >\n                    Close\n                  </button>\n                  <button\n                    onClick={handleDownload}\n                    className=\"px-4 py-2 bg-[var(--light-gray)] text-[var(--text-body)] hover:bg-[var(--medium-gray)] hover:text-white rounded-lg text-sm font-medium transition-colors\"\n                  >\n                    Download MD\n                  </button>\n                  <button\n                    onClick={handleDownloadPDF}\n                    disabled={isGeneratingPDF}\n                    className=\"px-4 py-2 bg-[var(--accent-purple)] hover:opacity-90 text-white rounded-lg text-sm font-medium transition-colors disabled:opacity-50 flex items-center gap-2\"\n                  >\n                    {isGeneratingPDF ? (\n                      <>\n                        <svg className=\"w-4 h-4 animate-spin\" fill=\"none\" viewBox=\"0 0 24 24\">\n                          <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\" />\n                          <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\" />\n                        </svg>\n                        Generating...\n                      </>\n                    ) : (\n                      \"Download PDF\"\n                    )}\n                  </button>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}